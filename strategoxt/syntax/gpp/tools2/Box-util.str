module Box-util

imports
  org.strategoxt.imp.debuggers.stratego.runtime


strategies
  hs-length =
    s-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "hs-length", "8,2,8,36")
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "8,14,8,36")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "8,14,8,30")
       ; SOpt-value(|HS())
       <+ s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "8,35,8,36")
          ; !1)
    < s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "hs-length", "8,2,8,36")
    + s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "hs-length", "8,2,8,36")
      ; fail

  vs-length =
    s-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "vs-length", "9,2,9,36")
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "9,14,9,36")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "9,14,9,30")
       ; SOpt-value(|VS())
       <+ s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "9,35,9,36")
          ; !0)
    < s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "vs-length", "9,2,9,36")
    + s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "vs-length", "9,2,9,36")
      ; fail

  is-length =
    s-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "is-length", "10,2,10,36")
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "10,14,10,36")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "10,14,10,30")
       ; SOpt-value(|IS())
       <+ s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "10,35,10,36")
          ; !0)
    < s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "is-length", "10,2,10,36")
    + s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "is-length", "10,2,10,36")
      ; fail

  SOpt-value(|opt) =
    s-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpt-value", "12,2,14,26")
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "13,4,14,26")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "13,4,13,27")
       ; fetch(
           s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "13,10,13,26")
           ; ?SOpt(opt, value)
         ))
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "14,6,14,26")
    ; <(s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "14,7,14,19") ; string-to-int)> value
    < s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpt-value", "12,2,14,26")
    + s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpt-value", "12,2,14,26")
      ; fail

  SOpts-of-alignment :
    AL(sopts) -> <r-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "16,2,16,40")> sopts
    where r-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "16,2,16,40")
          <+ r-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "16,2,16,40")
             ; fail

  SOpts-of-alignment :
    AR(sopts) -> <r-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "17,2,17,40")> sopts
    where r-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "17,2,17,40")
          <+ r-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "17,2,17,40")
             ; fail

  SOpts-of-alignment :
    AC(sopts) -> <r-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "18,2,18,40")> sopts
    where r-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "18,2,18,40")
          <+ r-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "SOpts-of-alignment", "18,2,18,40")
             ; fail

  construct-rows =
    s-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "construct-rows", "25,2,36,28")
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "26,4,36,28")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "26,4,26,17")
       ; split(
           s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "26,10,26,11") ; id
         , s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "26,14,26,16")
           ; ![]
         ))
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "27,4,36,28")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "27,4,35,5")
       ; rec x (
           s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "27,11,35,4")
           ; {a, b, xs, ys:
               s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "28,6,34,20")
               ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "28,6,28,34")
                  ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "28,6,28,13")
                     ; ?([], xs))
                  ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "28,15,28,34")
                  ; ![ R(
                         []
                       , <s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "28,23,28,29") ; reverse> xs
                       )
                     ]
                  <+ s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "30,6,34,20")
                     ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "30,6,31,46")
                        ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "30,6,30,23")
                           ; ?( [R(a, b)|xs]
                              , ys
                              ))
                        ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "31,6,31,46")
                        ; ![R(
                              []
                            , <s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "31,14,31,20") ; reverse> ys
                            ), R(a, b)|<s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "31,35,31,35") ; x> (xs, [])]
                        <+ s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "33,5,34,20")
                           ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "33,5,33,17")
                              ; ?([a|xs], ys))
                           ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "34,5,34,20")
                           ; <(s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "34,6,34,6") ; x)> (xs, [a|ys])))
             }
         ))
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "36,4,36,28")
    ; filter(
        s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "36,12,36,26")
        ; not(s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "36,17,36,24")
              ; R(
                  s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "36,19,36,20") ; id
                , s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "36,22,36,23") ; []
                ))
      )
    < s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "construct-rows", "25,2,36,28")
    + s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "construct-rows", "25,2,36,28")
      ; fail

  rel-string-length(|xpos) =
    s-enter(|"strategoxt/syntax/gpp/tools2/Box-util.str", "rel-string-length", "45,2,51,8")
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "46,4,51,8")
    ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "46,4,46,26")
       ; (s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "46,4,46,17") ; explode-string) => chars)
    ; s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "47,6,51,8")
    ; if s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "47,9,47,33")
         ; at-suffix(
             s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "47,19,47,32")
             ; ?['\n'|tail]
           ) then
        s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "48,8,48,35")
        ; <(s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "48,9,48,12") ; subt)> ( <s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "48,17,48,22") ; length> tail
                                                                                        , xpos
                                                                                        )
      else
        s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "50,8,50,21")
        ; <(s-step(|"strategoxt/syntax/gpp/tools2/Box-util.str", "50,9,50,14") ; length)> chars
      end
    < s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "rel-string-length", "45,2,51,8")
    + s-exit(|"strategoxt/syntax/gpp/tools2/Box-util.str", "rel-string-length", "45,2,51,8")
      ; fail