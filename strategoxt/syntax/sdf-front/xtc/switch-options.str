module switch-options

imports
  org.strategoxt.imp.debuggers.stratego.runtime


strategies
  SwitchOption(switch, description) =
    s-enter(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "SwitchOption", "4,2,9,6")
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,6,9,6")
    ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,6,5,52")
       ; where(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,12,5,51")
               ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,12,5,45")
                  ; <(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,13,5,41")
                      ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,13,5,18") ; switch)
                      ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "5,21,5,41")
                      ; construct-long-switch)> ()) => sw))
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "6,6,9,6")
    ; ArgOption(
        s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "6,16,6,18") ; ?sw
      , s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "7,8,7,50")
        ; where(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "7,14,7,49")
                ; <(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "7,15,7,24") ; set-config)> ( sw
                                                                                                              , <s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "7,33,7,47") ; norm-switch-arg>
                                                                                                              ))
      , s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "8,8,8,79")
        ; <(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "8,9,8,22") ; concat-strings)> [ sw
                                                                                                         , " on|off    "
                                                                                                         , <s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "8,46,8,56") ; description> ()
                                                                                                         , " (default: on)"
                                                                                                         ]
      )
    < s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "SwitchOption", "4,2,9,6")
    + s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "SwitchOption", "4,2,9,6")
      ; fail

  if-switch(switch, strat) =
    s-enter(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "if-switch", "11,2,12,31")
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "12,4,12,31")
    ; if-switch(
        s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "12,14,12,19") ; switch
      , s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "12,22,12,26") ; start
      , s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "12,29,12,30") ; id
      )
    < s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "if-switch", "11,2,12,31")
    + s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "if-switch", "11,2,12,31")
      ; fail

  if-switch(switch, then-s, else-s) =
    s-enter(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "if-switch", "14,2,19,6")
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,4,19,6")
    ; if s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,7,15,60")
         ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,7,15,40")
            ; <(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,8,15,36")
                ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,8,15,13") ; switch)
                ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,16,15,36")
                ; construct-long-switch)> ())
         ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "15,43,15,60")
         ; eval-config-switch then
        s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "16,6,16,11") ; then-s
      else
        s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "18,6,18,11") ; else-s
      end
    < s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "if-switch", "14,2,19,6")
    + s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "if-switch", "14,2,19,6")
      ; fail

  eval-config-switch =
    s-enter(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "eval-config-switch", "21,2,22,26")
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "22,4,22,26")
    ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "22,4,22,13") ; get-config
       < s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "22,17,22,21")
         ; ?"on"
       + s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "22,25,22,26") ; id)
    < s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "eval-config-switch", "21,2,22,26")
    + s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "eval-config-switch", "21,2,22,26")
      ; fail

  norm-switch-arg =
    s-enter(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "norm-switch-arg", "24,2,26,21")
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "25,6,26,21")
    ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "25,6,25,15") ; lower-case)
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "26,7,26,20")
    ; (s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "26,7,26,12")
       ; ?"off"
       + s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "26,16,26,20")
         ; ?"on")
    < s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "norm-switch-arg", "24,2,26,21")
    + s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "norm-switch-arg", "24,2,26,21")
      ; fail

  construct-long-switch =
    s-enter(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "construct-long-switch", "28,2,29,30")
    ; s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "29,4,29,30")
    ; <(s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "29,5,29,16") ; conc-strings)> ( "--"
                                                                                                     , <s-step(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "29,27,29,28") ; id>
                                                                                                     )
    < s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "construct-long-switch", "28,2,29,30")
    + s-exit(|"strategoxt/syntax/sdf-front/xtc/switch-options.str", "construct-long-switch", "28,2,29,30")
      ; fail