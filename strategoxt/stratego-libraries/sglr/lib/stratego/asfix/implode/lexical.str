module stratego/asfix/implode/lexical

imports
  org.strategoxt.imp.debuggers.stratego.runtime


strategies
  ImplodeLexical =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "7,2,9,21")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "8,4,9,21")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "8,4,8,35")
       ; ?appl(
            prod(
              [lex(_)]
            , cf(_)
            , _
            )
          , _
          ))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "9,6,9,21")
    ; asfix-yield-appl
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "7,2,9,21")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "7,2,9,21")
      ; fail

  ImplodeLexical =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "11,2,13,21")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "12,4,13,21")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "12,4,12,29")
       ; ?appl(prod(_, lex(_), _), _))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "13,6,13,21")
    ; asfix-yield-appl
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "11,2,13,21")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "11,2,13,21")
      ; fail

  ImplodeLexical =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "15,2,17,21")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "16,4,17,21")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "16,4,16,28")
       ; ?appl(prod(_, lit(_), _), _))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "17,6,17,21")
    ; asfix-yield-appl
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "15,2,17,21")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "15,2,17,21")
      ; fail

  ImplodeLexical =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "19,2,21,21")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "20,4,21,21")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "20,4,20,30")
       ; ?appl(prod(_, cilit(_), _), _))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "21,6,21,21")
    ; asfix-yield-appl
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "19,2,21,21")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "19,2,21,21")
      ; fail

  ImplodeLexical =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "23,2,24,45")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "24,4,24,45")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "24,4,24,24") ; ImplodeLexicalListVar
       <+ s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "24,29,24,45") ; ImplodeLexicalVar)
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "23,2,24,45")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexical", "23,2,24,45")
      ; fail

  ImplodeLexicalListVar =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "26,2,28,38")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "27,4,28,38")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "27,4,27,46")
       ; ?appl(
            prod(
              _
            , varsym(cf(iter-star(_)))
            , _
            )
          , _
          ))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "28,6,28,38")
    ; !meta-listvar(
         <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "28,21,28,36") ; asfix-yield-appl>
       )
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "26,2,28,38")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "26,2,28,38")
      ; fail

  ImplodeLexicalListVar =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "30,2,32,38")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "31,4,32,38")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "31,4,31,52")
       ; ?appl(
            prod(
              _
            , varsym(cf(iter-star-sep(_, _)))
            , _
            )
          , _
          ))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "32,6,32,38")
    ; !meta-listvar(
         <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "32,21,32,36") ; asfix-yield-appl>
       )
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "30,2,32,38")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "30,2,32,38")
      ; fail

  ImplodeLexicalListVar =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "34,2,36,38")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "35,4,36,38")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "35,4,35,41")
       ; ?appl(
            prod(
              _
            , varsym(cf(iter(_)))
            , _
            )
          , _
          ))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "36,6,36,38")
    ; !meta-listvar(
         <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "36,21,36,36") ; asfix-yield-appl>
       )
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "34,2,36,38")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "34,2,36,38")
      ; fail

  ImplodeLexicalListVar =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "38,2,40,38")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "39,4,40,38")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "39,4,39,47")
       ; ?appl(
            prod(
              _
            , varsym(cf(iter-sep(_, _)))
            , _
            )
          , _
          ))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "40,6,40,38")
    ; !meta-listvar(
         <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "40,21,40,36") ; asfix-yield-appl>
       )
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "38,2,40,38")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalListVar", "38,2,40,38")
      ; fail

  ImplodeLexicalVar =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalVar", "42,2,44,34")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "43,4,44,34")
    ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "43,4,43,31")
       ; ?appl(prod(_, varsym(_), _), _))
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "44,6,44,34")
    ; !meta-var(
         <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "44,17,44,32") ; asfix-yield-appl>
       )
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalVar", "42,2,44,34")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "ImplodeLexicalVar", "42,2,44,34")
      ; fail


strategies
  asfix-yield-appl =
    s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-appl", "52,2,61,6")
    ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "53,4,61,6")
    ; let yield(|chars) =
            s-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "yield", "53,8,54,41")
            ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "54,12,54,41")
            ; asfix-yield-acc(
                s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "54,28,54,32") ; yield
              | chars
              )
            < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "yield", "53,8,54,41")
            + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "yield", "53,8,54,41")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "56,8,60,16")
        ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "56,8,56,28")
           ; ?appl(
                _
              , <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "56,18,56,19") ; id>
              ){anno*})
        ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "57,8,60,16")
        ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "57,8,57,17")
           ; yield(|[]))
        ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "58,8,60,16")
        ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "58,8,58,21") ; implode-string)
        ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "59,8,60,16")
        ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "59,8,59,9") ; ?s)
        ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "60,8,60,16")
        ; !s{anno*}
      end
    < s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-appl", "52,2,61,6")
    + s-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-appl", "52,2,61,6")
      ; fail

  asfix-yield-acc(rec : b * c -> d|acc):
    appl(_, ts) -> <r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "63,2,66,27")> acc'
    where r-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "63,2,66,27")
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "63,2,66,27")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "66,6,66,27")
          ; acc' := <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "66,15,66,23")
                     ; rec(|acc)> ts
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "63,2,66,27")
             ; fail

  asfix-yield-acc(rec : b * c -> d|acc):
    [] -> <r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "68,2,69,12")> acc
    where r-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "68,2,69,12")
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "68,2,69,12")
             ; fail

  asfix-yield-acc(rec : b * c -> d|acc):
    [x|xs] -> <r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "71,2,75,28")> acc''
    where r-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "71,2,75,28")
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "71,2,75,28")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "74,6,75,28")
          ; (s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "74,6,74,27")
             ; acc' := <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "74,15,74,23")
                        ; rec(|acc)> xs)
          ; s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "75,6,75,28")
          ; acc'' := <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "75,16,75,25")
                      ; rec(|acc')> x
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "71,2,75,28")
             ; fail

  asfix-yield-acc(rec : b * c -> d|acc):
    i -> <r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "77,2,80,11")> [i|acc]
    where r-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "77,2,80,11")
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "77,2,80,11")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "80,6,80,11") ; is-int
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "77,2,80,11")
             ; fail

  asfix-yield-acc(rec : b * c -> d|acc):
    amb([x|_]) -> <r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "82,2,83,32")> <s-step(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "83,21,83,29")
                                                                                                                                           ; rec(|acc)> x
    where r-enter(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "82,2,83,32")
          <+ r-exit(|"strategoxt/stratego-libraries/sglr/lib/stratego/asfix/implode/lexical.str", "asfix-yield-acc", "82,2,83,32")
             ; fail