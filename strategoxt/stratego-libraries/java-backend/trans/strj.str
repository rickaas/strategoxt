module strj

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  shared-constructors
  libstrc
  libstratego-lib
  libstratego-xtc
  libstratego-gpp
  libjava-front
  strj-options
  s2j
  lib/dr-scoping


strategies
  main-strj =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "main-strj", "23,2,30,11")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "24,4,30,11")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "24,4,24,21") ; strj-parse-options)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "25,4,30,11")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "25,4,25,23") ; main-module-required)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "26,4,30,11")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "26,4,29,4")
       ; log-timed(
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "27,6,27,27")
           ; xtc-input(
               s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "27,16,27,26") ; strj-or-die
             )
         | "Compilation succeeded"
         , 1
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "30,4,30,11")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "30,5,30,8") ; exit)> 0
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "main-strj", "23,2,30,11")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "main-strj", "23,2,30,11")
      ; fail

  strj-or-die =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "strj-or-die", "32,2,43,11")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "33,3,43,11")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "33,3,33,6") ; strj
       <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "35,4,43,11")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "35,4,35,45") ; prim("SSL_stacktrace_get_all_frame_names"))
          ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "36,4,43,11")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "36,4,41,4")
             ; if-verbose3(
                 s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "37,6,40,6")
                 ; report-failure(
                     s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "38,8,39,15")
                     ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "38,8,38,89")
                        ; log(
                          | Error()
                          , [ "Compilation failed ("
                            , <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "38,48,38,76")
                               ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "38,48,38,55") ; run-time)
                               ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "38,59,38,76")
                               ; real-to-string(|2)>
                            , " secs)"
                            ]
                          ))
                     ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "39,8,39,15")
                     ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "39,9,39,12") ; exit)> 1
                   )
               ))
          ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "42,4,43,11")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "42,4,42,85")
             ; log(
               | Error()
               , [ "Compilation failed ("
                 , <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "42,44,42,72")
                    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "42,44,42,51") ; run-time)
                    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "42,55,42,72")
                    ; real-to-string(|2)>
                 , " secs)"
                 ]
               ))
          ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "43,4,43,11")
          ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "43,5,43,8") ; exit)> 1)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "strj-or-die", "32,2,43,11")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "strj-or-die", "32,2,43,11")
      ; fail

  strj =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "strj", "45,2,67,69")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "46,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "46,4,60,6")
       ; if s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "46,7,46,36")
            ; FILE(
                s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "46,12,46,35")
                ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "46,12,46,24") ; get-extension) => "ctree"
              ) then
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "47,6,54,9")
           ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "47,6,50,20")
              ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "47,6,47,20") ; xtc-ensure-file)
              ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "48,6,50,20")
              ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "48,6,48,20") ; strc-get-infile)
              ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "49,6,50,20")
              ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "49,6,49,14") ; read-from)
              ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "50,6,50,20")
              ; strc-output-ast
              <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "52,6,54,9")
                 ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "52,6,52,22")
                    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "52,7,52,16") ; get-config)> "-i")
                 ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "53,6,54,9")
                 ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "53,6,53,32")
                    ; err(|"File does not exist"))
                 ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "54,6,54,9")
                 ; fail)
         else
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "56,6,59,6")
           ; dr-scope-all-verbose(
               s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "57,8,58,21")
               ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "57,8,57,47")
                  ; with(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "57,13,57,46")
                         ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "57,14,57,23") ; set-config)> ("JAVA_PLATFORM", ())))
               ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "58,8,58,21")
               ; strc-front-end
             )
         end)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "61,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "61,4,61,52")
       ; try(
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "61,8,61,51")
           ; mark-always-needed(
             | <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "61,29,61,38") ; get-config> "-m"
             , 0
             , 0
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "62,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "62,4,62,16") ; strc-optimize)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "63,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "63,4,63,28") ; strc-export-external-defs)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "64,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "64,4,64,23") ; strc-output-frontend)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "65,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "65,4,65,6") ; s2j)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "66,4,67,69")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "66,4,66,25")
       ; with(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "66,9,66,24") ; clean-output-dir))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "67,4,67,69")
    ; log-timed(
        s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "67,14,67,35")
        ; list-loop(
            s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "67,24,67,34") ; output-java
          )
      | "Pretty printing succeeded"
      , 1
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "strj", "45,2,67,69")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "strj", "45,2,67,69")
      ; fail

  clean-output-dir =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "clean-output-dir", "69,2,79,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "70,4,79,6")
    ; if s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "70,7,70,28")
         ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "70,8,70,17") ; get-config)> "--clean" then
        s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "71,6,78,8")
        ; if s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "71,9,71,25")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "71,10,71,19") ; get-config)> "-p" then
            s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "72,8,75,10")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "72,8,72,21") ; output-dirname)
            ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "73,8,75,10")
            ; if s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "73,11,73,21") ; file-exists then
                s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "74,10,74,33") ; delete-java-files-in-dir
              end
          else
            s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "77,8,77,69")
            ; warn-msg(|"Ignored --clean option: no package name specified")
          end
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "clean-output-dir", "69,2,79,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "clean-output-dir", "69,2,79,6")
      ; fail

  delete-java-files-in-dir =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "delete-java-files-in-dir", "81,2,97,44")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "82,4,97,44")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "82,4,95,4")
       ; log-timed(
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "83,6,93,6")
           ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "83,6,83,29")
              ; with(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "83,11,83,28")
                     ; olddir := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "83,22,83,27") ; getcwd>))
           ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "84,6,93,6")
           ; finally(
               s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "85,8,91,8")
               ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "85,8,85,12") ; chdir)
               ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "86,8,91,8")
               ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "86,8,86,20")
                  ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "86,9,86,15") ; readdir)> ".")
               ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "87,8,91,8")
               ; list-loop(
                   s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "88,10,90,12")
                   ; if s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "88,13,88,34")
                        ; has-extension(|"java") then
                       s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "89,12,89,22") ; remove-file
                     end
                 )
             , s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "92,8,92,21")
               ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "92,9,92,13") ; chdir)> olddir
             )
         | $[Deleted existing java files in output directory [<s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "94,58,94,71") ; output-dirname>]]
         , 1
         )
       <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "97,4,97,44")
          ; warn(|"Could not clean output directory"))
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "delete-java-files-in-dir", "81,2,97,44")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "delete-java-files-in-dir", "81,2,97,44")
      ; fail

  output-java :
    ast -> <r-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java", "99,2,116,22")> name
    where r-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java", "99,2,116,22")
          <+ r-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java", "99,2,116,22")
             ; fail
    with s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "102,6,116,22")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "102,6,113,22")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "102,6,102,85")
               ; name := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "102,15,102,80")
                          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "102,15,102,29") ; output-filename
                             <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "102,34,102,80")
                                ; fatal-err(|"Internal error: unexpected output"))> ast)
            ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "110,11,113,22")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "110,11,110,81")
               ; file := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "110,20,110,68")
                          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "110,20,110,24") ; fopen
                             <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "110,29,110,68")
                                ; fatal-err(|"Could not open output file"))> (name, "w"))
            ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "111,10,113,22")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "111,10,111,39")
               ; box := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "111,19,111,34") ; pp-java5-to-abox> ast)
            ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "112,10,113,22")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "112,10,112,41")
               ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "112,11,112,36")
                   ; box2text-stream(|80, file))> box)
            ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "113,10,113,22")
            ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "113,11,113,16") ; fclose)> file
            <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "116,6,116,22") ; output-java-error)
         <+ r-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java", "99,2,116,22")
            ; fail

  external pp-java-native(|)

  output-filename :
    CompilationUnit(
      _
    , _
    , [ ClassDec(
          ClassDecHead(_, Id(x_name), _, _, _)
        , _
        )
      ]
    ) -> <r-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-filename", "122,3,130,72")> x_name'
    where r-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-filename", "122,3,130,72")
          <+ r-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-filename", "122,3,130,72")
             ; fail
    with s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "130,7,130,72")
         ; x_name' := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "130,19,130,30") ; conc-strings> ( <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "130,35,130,48") ; output-dirname>
                                                                                                                             , "/"
                                                                                                                             , x_name
                                                                                                                             , ".java"
                                                                                                                             )
         <+ r-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-filename", "122,3,130,72")
            ; fail

  output-dirname =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-dirname", "132,3,145,32")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "133,5,145,32")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "133,5,133,17") ; OutputDirName
       <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "135,5,145,32")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "135,5,140,32")
             ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "135,5,135,21")
                ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "135,6,135,15") ; get-config)> "-o")
             ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "136,5,140,32")
             ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "136,5,138,7")
                ; if s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "136,8,136,55")
                     ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "136,8,136,29")
                        ; has-extension(|"java")
                        + s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "136,33,136,55")
                          ; has-extension(|"ctree")) then
                    s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "137,7,137,13") ; dirname
                  end)
             ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,5,140,32")
             ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,5,139,78")
                ; try(
                    s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,9,139,77")
                    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,9,139,19") ; file-exists
                       <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,24,139,77")
                          ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,24,139,28") ; mkdir
                             <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "139,33,139,77")
                                ; fatal-err(|"Output directory does not exist")))
                  ))
             ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "140,5,140,32")
             ; rules (
                 OutputDirName := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "140,29,140,30") ; id>
               )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "142,5,145,32")
                ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "142,5,142,24")
                   ; strc-getoutfile(
                       s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "142,21,142,23")
                       ; !""
                     ))
                ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "143,5,145,32")
                ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "143,5,143,11") ; dirname)
                ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "144,5,145,32")
                ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "144,5,144,29")
                   ; try(
                       s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "144,9,144,28")
                       ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "144,9,144,19") ; file-exists
                          <+ s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "144,24,144,28") ; mkdir)
                     ))
                ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "145,5,145,32")
                ; rules (
                    OutputDirName := <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "145,29,145,30") ; id>
                  )))
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-dirname", "132,3,145,32")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-dirname", "132,3,145,32")
      ; fail

  output-java-error =
    s-enter(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java-error", "150,3,156,17")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "151,6,156,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "151,6,151,114")
       ; with(
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "151,11,151,56")
           ; not(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "151,15,151,55")
                 ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "151,15,151,42")
                    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "151,16,151,31") ; pp-java5-to-abox)> Id("foo")) => Id("foo"))
         | "Internal error: linking against libjava-front failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "152,6,156,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "152,6,152,64")
       ; err-msg(|"Internal error: generated Java AST is malformed"))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "153,6,156,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "153,6,153,27")
       ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "153,6,153,13") ; write-to) => FILE(file))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,6,156,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,6,154,114")
       ; try(
           s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,10,154,113")
           ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,11,154,38")
               ; xtc-command(
                   s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,23,154,37")
                   ; !"format-check"
                 ))> ["--vis", "-i", file, "--rtg", <s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,73,154,80") ; xtc-find> "Java-15.rtg"|<s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "154,100,154,111") ; pass-verbose>]
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "155,6,156,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "155,6,155,67")
       ; log(|Critical(), "Fatal errors encountered in generated code"))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "156,6,156,17")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "156,7,156,14") ; xtc-exit)> 1
    < s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java-error", "150,3,156,17")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/trans/strj.str", "output-java-error", "150,3,156,17")
      ; fail