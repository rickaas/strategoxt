module pp-rtg

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  libstratego-gpp
  libstratego-xtc
  lib/rtg-ppfix


strategies
  main-pp-rtg =
    s-enter(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "main-pp-rtg", "10,2,16,4")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "11,4,16,4")
    ; io-stream-wrap(
        s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "12,6,15,12")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "12,6,12,17")
           ; ?(fin, fout))
        ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "13,8,15,12")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "13,8,13,29")
           ; <(s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "13,9,13,24") ; read-from-stream)> fin)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "14,8,15,12")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "14,8,14,27")
           ; pp-rtg-stream(|fout))
        ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "15,8,15,12")
        ; !fout
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "main-pp-rtg", "10,2,16,4")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "main-pp-rtg", "10,2,16,4")
      ; fail

  pp-rtg-file(|path) =
    s-enter(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-file", "18,2,29,5")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "19,4,29,5")
    ; let open =
            s-enter(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "open", "19,8,20,48")
            ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,10,20,48")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,10,20,20") ; open-stream
               <+ s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,25,20,48")
                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,25,20,34")
                     ; ?( <s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,28,20,29") ; id>
                        , _
                        ))
                  ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,37,20,48")
                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,37,20,42") ; perror)
                  ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "20,45,20,48")
                  ; fail)
            < s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "open", "19,8,20,48")
            + s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "open", "19,8,20,48")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "22,8,28,8")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "22,8,22,17") ; pp-rtg-box)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "23,8,28,8")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "23,8,23,40")
           ; where(s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "23,14,23,39")
                   ; fout := <s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "23,23,23,26") ; open> (path, "w")))
        ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "24,8,28,8")
        ; finally(
            s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "25,10,26,31")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "25,10,25,35")
               ; box2text-stream(|80, fout))
            ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "26,12,26,31")
            ; <(s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "26,13,26,17") ; fputs)> ("\n", fout)
          , s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "27,10,27,27")
            ; try(
                s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "27,14,27,26")
                ; <(s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "27,15,27,20") ; fclose)> fout
              )
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-file", "18,2,29,5")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-file", "18,2,29,5")
      ; fail

  pp-rtg-stream(|stream) =
    s-enter(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-stream", "31,2,34,27")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "32,4,34,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "32,4,32,13") ; pp-rtg-box)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "33,6,34,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "33,6,33,33")
       ; box2text-stream(|80, stream))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "34,6,34,27")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "34,7,34,11") ; fputs)> ("\n", stream)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-stream", "31,2,34,27")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-stream", "31,2,34,27")
      ; fail

  pp-rtg-box =
    s-enter(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-box", "36,2,38,31")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "37,4,38,31")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "37,4,37,12") ; rtg-ppfix)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "38,6,38,31")
    ; ast2box(
      | [ <s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "38,17,38,28") ; pp-table-rtg>
        ]
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-box", "36,2,38,31")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-rtg-box", "36,2,38,31")
      ; fail

  pp-table-rtg =
    s-enter(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-table-rtg", "40,2,41,25")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "41,4,41,25")
    ; import-term(rtg.pp.af)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-table-rtg", "40,2,41,25")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/java/tools/org/strategoxt/tools/lib/pp-rtg.str", "pp-table-rtg", "40,2,41,25")
      ; fail