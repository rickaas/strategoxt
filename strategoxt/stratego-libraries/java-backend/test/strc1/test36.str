module test36

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/cons
  collection/tuple/cons


signature
  constructors
    Stream : a -> b
    stdout : FILE


strategies
  main-test36 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "main-test36", "10,2,14,9")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "11,4,14,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "11,4,11,7") ; ?foo)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "12,6,14,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "12,6,12,23")
       ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "12,7,12,12") ; fclose)> Stream(0))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "13,6,14,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "13,6,13,15")
       ; gclose(|1))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "14,6,14,9")
    ; !foo
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "main-test36", "10,2,14,9")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "main-test36", "10,2,14,9")
      ; fail

  fclose =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "fclose", "16,2,17,18")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "17,4,17,18")
    ; try(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "17,8,17,17")
        ; ?Stream(o)
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "fclose", "16,2,17,18")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "fclose", "16,2,17,18")
      ; fail

  gclose(|foo) =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "gclose", "19,2,25,4")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "20,4,25,4")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "21,4,24,4")
        ; {bar:
            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "22,6,23,11")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "22,6,22,9") ; !foo)
            ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "23,8,23,11")
            ; ?bar
          }
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "gclose", "19,2,25,4")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "gclose", "19,2,25,4")
      ; fail

  try(s) =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "try", "27,2,27,17")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "27,11,27,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "27,11,27,11") ; s
       <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "27,16,27,17") ; id)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "try", "27,2,27,17")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test36.str", "try", "27,2,27,17")
      ; fail