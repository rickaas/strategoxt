module switch-semantics-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-test70 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "main-test70", "5,2,12,2")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "6,2,12,2")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "6,13,6,41")
        ; !"switch construct testsuite"
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "7,4,11,21")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "7,4,7,12") ; test-woow)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "8,4,11,21")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "8,4,8,11") ; test-wow)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "9,4,11,21")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "9,4,9,18") ; test-failbranch)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "10,4,11,21")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "10,4,10,14") ; test-nested)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "11,4,11,21")
        ; test-switch-in-let
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "main-test70", "5,2,12,2")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "main-test70", "5,2,12,2")
      ; fail

  test-woow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-woow", "14,2,28,9")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "15,4,28,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "15,4,19,9")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "16,6,16,16") ; switch-woow
         | "switch-woow int"
         , 3
         , 101
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "20,4,28,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "20,4,24,26")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "21,6,21,16") ; switch-woow
         | "switch-woow string"
         , "three"
         , "string case failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "25,4,28,9")
    ; apply-and-fail(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "26,6,26,16") ; switch-woow
      | "switch-woow real"
      , 3.5
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-woow", "14,2,28,9")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-woow", "14,2,28,9")
      ; fail

  test-wow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-wow", "30,2,45,22")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "31,4,45,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "31,4,35,9")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "32,6,32,15") ; switch-wow
         | "switch-wow int"
         , 3
         , 101
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "36,4,45,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "36,4,40,26")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "37,6,37,15") ; switch-wow
         | "switch-wow string"
         , "three"
         , "string case failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "41,4,45,22")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "42,6,42,15") ; switch-wow
      | "switch-wow real"
      , 3.5
      , "otherwise case"
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-wow", "30,2,45,22")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-wow", "30,2,45,22")
      ; fail

  test-failbranch =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-failbranch", "47,2,61,22")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "48,4,61,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "48,4,51,7")
       ; apply-and-fail(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "49,6,49,19") ; switch-intfail
         | "switch-intfail int"
         , 3
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "52,4,61,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "52,4,56,26")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "53,6,53,19") ; switch-intfail
         | "switch-intfail string"
         , "three"
         , "string case failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "57,4,61,22")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "58,6,58,19") ; switch-intfail
      | "switch-intfail real"
      , 3.5
      , "otherwise case"
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-failbranch", "47,2,61,22")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-failbranch", "47,2,61,22")
      ; fail

  test-nested =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-nested", "63,2,73,22")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "64,4,73,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "64,4,68,9")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "65,6,65,18") ; switch-nested
         | "switch-nested int"
         , 3
         , 101
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "69,4,73,22")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "70,6,70,18") ; switch-nested
      | "switch-nested string"
      , "three"
      , "otherwise case"
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-nested", "63,2,73,22")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-nested", "63,2,73,22")
      ; fail

  test-switch-in-let =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-switch-in-let", "75,2,81,4")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "76,4,81,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "77,6,77,18") ; switch-in-let
      | "switch-in-let"
      , [1, 2]
      , [2, 2]
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-switch-in-let", "75,2,81,4")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "test-switch-in-let", "75,2,81,4")
      ; fail

  switch-woow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-woow", "83,2,89,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "84,4,89,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "84,4,84,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "85,4,89,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "85,4,85,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "86,4,89,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "86,11,86,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "87,11,87,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "87,20,87,41")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "87,20,87,34")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "87,21,87,23") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "87,28,87,29") ; id>
                                                                                                                    , 1
                                                                                                                    )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "87,39,87,41")
                ; !-1)
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "88,11,88,19") ; is-string :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "88,23,88,77")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "88,23,88,52")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "88,24,88,29") ; strcat)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "88,34,88,35") ; id>
                                                                                                                       , "should fail"
                                                                                                                       )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "88,57,88,77")
                ; !"string case failed")
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-woow", "83,2,89,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-woow", "83,2,89,6")
      ; fail

  switch-wow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-wow", "91,2,98,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "92,4,98,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "92,4,92,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "93,4,98,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "93,4,93,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "94,4,98,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "94,11,94,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "95,11,95,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "95,20,95,41")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "95,20,95,34")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "95,21,95,23") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "95,28,95,29") ; id>
                                                                                                                    , 1
                                                                                                                    )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "95,39,95,41")
                ; !-1)
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "96,11,96,19") ; is-string :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "96,23,96,77")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "96,23,96,52")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "96,24,96,29") ; strcat)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "96,34,96,35") ; id>
                                                                                                                       , "should fail"
                                                                                                                       )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "96,57,96,77")
                ; !"string case failed")
        otherwise :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "97,18,97,34")
          ; !"otherwise case"
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-wow", "91,2,98,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-wow", "91,2,98,6")
      ; fail

  switch-intfail =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-intfail", "100,2,107,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "101,4,107,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "101,4,101,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "102,4,107,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "102,4,102,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "103,4,107,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "103,11,103,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "104,11,104,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "104,20,104,23") ; fail
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "105,11,105,19") ; is-string :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "105,23,105,77")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "105,23,105,52")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "105,24,105,29") ; strcat)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "105,34,105,35") ; id>
                                                                                                                         , "should fail"
                                                                                                                         )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "105,57,105,77")
                ; !"string case failed")
        otherwise :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "106,18,106,34")
          ; !"otherwise case"
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-intfail", "100,2,107,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-intfail", "100,2,107,6")
      ; fail

  switch-nested =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-nested", "109,2,120,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "110,4,120,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "110,4,110,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "111,4,120,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "111,4,111,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "112,4,120,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "112,11,112,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "114,8,117,10")
             ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "114,15,114,20")
                      ; !"foo"
                 case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "115,15,115,20") ; is-int :
                   s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "115,24,115,27") ; fail
                 case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "116,15,116,23") ; is-string :
                   s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "116,27,116,30") ; fail
               end :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "117,23,117,46")
          ; !"nested case condition"
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "118,11,118,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "118,20,118,41")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "118,20,118,34")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "118,21,118,23") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "118,28,118,29") ; id>
                                                                                                                      , 1
                                                                                                                      )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "118,39,118,41")
                ; !-1)
        otherwise :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "119,18,119,34")
          ; !"otherwise case"
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-nested", "109,2,120,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-nested", "109,2,120,6")
      ; fail

  switch-in-let =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-in-let", "122,2,128,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "123,4,128,6")
    ; let asd =
            s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "asd", "123,8,126,16")
            ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "123,14,126,16")
            ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "123,21,123,22") ; id
                case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "124,21,124,21") ; 1 :
                  s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "124,28,124,29")
                  ; !2
                otherwise :
                  s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "125,14,125,15") ; id
              end
            < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "asd", "123,8,126,16")
            + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "asd", "123,8,126,16")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "127,7,127,14")
        ; map(
            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "127,11,127,13") ; asd
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-in-let", "122,2,128,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test70.str", "switch-in-let", "122,2,128,6")
      ; fail