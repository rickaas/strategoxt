module test88

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    DeclId : Id -> DeclId
    Id     : String -> Id


strategies
  main-test88 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "main-test88", "11,2,14,4")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "12,4,14,4")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "12,15,12,23")
        ; !"test88"
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "13,6,13,10") ; test2
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "main-test88", "11,2,14,4")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "main-test88", "11,2,14,4")
      ; fail

  runtest3 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "runtest3", "20,2,40,9")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "21,4,40,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "21,4,25,5")
       ; !( DeclId(Id("a"{0}))
          , DeclId(Id("b"{1}))
          , DeclId(
              Id("c"{2}){3}
            )
          , DeclId(Id("d"))
          ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "26,6,40,9")
    ; topdown(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "27,8,40,8")
        ; {t, t2, x:
            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "28,9,39,11")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "28,9,28,23")
               ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "28,14,28,22")
                      ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "28,14,28,17")
                         ; !"c")
                      ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "28,21,28,22")
                      ; ?t))
            ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "29,9,39,11")
            ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "29,9,33,11")
               ; if s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "29,12,29,31")
                    ; DeclId(
                        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "29,19,29,30")
                        ; Id(
                            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "29,22,29,29")
                            ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "29,27,29,28") ; ?t)
                          )
                      ) then
                   s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "30,11,30,47")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "30,17,30,46")
                       ; !"1st bang method matched ok:"
                     )
                 else
                   s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "32,11,32,30")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "32,17,32,29")
                       ; !"no match: "
                     )
                 end)
            ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "35,9,39,11")
            ; if s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "35,12,35,31")
                 ; DeclId(
                     s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "35,19,35,30")
                     ; Id(
                         s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "35,22,35,29")
                         ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "35,27,35,28") ; ?t)
                       )
                   ) then
                s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "36,11,36,47")
                ; debug(
                    s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "36,17,36,46")
                    ; !"2nd bang method matched ok:"
                  )
              else
                s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "38,11,38,30")
                ; debug(
                    s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "38,17,38,29")
                    ; !"no match: "
                  )
              end
          }
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "runtest3", "20,2,40,9")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "runtest3", "20,2,40,9")
      ; fail

  test1 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test1", "46,2,50,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "47,4,50,6")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "47,15,47,22")
        ; !"test1"
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "48,8,48,11") ; foo1
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "49,8,49,29")
        ; !DeclId(
             Id("c"{2}){3}
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test1", "46,2,50,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test1", "46,2,50,6")
      ; fail

  foo1 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "foo1", "52,2,64,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "53,4,64,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "53,4,53,18")
       ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "53,9,53,17")
              ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "53,9,53,12")
                 ; !"c")
              ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "53,16,53,17")
              ; ?t))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "54,4,64,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "54,4,58,6")
       ; if s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "54,7,54,26")
            ; DeclId(
                s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "54,14,54,25")
                ; Id(
                    s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "54,17,54,24")
                    ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "54,22,54,23") ; ?t)
                  )
              ) then
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "55,6,55,42")
           ; debug(
               s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "55,12,55,41")
               ; !"1st bang method matched ok:"
             )
         else
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "57,6,57,25")
           ; debug(
               s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "57,12,57,24")
               ; !"no match: "
             )
         end)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "60,4,64,6")
    ; if s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "60,7,60,26")
         ; DeclId(
             s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "60,14,60,25")
             ; Id(
                 s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "60,17,60,24")
                 ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "60,22,60,23") ; ?t)
               )
           ) then
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "61,6,61,42")
        ; debug(
            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "61,12,61,41")
            ; !"2nd bang method matched ok:"
          )
      else
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "63,6,63,25")
        ; debug(
            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "63,12,63,24")
            ; !"no match: "
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "foo1", "52,2,64,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "foo1", "52,2,64,6")
      ; fail

  test1 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test1", "66,2,70,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "67,4,70,6")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "67,15,67,22")
        ; !"test1"
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "68,8,68,11") ; foo1
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "69,8,69,29")
        ; !DeclId(
             Id("c"{2}){3}
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test1", "66,2,70,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test1", "66,2,70,6")
      ; fail

  test2 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test2", "76,2,80,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "77,4,80,6")
    ; apply-and-fail(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "77,19,77,26")
        ; !"test2"
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "78,8,78,11") ; foo2
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "79,8,79,29")
        ; !DeclId(
             Id("c"{2}){3}
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test2", "76,2,80,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "test2", "76,2,80,6")
      ; fail

  foo2 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "foo2", "82,2,86,25")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "83,4,86,25")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "83,4,83,18")
       ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "83,9,83,17")
              ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "83,9,83,12")
                 ; !"c")
              ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "83,16,83,17")
              ; ?t))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "84,6,86,25")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "84,6,84,22")
       ; debug(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "84,12,84,21")
           ; !"test2: "
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "85,6,86,25")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "85,6,85,25")
       ; DeclId(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "85,13,85,24")
           ; Id(
               s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "85,16,85,23")
               ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "85,21,85,22") ; ?t)
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "86,6,86,25")
    ; DeclId(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "86,13,86,24")
        ; Id(
            s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "86,16,86,23")
            ; test(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "86,21,86,22") ; ?t)
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "foo2", "82,2,86,25")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test88.str", "foo2", "82,2,86,25")
      ; fail