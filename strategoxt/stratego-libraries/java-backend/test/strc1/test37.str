module test37

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-test37 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main-test37", "5,2,11,27")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "6,4,11,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "6,4,6,17")
       ; say(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "6,8,6,16")
           ; !"test37"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "7,6,11,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "7,6,7,19")
       ; ![48, 65, 97, 92])
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "8,6,11,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "8,6,8,10") ; debug)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "9,6,11,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "9,6,9,18")
       ; map(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "9,10,9,17") ; num2char
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "10,6,11,27")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "10,6,10,10") ; debug)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "11,6,11,27")
    ; ?["0", "A", "a", "\\92 "]
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main-test37", "5,2,11,27")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main-test37", "5,2,11,27")
      ; fail

  num2char =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "num2char", "17,2,24,65")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,6,24,65")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,8,18,62")
       ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,8,18,9") ; ?n)
       ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,12,18,62")
       ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,12,18,41")
          ; where(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,18,18,40")
                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,18,18,28")
                     ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,19,18,21") ; geq)> (n, 48))
                  ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,30,18,40")
                  ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,31,18,33") ; leq)> (n, 57)))
       ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,44,18,62")
       ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "18,45,18,58") ; implode-string)> [n]
       <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,6,24,65")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,8,19,62")
             ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,8,19,9") ; ?n)
             ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,12,19,62")
             ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,12,19,41")
                ; where(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,18,19,40")
                        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,18,19,28")
                           ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,19,19,21") ; geq)> (n, 65))
                        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,30,19,40")
                        ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,31,19,33") ; leq)> (n, 90)))
             ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,44,19,62")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "19,45,19,58") ; implode-string)> [n]
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,6,24,65")
                ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,8,20,63")
                   ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,8,20,9") ; ?n)
                   ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,12,20,63")
                   ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,12,20,42")
                      ; where(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,18,20,41")
                              ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,18,20,28")
                                 ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,19,20,21") ; geq)> (n, 97))
                              ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,30,20,41")
                              ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,31,20,33") ; leq)> (n, 122)))
                   ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,45,20,63")
                   ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "20,46,20,59") ; implode-string)> [n]
                   <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "21,6,24,65")
                      ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "21,6,21,38")
                         ; \ 10 -> <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "21,15,21,28") ; implode-string> [92, 110] \
                         <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "22,6,24,65")
                            ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "22,6,22,38")
                               ; \ 9 -> <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "22,15,22,28") ; implode-string> [92, 116] \
                               <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "23,6,24,65")
                                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "23,6,23,37")
                                     ; \ 32 -> <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "23,15,23,28") ; implode-string> [92, 32] \
                                     <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "24,8,24,63")
                                        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "24,8,24,20") ; num-to-string)
                                        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "24,23,24,63")
                                        ; \ str -> <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "24,33,24,46") ; concat-strings> ["\\", str, " "] \))))))
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "num2char", "17,2,24,65")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "num2char", "17,2,24,65")
      ; fail

  num-to-string =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "num-to-string", "26,2,33,19")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "27,4,33,19")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "27,4,31,4")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,6,30,33")
           ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,6,29,36")
              ; split(
                  s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,13,28,44")
                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,13,28,27")
                     ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,14,28,16") ; mod)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,20,28,21") ; id>
                                                                                                                            , 10
                                                                                                                            ))
                  ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,30,28,44")
                  ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,31,28,33") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "28,37,28,38") ; id>
                                                                                                                         , 48
                                                                                                                         )
                , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "29,15,29,34")
                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "29,15,29,29")
                     ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "29,16,29,18") ; div)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "29,22,29,23") ; id>
                                                                                                                            , 10
                                                                                                                            ))
                  ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "29,32,29,34")
                  ; int
                ))
           ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,8,30,33")
           ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,8,30,25")
              ; ( s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,9,30,10") ; id
                , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,13,30,24")
                  ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,13,30,19")
                     ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,13,30,14")
                        ; ?0)
                     ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,17,30,19")
                     ; ![]
                     <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,24,30,24") ; x)
                ))
           ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "30,28,30,33")
           ; MkCons
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "32,6,33,19")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "32,6,32,12") ; reverse)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "33,6,33,19")
    ; implode-string
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "num-to-string", "26,2,33,19")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "num-to-string", "26,2,33,19")
      ; fail

  sect(s1, s2) =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "sect", "35,2,35,31")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "35,17,35,31")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "35,18,35,19") ; s1)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "35,23,35,24") ; id>
                                                                                                          , <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "35,28,35,29") ; s2>
                                                                                                          )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "sect", "35,2,35,31")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "sect", "35,2,35,31")
      ; fail

  main'' =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main''", "38,2,39,21")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "39,4,39,21")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "39,5,39,17") ; num-to-string)> 92
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main''", "38,2,39,21")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main''", "38,2,39,21")
      ; fail

  main' =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main'", "41,2,42,11")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "42,4,42,11")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "42,5,42,7") ; foo)> 92
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main'", "41,2,42,11")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "main'", "41,2,42,11")
      ; fail

  foo =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "foo", "44,2,44,39")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,8,44,39")
    ; ( s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,9,44,10") ; id
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,13,44,38")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,13,44,19")
           ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,13,44,14")
              ; ?0)
           ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,17,44,19")
           ; ![]
           <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "44,24,44,38")
              ; !("aap", "noot"))
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "foo", "44,2,44,39")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test37.str", "foo", "44,2,44,39")
      ; fail