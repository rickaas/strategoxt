module test-chain01

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-test_chain01 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "main-test_chain01", "7,2,19,7")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "8,6,19,7")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "8,6,8,24") ; register-extension1)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "9,6,19,7")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "9,6,9,24") ; register-extension2)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "10,6,19,7")
    ; {|Foo:
         s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "11,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "11,8,11,26") ; register-extension3)
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "12,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "12,8,12,26") ; register-extension4)
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "13,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "13,8,13,21")
            ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "13,9,13,17") ; chain-Foo)> [])
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "14,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "14,8,14,28")
            ; debug(
                s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "14,14,14,27")
                ; !"chain-Foo: "
              ))
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "15,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "15,8,15,24")
            ; ?["Ext3", "Ext4"])
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "16,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "16,8,16,24")
            ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "16,9,16,20") ; bigchain-Foo)> [])
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "17,8,18,40")
         ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "17,8,17,31")
            ; debug(
                s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "17,14,17,30")
                ; !"bigchain-Foo: "
              ))
         ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "18,8,18,40")
         ; ?["Ext1", "Ext2", "Ext3", "Ext4"]
      |}
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "main-test_chain01", "7,2,19,7")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "main-test_chain01", "7,2,19,7")
      ; fail


strategies
  register-extension1 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension1", "23,2,24,36")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "24,4,24,36")
    ; rules (
        Foo :+
          xs -> ["Ext1"|xs]
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension1", "23,2,24,36")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension1", "23,2,24,36")
      ; fail

  register-extension2 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension2", "26,2,27,36")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "27,4,27,36")
    ; rules (
        Foo :+
          xs -> ["Ext2"|xs]
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension2", "26,2,27,36")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension2", "26,2,27,36")
      ; fail

  register-extension3 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension3", "29,2,30,36")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "30,4,30,36")
    ; rules (
        Foo :+
          xs -> ["Ext3"|xs]
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension3", "29,2,30,36")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension3", "29,2,30,36")
      ; fail

  register-extension4 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension4", "32,2,33,36")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "33,4,33,36")
    ; rules (
        Foo :+
          xs -> ["Ext4"|xs]
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension4", "32,2,33,36")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test_chain01.str", "register-extension4", "32,2,33,36")
      ; fail