module test93

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-test93 =
    s-enter(
    | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
    , "main-test93"
    , "10"
    , "2"
    , "38"
    , "6"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "11"
      , "6"
      , "38"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
       , "11"
       , "6"
       , "20"
       , "6"
       )
       ; !Minus(
            And(
              CastPrim(
                Long
              , ExprName(Id("save"))
              )
            , Lit(Hexa("0xffffffffL"))
            )
          , And(
              CastPrim(
                Long
              , ExprName(Id("borrow"))
              )
            , Lit(Hexa("0xffffffffL"))
            )
          ))
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "21"
      , "6"
      , "38"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
       , "21"
       , "6"
       , "21"
       , "25"
       )
       ; parenthesize-Java-15)
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "22"
      , "6"
      , "38"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
       , "22"
       , "6"
       , "22"
       , "57"
       )
       ; say(
           s-step(
           | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
           , "22"
           , "10"
           , "22"
           , "56"
           )
           ; !"------------------------------------------- "
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "23"
      , "6"
      , "38"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
       , "23"
       , "6"
       , "23"
       , "10"
       )
       ; debug)
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "24"
      , "6"
      , "38"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
       , "24"
       , "6"
       , "24"
       , "57"
       )
       ; say(
           s-step(
           | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
           , "24"
           , "10"
           , "24"
           , "56"
           )
           ; !"------------------------------------------- "
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "25"
      , "6"
      , "38"
      , "6"
      )
    ; ?Minus(
         Parenthetical(
           And(
             CastPrim(
               Long
             , ExprName(Id("save"))
             )
           , Lit(Hexa("0xffffffffL"))
           )
         )
       , Parenthetical(
           And(
             CastPrim(
               Long
             , ExprName(Id("borrow"))
             )
           , Lit(Hexa("0xffffffffL"))
           )
         )
       )
    < s-exit(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "main-test93"
      , "10"
      , "2"
      , "38"
      , "6"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "main-test93"
      , "10"
      , "2"
      , "38"
      , "6"
      )
      ; fail

  parenthesize-Java-15 =
    s-enter(
    | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
    , "parenthesize-Java-15"
    , "40"
    , "2"
    , "41"
    , "33"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "41"
      , "4"
      , "41"
      , "33"
      )
    ; innermost(
        s-step(
        | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
        , "41"
        , "14"
        , "41"
        , "32"
        )
        ; Java-15Parenthesize
      )
    < s-exit(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "parenthesize-Java-15"
      , "40"
      , "2"
      , "41"
      , "33"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
      , "parenthesize-Java-15"
      , "40"
      , "2"
      , "41"
      , "33"
      )
      ; fail


rules

  Java-15Parenthesize :
    Minus(t_0) -> <r-exit(
                   | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                   , "Java-15Parenthesize"
                   , "50"
                   , "2"
                   , "54"
                   , "23"
                   )> Minus(Parenthetical(t_0))
    where r-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test93.str", "Java-15Parenthesize", "50,2,54,23")
          <+ r-exit(
             | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
             , "Java-15Parenthesize"
             , "50"
             , "2"
             , "54"
             , "23"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
          , "52"
          , "10"
          , "54"
          , "23"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
              , "52"
              , "12"
              , "54"
              , "17"
              )
              ; (s-step(
                 | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                 , "52"
                 , "12"
                 , "52"
                 , "23"
                 )
                 ; ?Minus(_, _)
                 + s-step(
                   | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                   , "53"
                   , "14"
                   , "54"
                   , "17"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                      , "53"
                      , "14"
                      , "53"
                      , "23"
                      )
                      ; ?And(_, _)
                      + s-step(
                        | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                        , "54"
                        , "14"
                        , "54"
                        , "17"
                        )
                        ; fail)))> t_0
          <+ r-exit(
             | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
             , "Java-15Parenthesize"
             , "50"
             , "2"
             , "54"
             , "23"
             )
             ; fail

  Java-15Parenthesize :
    Minus(t_0, t_1) -> <r-exit(
                        | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                        , "Java-15Parenthesize"
                        , "56"
                        , "2"
                        , "59"
                        , "23"
                        )> Minus(Parenthetical(t_0), t_1)
    where r-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test93.str", "Java-15Parenthesize", "56,2,59,23")
          <+ r-exit(
             | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
             , "Java-15Parenthesize"
             , "56"
             , "2"
             , "59"
             , "23"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
          , "58"
          , "10"
          , "59"
          , "23"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
              , "58"
              , "12"
              , "59"
              , "17"
              )
              ; (s-step(
                 | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                 , "58"
                 , "12"
                 , "58"
                 , "21"
                 )
                 ; ?And(_, _)
                 + s-step(
                   | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                   , "59"
                   , "14"
                   , "59"
                   , "17"
                   )
                   ; fail))> t_0
          <+ r-exit(
             | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
             , "Java-15Parenthesize"
             , "56"
             , "2"
             , "59"
             , "23"
             )
             ; fail

  Java-15Parenthesize :
    Minus(t_0, t_1) -> <r-exit(
                        | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                        , "Java-15Parenthesize"
                        , "61"
                        , "2"
                        , "65"
                        , "23"
                        )> Minus(t_0, Parenthetical(t_1))
    where r-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test93.str", "Java-15Parenthesize", "61,2,65,23")
          <+ r-exit(
             | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
             , "Java-15Parenthesize"
             , "61"
             , "2"
             , "65"
             , "23"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
          , "63"
          , "10"
          , "65"
          , "23"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
              , "63"
              , "12"
              , "65"
              , "17"
              )
              ; (s-step(
                 | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                 , "63"
                 , "12"
                 , "63"
                 , "21"
                 )
                 ; ?And(_, _)
                 + s-step(
                   | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                   , "64"
                   , "14"
                   , "65"
                   , "17"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                      , "64"
                      , "14"
                      , "64"
                      , "25"
                      )
                      ; ?Minus(_, _)
                      + s-step(
                        | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
                        , "65"
                        , "14"
                        , "65"
                        , "17"
                        )
                        ; fail)))> t_1
          <+ r-exit(
             | "strategoxt/stratego-libraries/java-backend/test/strc1/test93.str"
             , "Java-15Parenthesize"
             , "61"
             , "2"
             , "65"
             , "23"
             )
             ; fail


signature
  constructors
    Parenthetical : Unknown -> Unknown

  constructors
    And      : Expr * Expr -> Expr
    Minus    : Expr * Expr -> Expr
    Minus    : Expr -> Expr
    CastPrim : PrimType * Expr -> Expr
    Lit      : Literal -> Expr
    Long     : IntType
    ExprName : Id -> ExprName
    Hexa     : HexaLiteral -> IntLiteral
             : String -> HexaLiteral
    Id       : ID -> Id
             : String -> ID