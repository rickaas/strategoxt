module switch-semantics-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-test85 =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "main-test85", "5,2,11,2")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "6,2,11,2")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "6,13,6,41")
        ; !"switch construct testsuite"
      , s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "7,4,10,14")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "7,4,7,12") ; test-woow)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "8,4,10,14")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "8,4,8,11") ; test-wow)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "9,4,10,14")
        ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "9,4,9,18") ; test-failbranch)
        ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "10,4,10,14")
        ; test-nested
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "main-test85", "5,2,11,2")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "main-test85", "5,2,11,2")
      ; fail

  test-woow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-woow", "13,2,27,9")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "14,4,27,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "14,4,18,9")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "15,6,15,16") ; switch-woow
         | "switch-woow int"
         , 3
         , 101
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "19,4,27,9")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "19,4,23,26")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "20,6,20,16") ; switch-woow
         | "switch-woow string"
         , "three"
         , "string case failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "24,4,27,9")
    ; apply-and-fail(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "25,6,25,16") ; switch-woow
      | "switch-woow real"
      , 3.5
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-woow", "13,2,27,9")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-woow", "13,2,27,9")
      ; fail

  test-wow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-wow", "29,2,44,22")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "30,4,44,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "30,4,34,9")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "31,6,31,15") ; switch-wow
         | "switch-wow int"
         , 3
         , 101
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "35,4,44,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "35,4,39,26")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "36,6,36,15") ; switch-wow
         | "switch-wow string"
         , "three"
         , "string case failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "40,4,44,22")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "41,6,41,15") ; switch-wow
      | "switch-wow real"
      , 3.5
      , "otherwise case"
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-wow", "29,2,44,22")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-wow", "29,2,44,22")
      ; fail

  test-failbranch =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-failbranch", "46,2,60,22")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "47,4,60,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "47,4,50,7")
       ; apply-and-fail(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "48,6,48,19") ; switch-intfail
         | "switch-intfail int"
         , 3
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "51,4,60,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "51,4,55,26")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "52,6,52,19") ; switch-intfail
         | "switch-intfail string"
         , "three"
         , "string case failed"
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "56,4,60,22")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "57,6,57,19") ; switch-intfail
      | "switch-intfail real"
      , 3.5
      , "otherwise case"
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-failbranch", "46,2,60,22")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-failbranch", "46,2,60,22")
      ; fail

  test-nested =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-nested", "62,2,72,22")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "63,4,72,22")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "63,4,67,9")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "64,6,64,18") ; switch-nested
         | "switch-nested int"
         , 3
         , 101
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "68,4,72,22")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "69,6,69,18") ; switch-nested
      | "switch-nested string"
      , "three"
      , "otherwise case"
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-nested", "62,2,72,22")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "test-nested", "62,2,72,22")
      ; fail

  switch-woow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-woow", "74,2,80,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "75,4,80,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "75,4,75,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "76,4,80,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "76,4,76,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "77,4,80,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "77,11,77,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "78,11,78,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "78,20,78,41")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "78,20,78,34")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "78,21,78,23") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "78,28,78,29") ; id>
                                                                                                                    , 1
                                                                                                                    )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "78,39,78,41")
                ; !-1)
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "79,11,79,19") ; is-string :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "79,23,79,77")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "79,23,79,52")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "79,24,79,29") ; strcat)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "79,34,79,35") ; id>
                                                                                                                       , "should fail"
                                                                                                                       )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "79,57,79,77")
                ; !"string case failed")
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-woow", "74,2,80,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-woow", "74,2,80,6")
      ; fail

  switch-wow =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-wow", "82,2,89,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "83,4,89,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "83,4,83,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "84,4,89,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "84,4,84,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "85,4,89,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "85,11,85,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "86,11,86,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "86,20,86,41")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "86,20,86,34")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "86,21,86,23") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "86,28,86,29") ; id>
                                                                                                                    , 1
                                                                                                                    )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "86,39,86,41")
                ; !-1)
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "87,11,87,19") ; is-string :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "87,23,87,77")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "87,23,87,52")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "87,24,87,29") ; strcat)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "87,34,87,35") ; id>
                                                                                                                       , "should fail"
                                                                                                                       )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "87,57,87,77")
                ; !"string case failed")
        otherwise :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "88,18,88,34")
          ; !"otherwise case"
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-wow", "82,2,89,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-wow", "82,2,89,6")
      ; fail

  switch-intfail =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-intfail", "91,2,98,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "92,4,98,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "92,4,92,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "93,4,98,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "93,4,93,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "94,4,98,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "94,11,94,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "95,11,95,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "95,20,95,23") ; fail
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "96,11,96,19") ; is-string :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "96,23,96,77")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "96,23,96,52")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "96,24,96,29") ; strcat)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "96,34,96,35") ; id>
                                                                                                                       , "should fail"
                                                                                                                       )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "96,57,96,77")
                ; !"string case failed")
        otherwise :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "97,18,97,34")
          ; !"otherwise case"
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-intfail", "91,2,98,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-intfail", "91,2,98,6")
      ; fail

  switch-nested =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-nested", "100,2,111,6")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "101,4,111,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "101,4,101,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "102,4,111,6")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "102,4,102,7")
       ; !100)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "103,4,111,6")
    ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "103,11,103,12") ; !x
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "105,8,108,10")
             ; switch s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "105,15,105,20")
                      ; !"foo"
                 case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "106,15,106,20") ; is-int :
                   s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "106,24,106,27") ; fail
                 case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "107,15,107,23") ; is-string :
                   s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "107,27,107,30") ; fail
               end :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "108,23,108,46")
          ; !"nested case condition"
        case s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "109,11,109,16") ; is-int :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "109,20,109,41")
          ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "109,20,109,34")
             ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "109,21,109,23") ; add)> ( <s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "109,28,109,29") ; id>
                                                                                                                      , 1
                                                                                                                      )
             <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "109,39,109,41")
                ; !-1)
        otherwise :
          s-step(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "110,18,110,34")
          ; !"otherwise case"
      end
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-nested", "100,2,111,6")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc1/test85.str", "switch-nested", "100,2,111,6")
      ; fail