module assignment

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    A : Term
    G : Term -> Term
    F : Term * Term -> Term


strategies
  main-assignment =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "main-assignment", "11,2,11,31")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "11,20,11,31")
    ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "11,21,11,23") ; bla)> G(A())
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "main-assignment", "11,2,11,31")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "main-assignment", "11,2,11,31")
      ; fail

  s =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "s", "13,2,13,19")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "13,6,13,19")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "13,6,13,10")
       ; ?G(x))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "13,13,13,19")
    ; !F(x, x)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "s", "13,2,13,19")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "s", "13,2,13,19")
      ; fail

  bla =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "bla", "15,2,15,19")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "15,8,15,19")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "15,8,15,8") ; s) => F(x, y)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "bla", "15,2,15,19")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/assignment.str", "bla", "15,2,15,19")
      ; fail