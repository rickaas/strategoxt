module higher-order-arg

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/cons


strategies
  implode-string =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "implode-string", "6,2,6,51")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "6,19,6,51")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "6,19,6,20") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "6,23,6,51")
    ; prim("SSL_implode_string", x)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "implode-string", "6,2,6,51")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "implode-string", "6,2,6,51")
      ; fail

  explode-string =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "explode-string", "7,2,7,51")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "7,19,7,51")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "7,19,7,20") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "7,23,7,51")
    ; prim("SSL_explode_string", x)
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "explode-string", "7,2,7,51")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "explode-string", "7,2,7,51")
      ; fail

  escape(esc : ( List(String) -> List(String) ) * List(String) -> List(String)) =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "escape", "9,2,12,17")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "10,4,12,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "10,4,10,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,4,12,17")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,4,11,34")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,10,11,33")
           ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,10,11,15")
              ; esc(
                  s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,14,11,14") ; x
                )
              <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,20,11,33")
                 ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,20,11,27")
                    ; [s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,21,11,22") ; id|s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,26,11,26") ; x]
                    <+ s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "11,32,11,33") ; []))
         ))
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "12,4,12,17")
    ; implode-string
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "escape", "9,2,12,17")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "escape", "9,2,12,17")
      ; fail

  cify =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "cify", "14,2,14,20")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "14,9,14,20")
    ; escape(
        s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "14,16,14,19") ; Cify
      )
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "cify", "14,2,14,20")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "cify", "14,2,14,20")
      ; fail


rules

  Cify(x) :
    [39|cs] -> <r-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "18,2,18,45")> [95, 112, 95|<s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "18,41,18,41") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "18,2,18,45")
          <+ r-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "18,2,18,45")
             ; fail

  Cify(x) :
    [45|cs] -> <r-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "19,2,19,45")> [95|<s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "19,41,19,41") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "19,2,19,45")
          <+ r-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "19,2,19,45")
             ; fail

  Cify(x) :
    [95|cs] -> <r-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "20,2,20,45")> [95, 95|<s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "20,41,20,41") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "20,2,20,45")
          <+ r-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "Cify", "20,2,20,45")
             ; fail


strategies
  main-higher_order_arg =
    s-enter(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "main-higher_order_arg", "24,2,25,33")
    ; s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "25,4,25,33")
    ; (s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "25,4,25,18")
       ; <(s-step(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "25,5,25,8") ; cify)> "a-b_c'") => "a_b__c_p_"
    < s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "main-higher_order_arg", "24,2,25,33")
    + s-exit(|"strategoxt/stratego-libraries/java-backend/test/strc2/higher_order_arg.str", "main-higher_order_arg", "24,2,25,33")
      ; fail