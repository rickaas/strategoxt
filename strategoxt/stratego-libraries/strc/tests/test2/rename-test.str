module rename-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "main"
    , "5"
    , "2"
    , "9"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "6"
      , "4"
      , "9"
      , "4"
      )
    ; test-suite(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "6"
        , "15"
        , "6"
        , "28"
        )
        ; !"rename-test"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "7"
        , "1"
        , "8"
        , "5"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "7"
           , "1"
           , "7"
           , "5"
           )
           ; test1)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
          , "8"
          , "1"
          , "8"
          , "5"
          )
        ; test2
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "main"
      , "5"
      , "2"
      , "9"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "main"
      , "5"
      , "2"
      , "9"
      , "4"
      )
      ; fail


signature
  sorts
    Exp

  constructors
    Abs : String * Exp -> Exp
    Var : String -> Exp
    App : Exp * Exp -> Exp


rules

  EBnd :
    Abs(x, e) -> <r-exit(
                  | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                  , "EBnd"
                  , "19"
                  , "2"
                  , "19"
                  , "24"
                  )> [x]
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/rename-test.str", "EBnd", "19,2,19,24")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "EBnd"
             , "19"
             , "2"
             , "19"
             , "24"
             )
             ; fail


strategies
  is-evar(s) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "is-evar"
    , "23"
    , "2"
    , "23"
    , "20"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "23"
      , "15"
      , "23"
      , "20"
      )
    ; Var(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "23"
        , "19"
        , "23"
        , "19"
        )
        ; s
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "is-evar"
      , "23"
      , "2"
      , "23"
      , "20"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "is-evar"
      , "23"
      , "2"
      , "23"
      , "20"
      )
      ; fail

  EPaste(nwvars) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "EPaste"
    , "25"
    , "2"
    , "26"
    , "22"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "26"
      , "4"
      , "26"
      , "22"
      )
    ; Abs(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "26"
        , "8"
        , "26"
        , "17"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "26"
           , "8"
           , "26"
           , "13"
           )
           ; nwvars)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
          , "26"
          , "16"
          , "26"
          , "17"
          )
        ; Hd
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "26"
        , "20"
        , "26"
        , "21"
        )
        ; id
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "EPaste"
      , "25"
      , "2"
      , "26"
      , "22"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "EPaste"
      , "25"
      , "2"
      , "26"
      , "22"
      )
      ; fail

  EBoundIn(bndvars, ubndvars, ignore) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "EBoundIn"
    , "28"
    , "2"
    , "29"
    , "23"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "29"
      , "4"
      , "29"
      , "23"
      )
    ; Abs(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "29"
        , "8"
        , "29"
        , "13"
        )
        ; ignore
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "29"
        , "16"
        , "29"
        , "22"
        )
        ; bndvars
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "EBoundIn"
      , "28"
      , "2"
      , "29"
      , "23"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "EBoundIn"
      , "28"
      , "2"
      , "29"
      , "23"
      )
      ; fail

  erename =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "erename"
    , "31"
    , "2"
    , "32"
    , "42"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "32"
      , "4"
      , "32"
      , "42"
      )
    ; rename(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "32"
        , "11"
        , "32"
        , "17"
        )
        ; is-evar
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "32"
        , "20"
        , "32"
        , "23"
        )
        ; EBnd
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "32"
        , "26"
        , "32"
        , "33"
        )
        ; EBoundIn
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "32"
        , "36"
        , "32"
        , "41"
        )
        ; EPaste
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "erename"
      , "31"
      , "2"
      , "32"
      , "42"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "erename"
      , "31"
      , "2"
      , "32"
      , "42"
      )
      ; fail

  test1 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "test1"
    , "34"
    , "3"
    , "39"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "35"
      , "5"
      , "39"
      , "1"
      )
    ; apply-and-check(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "35"
        , "21"
        , "35"
        , "28"
        )
        ; !"test1"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "36"
        , "3"
        , "36"
        , "47"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "36"
           , "3"
           , "36"
           , "17"
           )
           ; debug(
               s-step(
               | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
               , "36"
               , "9"
               , "36"
               , "16"
               )
               ; !"bla: "
             ))
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
          , "36"
          , "20"
          , "36"
          , "47"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "36"
           , "20"
           , "36"
           , "26"
           )
           ; erename)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
          , "36"
          , "30"
          , "36"
          , "47"
          )
        ; debug(
            s-step(
            | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
            , "36"
            , "36"
            , "36"
            , "46"
            )
            ; !"blabla: "
          )
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "37"
        , "3"
        , "37"
        , "36"
        )
        ; !App(
             Abs("x", Var("x"))
           , Var("x")
           )
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "38"
        , "3"
        , "38"
        , "66"
        )
        ; {s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "38"
           , "4"
           , "38"
           , "65"
           )
           ; (s-step(
              | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
              , "38"
              , "4"
              , "38"
              , "36"
              )
              ; ?App(
                   Abs(a_0, Var(a_0))
                 , Var("x")
                 ))
           ; s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "38"
             , "39"
             , "38"
             , "65"
             )
           ; where(s-step(
                   | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                   , "38"
                   , "45"
                   , "38"
                   , "64"
                   )
                   ; <(s-step(
                       | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                       , "38"
                       , "46"
                       , "38"
                       , "52"
                       )
                       ; not(s-step(
                             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                             , "38"
                             , "50"
                             , "38"
                             , "51"
                             )
                             ; eq))> (a_0, "x"))}
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "test1"
      , "34"
      , "3"
      , "39"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "test1"
      , "34"
      , "3"
      , "39"
      , "1"
      )
      ; fail


signature
  sorts
    Exp

  constructors
    Abs    : String * Type * Exp -> Exp
    Var    : String * Type -> Exp
    Letrec : List(Fdec) * Exp -> Exp
    Fdec   : String * Type * Exp -> Fdec


rules

  TBnd :
    Abs(x, t, e) -> <r-exit(
                     | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                     , "TBnd"
                     , "50"
                     , "2"
                     , "50"
                     , "27"
                     )> [x]
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/rename-test.str", "TBnd", "50,2,50,27")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "TBnd"
             , "50"
             , "2"
             , "50"
             , "27"
             )
             ; fail

  TBnd :
    Letrec(fdecs, e) -> <r-exit(
                         | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                         , "TBnd"
                         , "51"
                         , "2"
                         , "51"
                         , "45"
                         )> <s-step(
                             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                             , "51"
                             , "30"
                             , "51"
                             , "38"
                             )
                             ; map(
                                 s-step(
                                 | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                                 , "51"
                                 , "34"
                                 , "51"
                                 , "37"
                                 )
                                 ; Name
                               )> fdecs
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/rename-test.str", "TBnd", "51,2,51,45")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "TBnd"
             , "51"
             , "2"
             , "51"
             , "45"
             )
             ; fail

  Name :
    Fdec(f, t, e) -> <r-exit(
                      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                      , "Name"
                      , "53"
                      , "2"
                      , "53"
                      , "26"
                      )> f
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/rename-test.str", "Name", "53,2,53,26")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "Name"
             , "53"
             , "2"
             , "53"
             , "26"
             )
             ; fail


strategies
  is-var(s) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "is-var"
    , "57"
    , "2"
    , "57"
    , "23"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "57"
      , "14"
      , "57"
      , "23"
      )
    ; Var(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "57"
        , "18"
        , "57"
        , "18"
        )
        ; s
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "57"
        , "21"
        , "57"
        , "22"
        )
        ; id
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "is-var"
      , "57"
      , "2"
      , "57"
      , "23"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "is-var"
      , "57"
      , "2"
      , "57"
      , "23"
      )
      ; fail

  TBoundIn(bndvars, ubndvars, ignore) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "TBoundIn"
    , "59"
    , "2"
    , "61"
    , "27"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "60"
      , "4"
      , "61"
      , "27"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
       , "60"
       , "4"
       , "60"
       , "31"
       )
       ; Abs(
           s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "60"
           , "8"
           , "60"
           , "13"
           )
           ; ignore
         , s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "60"
           , "16"
           , "60"
           , "21"
           )
           ; ignore
         , s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "60"
           , "24"
           , "60"
           , "30"
           )
           ; bndvars
         )
       + s-step(
         | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
         , "61"
         , "4"
         , "61"
         , "27"
         )
         ; Letrec(
             s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "61"
             , "11"
             , "61"
             , "17"
             )
             ; bndvars
           , s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "61"
             , "20"
             , "61"
             , "26"
             )
             ; bndvars
           ))
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "TBoundIn"
      , "59"
      , "2"
      , "61"
      , "27"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "TBoundIn"
      , "59"
      , "2"
      , "61"
      , "27"
      )
      ; fail

  TPaste(nwvars) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "TPaste"
    , "63"
    , "2"
    , "65"
    , "47"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "64"
      , "4"
      , "65"
      , "47"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
       , "64"
       , "4"
       , "64"
       , "26"
       )
       ; Abs(
           s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "64"
           , "8"
           , "64"
           , "17"
           )
           ; (s-step(
              | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
              , "64"
              , "8"
              , "64"
              , "13"
              )
              ; nwvars)
           ; s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "64"
             , "16"
             , "64"
             , "17"
             )
           ; Hd
         , s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "64"
           , "20"
           , "64"
           , "21"
           )
           ; id
         , s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
           , "64"
           , "24"
           , "64"
           , "25"
           )
           ; id
         )
       + s-step(
         | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
         , "65"
         , "4"
         , "65"
         , "47"
         )
         ; Letrec(
             s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "65"
             , "11"
             , "65"
             , "42"
             )
             ; (s-step(
                | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                , "65"
                , "11"
                , "65"
                , "26"
                )
                ; split(
                    s-step(
                    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                    , "65"
                    , "17"
                    , "65"
                    , "18"
                    )
                    ; id
                  , s-step(
                    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                    , "65"
                    , "20"
                    , "65"
                    , "25"
                    )
                    ; nwvars
                  ))
             ; s-step(
               | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
               , "65"
               , "29"
               , "65"
               , "42"
               )
             ; zip(
                 s-step(
                 | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                 , "65"
                 , "33"
                 , "65"
                 , "41"
                 )
                 ; PasteFdec
               )
           , s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "65"
             , "45"
             , "65"
             , "46"
             )
             ; id
           ))
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "TPaste"
      , "63"
      , "2"
      , "65"
      , "47"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "TPaste"
      , "63"
      , "2"
      , "65"
      , "47"
      )
      ; fail

  PasteFdec :
    (Fdec(f, t, e), g) -> <r-exit(
                           | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
                           , "PasteFdec"
                           , "68"
                           , "2"
                           , "69"
                           , "38"
                           )> Fdec(g, t, e)
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/rename-test.str", "PasteFdec", "68,2,69,38")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
             , "PasteFdec"
             , "68"
             , "2"
             , "69"
             , "38"
             )
             ; fail

  trename =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "trename"
    , "71"
    , "2"
    , "72"
    , "41"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "72"
      , "4"
      , "72"
      , "41"
      )
    ; rename(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "72"
        , "11"
        , "72"
        , "16"
        )
        ; is-var
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "72"
        , "19"
        , "72"
        , "22"
        )
        ; TBnd
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "72"
        , "25"
        , "72"
        , "32"
        )
        ; TBoundIn
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "72"
        , "35"
        , "72"
        , "40"
        )
        ; TPaste
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "trename"
      , "71"
      , "2"
      , "72"
      , "41"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "trename"
      , "71"
      , "2"
      , "72"
      , "41"
      )
      ; fail

  test2 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
    , "test2"
    , "74"
    , "3"
    , "79"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "75"
      , "5"
      , "79"
      , "1"
      )
    ; apply-and-check(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "75"
        , "21"
        , "75"
        , "28"
        )
        ; !"test2"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "76"
        , "3"
        , "76"
        , "9"
        )
        ; trename
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "77"
        , "3"
        , "77"
        , "55"
        )
        ; !App(
             Abs(
               "x"
             , "a"
             , Var("x", "a")
             )
           , Var("x", "a")
           )
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
        , "78"
        , "3"
        , "78"
        , "51"
        )
        ; ?App(
             Abs(
               b_0
             , "a"
             , Var(b_0, "a")
             )
           , Var("x", "a")
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "test2"
      , "74"
      , "3"
      , "79"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/rename-test.str"
      , "test2"
      , "74"
      , "3"
      , "79"
      , "1"
      )
      ; fail