module match-arity

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    If   : Exp * Exp -> Exp
    If   : Exp * Exp * Exp -> Exp
    Skip : Exp


rules

  R1 :
    If(c, x) -> <r-exit(
                 | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
                 , "R1"
                 , "12"
                 , "2"
                 , "12"
                 , "32"
                 )> If(c, x, Skip)
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/match-arity.str", "R1", "12,2,12,32")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
             , "R1"
             , "12"
             , "2"
             , "12"
             , "32"
             )
             ; fail

  R2 :
    If(c, x, Skip) -> <r-exit(
                       | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
                       , "R2"
                       , "14"
                       , "2"
                       , "14"
                       , "32"
                       )> If(c, x)
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test2/match-arity.str", "R2", "14,2,14,32")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
             , "R2"
             , "14"
             , "2"
             , "14"
             , "32"
             )
             ; fail


strategies
  main =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "main"
    , "18"
    , "2"
    , "26"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "19"
      , "4"
      , "26"
      , "4"
      )
    ; test-suite(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "19"
        , "15"
        , "19"
        , "28"
        )
        ; !"match-arity"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "20"
        , "1"
        , "25"
        , "12"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "20"
           , "1"
           , "20"
           , "12"
           )
           ; match-arity1)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
          , "21"
          , "1"
          , "25"
          , "12"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "21"
           , "1"
           , "21"
           , "12"
           )
           ; match-arity2)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
          , "22"
          , "1"
          , "25"
          , "12"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "22"
           , "1"
           , "22"
           , "12"
           )
           ; match-arity3)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
          , "23"
          , "1"
          , "25"
          , "12"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "23"
           , "1"
           , "23"
           , "12"
           )
           ; match-arity4)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
          , "24"
          , "1"
          , "25"
          , "12"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "24"
           , "1"
           , "24"
           , "12"
           )
           ; match-arity5)
        ; s-step(
          | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
          , "25"
          , "1"
          , "25"
          , "12"
          )
        ; match-arity6
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "main"
      , "18"
      , "2"
      , "26"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "main"
      , "18"
      , "2"
      , "26"
      , "4"
      )
      ; fail

  match-arity1 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "match-arity1"
    , "28"
    , "2"
    , "33"
    , "7"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "29"
      , "4"
      , "33"
      , "7"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "29"
        , "15"
        , "29"
        , "29"
        )
        ; !"match-arity1"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "30"
        , "8"
        , "30"
        , "14"
        )
        ; not(s-step(
              | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
              , "30"
              , "12"
              , "30"
              , "13"
              )
              ; R1)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "31"
        , "8"
        , "31"
        , "28"
        )
        ; !If(Skip, Skip, Skip)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "32"
        , "8"
        , "32"
        , "28"
        )
        ; !If(Skip, Skip, Skip)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity1"
      , "28"
      , "2"
      , "33"
      , "7"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity1"
      , "28"
      , "2"
      , "33"
      , "7"
      )
      ; fail

  match-arity2 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "match-arity2"
    , "35"
    , "2"
    , "40"
    , "7"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "36"
      , "4"
      , "40"
      , "7"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "36"
        , "15"
        , "36"
        , "29"
        )
        ; !"match-arity2"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "37"
        , "8"
        , "37"
        , "14"
        )
        ; not(s-step(
              | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
              , "37"
              , "12"
              , "37"
              , "13"
              )
              ; R2)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "38"
        , "8"
        , "38"
        , "22"
        )
        ; !If(Skip, Skip)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "39"
        , "8"
        , "39"
        , "22"
        )
        ; !If(Skip, Skip)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity2"
      , "35"
      , "2"
      , "40"
      , "7"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity2"
      , "35"
      , "2"
      , "40"
      , "7"
      )
      ; fail

  match-arity3 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "match-arity3"
    , "42"
    , "2"
    , "47"
    , "7"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "43"
      , "4"
      , "47"
      , "7"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "43"
        , "15"
        , "43"
        , "29"
        )
        ; !"match-arity3"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "44"
        , "8"
        , "44"
        , "9"
        )
        ; R1
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "45"
        , "8"
        , "45"
        , "22"
        )
        ; !If(Skip, Skip)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "46"
        , "8"
        , "46"
        , "28"
        )
        ; !If(Skip, Skip, Skip)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity3"
      , "42"
      , "2"
      , "47"
      , "7"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity3"
      , "42"
      , "2"
      , "47"
      , "7"
      )
      ; fail

  match-arity4 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "match-arity4"
    , "49"
    , "2"
    , "54"
    , "7"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "50"
      , "4"
      , "54"
      , "7"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "50"
        , "15"
        , "50"
        , "29"
        )
        ; !"match-arity4"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "51"
        , "8"
        , "51"
        , "9"
        )
        ; R2
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "52"
        , "8"
        , "52"
        , "28"
        )
        ; !If(Skip, Skip, Skip)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "53"
        , "8"
        , "53"
        , "22"
        )
        ; !If(Skip, Skip)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity4"
      , "49"
      , "2"
      , "54"
      , "7"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity4"
      , "49"
      , "2"
      , "54"
      , "7"
      )
      ; fail

  match-arity5 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "match-arity5"
    , "56"
    , "2"
    , "61"
    , "7"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "57"
      , "4"
      , "61"
      , "7"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "57"
        , "15"
        , "57"
        , "29"
        )
        ; !"match-arity5"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "58"
        , "8"
        , "58"
        , "14"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "58"
           , "8"
           , "58"
           , "9"
           )
           ; R1
           + s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
             , "58"
             , "13"
             , "58"
             , "14"
             )
             ; R2)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "59"
        , "8"
        , "59"
        , "28"
        )
        ; !If(Skip, Skip, Skip)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "60"
        , "8"
        , "60"
        , "22"
        )
        ; !If(Skip, Skip)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity5"
      , "56"
      , "2"
      , "61"
      , "7"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity5"
      , "56"
      , "2"
      , "61"
      , "7"
      )
      ; fail

  match-arity6 =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
    , "match-arity6"
    , "63"
    , "2"
    , "68"
    , "7"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "64"
      , "4"
      , "68"
      , "7"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "64"
        , "15"
        , "64"
        , "29"
        )
        ; !"match-arity6"
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "65"
        , "8"
        , "65"
        , "14"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
           , "65"
           , "8"
           , "65"
           , "9"
           )
           ; R1
           + s-step(
             | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
             , "65"
             , "13"
             , "65"
             , "14"
             )
             ; R2)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "66"
        , "8"
        , "66"
        , "22"
        )
        ; !If(Skip, Skip)
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
        , "67"
        , "8"
        , "67"
        , "28"
        )
        ; !If(Skip, Skip, Skip)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity6"
      , "63"
      , "2"
      , "68"
      , "7"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test2/match-arity.str"
      , "match-arity6"
      , "63"
      , "2"
      , "68"
      , "7"
      )
      ; fail