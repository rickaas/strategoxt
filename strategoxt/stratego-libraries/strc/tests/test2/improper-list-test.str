module improper-list-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    Bla : List(a) -> List(a)


strategies
  main =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "main", "10,2,12,7")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "11,4,12,7")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "11,5,11,52")
       ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "11,5,11,44")
          ; !["a"|["b"|Bla(
                         ["c"|["d"|[]]]
                       )]]
          <+ s-step(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "11,49,11,52")
             ; !"a"))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "12,4,12,7")
    ; ?"a"
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "main", "10,2,12,7")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test2/improper-list-test.str", "main", "10,2,12,7")
      ; fail