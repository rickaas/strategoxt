module test35

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/cons
  collection/tuple/cons


signature
  constructors
    Stream : ImplDep -> Stream
    Path   : String -> FileLoc
    stdin  : FileLoc
    stdout : FileLoc
    stderr : FileLoc


strategies
  Hd :
    [x|_] -> <r-exit(
              | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
              , "Hd"
              , "16"
              , "2"
              , "16"
              , "22"
              )> x
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test35.str", "Hd", "16,2,16,22")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
             , "Hd"
             , "16"
             , "2"
             , "16"
             , "22"
             )
             ; fail

  Tl :
    [_|l] -> <r-exit(
              | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
              , "Tl"
              , "17"
              , "2"
              , "17"
              , "22"
              )> l
    where r-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test35.str", "Tl", "17,2,17,22")
          <+ r-exit(
             | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
             , "Tl"
             , "17"
             , "2"
             , "17"
             , "22"
             )
             ; fail

  member =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
    , "member"
    , "19"
    , "2"
    , "20"
    , "18"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "20"
      , "4"
      , "20"
      , "18"
      )
    ; ( s-step(
        | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
        , "20"
        , "5"
        , "20"
        , "6"
        )
        ; ?x
      , s-step(
        | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
        , "20"
        , "9"
        , "20"
        , "17"
        )
        ; fetch(
            s-step(
            | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
            , "20"
            , "15"
            , "20"
            , "16"
            )
            ; ?x
          )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "member"
      , "19"
      , "2"
      , "20"
      , "18"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "member"
      , "19"
      , "2"
      , "20"
      , "18"
      )
      ; fail

  main =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
    , "main"
    , "22"
    , "2"
    , "23"
    , "39"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "23"
      , "4"
      , "23"
      , "39"
      )
    ; <(s-step(
        | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
        , "23"
        , "5"
        , "23"
        , "15"
        )
        ; not(s-step(
              | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
              , "23"
              , "9"
              , "23"
              , "14"
              )
              ; member))> ( "a"
                          , ["d", "b", "c"]
                          )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "main"
      , "22"
      , "2"
      , "23"
      , "39"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "main"
      , "22"
      , "2"
      , "23"
      , "39"
      )
      ; fail

  fetch(s) =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
    , "fetch"
    , "25"
    , "2"
    , "26"
    , "30"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "26"
      , "4"
      , "26"
      , "30"
      )
    ; rec x (
        s-step(
        | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
        , "26"
        , "10"
        , "26"
        , "29"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
           , "26"
           , "10"
           , "26"
           , "17"
           )
           ; [s-step(
              | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
              , "26"
              , "11"
              , "26"
              , "11"
              )
              ; s|s-step(
                  | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                  , "26"
                  , "15"
                  , "26"
                  , "16"
                  )
                  ; id]
           <+ s-step(
              | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
              , "26"
              , "22"
              , "26"
              , "29"
              )
              ; [s-step(
                 | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                 , "26"
                 , "23"
                 , "26"
                 , "24"
                 )
                 ; id|s-step(
                      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                      , "26"
                      , "28"
                      , "26"
                      , "28"
                      )
                      ; x])
      )
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "fetch"
      , "25"
      , "2"
      , "26"
      , "30"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "fetch"
      , "25"
      , "2"
      , "26"
      , "30"
      )
      ; fail

  main' =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
    , "main'"
    , "28"
    , "2"
    , "29"
    , "46"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "29"
      , "4"
      , "29"
      , "46"
      )
    ; <(s-step(
        | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
        , "29"
        , "5"
        , "29"
        , "13"
        )
        ; different)> [ "F"
                      , "G"
                      , "X"
                      , "e_0"
                      , "f_0"
                      , "d_0"
                      ]
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "main'"
      , "28"
      , "2"
      , "29"
      , "46"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "main'"
      , "28"
      , "2"
      , "29"
      , "46"
      )
      ; fail

  different =
    s-enter(
    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
    , "different"
    , "31"
    , "2"
    , "33"
    , "31"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "32"
      , "5"
      , "33"
      , "30"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
       , "32"
       , "5"
       , "32"
       , "6"
       )
       ; []
       + s-step(
         | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
         , "32"
         , "10"
         , "33"
         , "30"
         )
         ; (s-step(
            | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
            , "32"
            , "10"
            , "32"
            , "42"
            )
            ; where(s-step(
                    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                    , "32"
                    , "16"
                    , "32"
                    , "41"
                    )
                    ; (s-step(
                       | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                       , "32"
                       , "16"
                       , "32"
                       , "28"
                       )
                       ; !( <s-step(
                             | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                             , "32"
                             , "19"
                             , "32"
                             , "20"
                             )
                             ; Hd>
                          , <s-step(
                             | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                             , "32"
                             , "25"
                             , "32"
                             , "26"
                             )
                             ; Tl>
                          ))
                    ; s-step(
                      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                      , "32"
                      , "31"
                      , "32"
                      , "41"
                      )
                    ; not(s-step(
                          | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                          , "32"
                          , "35"
                          , "32"
                          , "40"
                          )
                          ; member)))
         ; s-step(
           | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
           , "33"
           , "11"
           , "33"
           , "30"
           )
         ; where(s-step(
                 | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                 , "33"
                 , "17"
                 , "33"
                 , "29"
                 )
                 ; (s-step(
                    | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                    , "33"
                    , "17"
                    , "33"
                    , "18"
                    )
                    ; Tl)
                 ; s-step(
                   | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
                   , "33"
                   , "21"
                   , "33"
                   , "29"
                   )
                 ; different))
    < s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "different"
      , "31"
      , "2"
      , "33"
      , "31"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/strc/tests/test1/test35.str"
      , "different"
      , "31"
      , "2"
      , "33"
      , "31"
      )
      ; fail