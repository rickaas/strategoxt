module test89

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "main", "5,2,7,46")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "6,4,7,46")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "6,4,6,53")
       ; <(s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "6,5,6,14") ; all-G-by-H)> H(
                                                                                                             G(
                                                                                                               G(
                                                                                                                 H(
                                                                                                                   G(B, I(1))
                                                                                                                 , A
                                                                                                                 )
                                                                                                               , B
                                                                                                               )
                                                                                                             , I(0)
                                                                                                             )
                                                                                                           , A
                                                                                                           )) => H(
                                                                                                                   G(
                                                                                                                     G(
                                                                                                                       H(
                                                                                                                         H(B, I(1))
                                                                                                                       , A
                                                                                                                       )
                                                                                                                     , B
                                                                                                                     )
                                                                                                                   , I(0)
                                                                                                                   )
                                                                                                                 , A
                                                                                                                 )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "main", "5,2,7,46")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "main", "5,2,7,46")
      ; fail

  all-G-by-H =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "all-G-by-H", "9,2,10,41")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "10,4,10,41")
    ; bottomup-term(
        s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "10,18,10,40")
        ; try(
            s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "10,22,10,39")
            ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "10,22,10,29")
               ; ?G(x, y))
            ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "10,32,10,39")
            ; !H(x, y)
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "all-G-by-H", "9,2,10,41")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "all-G-by-H", "9,2,10,41")
      ; fail


strategies
  all-term(s) =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "all-term", "14,2,14,64")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,17,14,63")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,17,14,19") ; A
       + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,23,14,63")
         ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,23,14,25") ; B
            + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,29,14,63")
              ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,29,14,35")
                 ; F(
                     s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,31,14,31") ; s
                   , s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,34,14,34") ; s
                   )
                 + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,39,14,63")
                   ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,39,14,45")
                      ; G(
                          s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,41,14,41") ; s
                        , s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,44,14,44") ; s
                        )
                      + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,49,14,63")
                        ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,49,14,55")
                           ; H(
                               s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,51,14,51") ; s
                             , s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,54,14,54") ; s
                             )
                           + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,59,14,63")
                             ; I(
                                 s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "14,61,14,62") ; id
                               ))))))
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "all-term", "14,2,14,64")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "all-term", "14,2,14,64")
      ; fail

  bottomup-term(s) =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "bottomup-term", "15,4,15,52")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "15,23,15,52")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "15,23,15,48")
       ; all-term(
           s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "15,32,15,47")
           ; bottomup-term(
               s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "15,46,15,46") ; s
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "15,52,15,52")
    ; s
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "bottomup-term", "15,4,15,52")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test89.str", "bottomup-term", "15,4,15,52")
      ; fail


signature
  sorts
    Term

  constructors
    A : Term
    B : Term
    F : Term * Term -> Term
    G : Term * Term -> Term
    H : Term * Term -> Term
    I : Int -> Term