module test14

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/cons
  collection/tuple/cons


signature
  constructors
    Add : Int * Int -> Exp


strategies
  try(s) =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "try", "9,2,10,10")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "10,4,10,10")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "10,4,10,4") ; s
       <+ s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "10,9,10,10") ; id)
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "try", "9,2,10,10")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "try", "9,2,10,10")
      ; fail

  list(s) =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "list", "12,2,13,22")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "13,4,13,22")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "13,10,13,21")
        ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "13,10,13,11") ; []
           + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "13,15,13,21")
             ; [s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "13,16,13,16") ; s|s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "13,20,13,20") ; x])
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "list", "12,2,13,22")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "list", "12,2,13,22")
      ; fail

  main =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "main", "15,2,17,15")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "16,4,17,15")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "16,4,16,23")
       ; list(
           s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "16,9,16,22")
           ; try(
               s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "16,13,16,21")
               ; ?Add(1, x)
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "17,7,17,14")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "17,7,17,8") ; !x
       <+ s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "17,13,17,14")
          ; !2)
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "main", "15,2,17,15")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test14.str", "main", "15,2,17,15")
      ; fail