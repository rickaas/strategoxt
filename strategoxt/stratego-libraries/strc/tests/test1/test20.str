module test20

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/cons
  collection/tuple/cons


strategies
  main =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "main", "5,2,12,8")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "6,4,12,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "6,4,6,8") ; test1)
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "7,4,12,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "7,4,7,8") ; test2)
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "8,4,12,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "8,4,8,8") ; test3)
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "9,4,12,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "9,4,9,8") ; test4)
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "10,4,12,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "10,4,10,8") ; test5)
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "11,4,12,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "11,4,11,8") ; test6)
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "12,4,12,8")
    ; test7
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "main", "5,2,12,8")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "main", "5,2,12,8")
      ; fail

  test1 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test1", "14,2,17,13")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "15,4,17,13")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "15,4,15,7")
       ; !"a")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "16,4,17,13")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "16,4,16,16")
       ; !( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "16,7,16,8") ; id>
          , <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "16,13,16,14") ; id>
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "17,4,17,13")
    ; ?("a", "a")
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test1", "14,2,17,13")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test1", "14,2,17,13")
      ; fail

  test2 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test2", "19,2,22,19")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "20,4,22,19")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "20,4,20,7")
       ; !"b")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "21,4,22,19")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "21,4,21,26")
       ; !( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "21,7,21,8") ; id>
          , <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "21,13,21,24")
             ; !( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "21,16,21,17") ; id>
                , <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "21,21,21,22") ; id>
                )>
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "22,4,22,19")
    ; ?("b", ("b", "b"))
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test2", "19,2,22,19")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test2", "19,2,22,19")
      ; fail

  test3 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test3", "24,2,27,19")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "25,4,27,19")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "25,4,25,7")
       ; !"c")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "26,4,27,19")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "26,4,26,23")
       ; !( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "26,7,26,8") ; id>
          , ( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "26,14,26,15") ; id>
            , <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "26,19,26,20") ; id>
            )
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "27,4,27,19")
    ; ?("c", ("c", "c"))
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test3", "24,2,27,19")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test3", "24,2,27,19")
      ; fail

  test4 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test4", "29,2,32,7")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "30,4,32,7")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "30,4,30,13")
       ; !("a", "b"))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "31,4,32,7")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "31,4,31,13")
       ; ?( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "31,7,31,8") ; id>
          , _
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "32,4,32,7")
    ; ?"a"
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test4", "29,2,32,7")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test4", "29,2,32,7")
      ; fail

  test5 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test5", "34,2,37,7")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "35,4,37,7")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "35,4,35,19")
       ; !(("a", "b"), "c"))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "36,4,37,7")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "36,4,36,19")
       ; ?( ( _
            , <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "36,11,36,12") ; id>
            )
          , "c"
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "37,4,37,7")
    ; ?"b"
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test5", "34,2,37,7")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test5", "34,2,37,7")
      ; fail

  map(s) =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "map", "39,2,40,22")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "40,4,40,22")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "40,10,40,21")
        ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "40,10,40,11") ; []
           + s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "40,15,40,21")
             ; [s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "40,16,40,16") ; s|s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "40,20,40,20") ; x])
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "map", "39,2,40,22")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "map", "39,2,40,22")
      ; fail

  test6 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test6", "42,2,45,19")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "43,4,45,19")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "43,4,43,40")
       ; ![ ("a", "b")
          , ("c", "d")
          , ("e", "f")
          ])
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "44,4,45,19")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "44,4,44,17")
       ; map(
           s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "44,8,44,16")
           ; ?( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "44,11,44,12") ; id>
              , _
              )
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "45,4,45,19")
    ; ?["a", "c", "e"]
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test6", "42,2,45,19")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test6", "42,2,45,19")
      ; fail

  test7 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test7", "47,2,51,38")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "48,4,51,38")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "48,4,49,42")
       ; ![ [ ("a", "b")
            , ("c", "d")
            , ("e", "f")
            ]
          , [ ("a", "b")
            , ("c", "d")
            , ("e", "f")
            ]
          ])
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "50,4,51,38")
    ; (s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "50,4,50,22")
       ; map(
           s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "50,8,50,21")
           ; map(
               s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "50,12,50,20")
               ; ?( <s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "50,15,50,16") ; id>
                  , _
                  )
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "51,4,51,38")
    ; ?[ ["a", "c", "e"]
       , ["a", "c", "e"]
       ]
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test7", "47,2,51,38")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/test1/test20.str", "test7", "47,2,51,38")
      ; fail