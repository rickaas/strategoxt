module build-match-laws-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  libstrc


strategies
  build-match-laws-test-io =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "build-match-laws-test-io", "5,2,9,4")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "6,4,9,4")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "6,15,6,38")
        ; !"build-match-laws-test"
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "7,1,8,7")
        ; (s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "7,1,7,5") ; test2)
        ; s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "8,3,8,7")
        ; test3
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "build-match-laws-test-io", "5,2,9,4")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "build-match-laws-test-io", "5,2,9,4")
      ; fail

  test2 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "test2", "27,2,42,1")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "28,4,42,1")
    ; apply-and-check(
        s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "28,20,28,27")
        ; !"test2"
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "29,3,29,10") ; simplify
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "30,3,32,73")
        ; !Seq(
             Build(
               Op(
                 "TCons"
               , [ Var("b_0")
                 , Op(
                     "TCons"
                   , [ Var("c_0")
                     , Op("TNil", [])
                     ]
                   )
                 ]
               )
             )
           , Seq(
               Match(
                 Op(
                   "TCons"
                 , [ Var("f_0")
                   , Op(
                       "TCons"
                     , [ Var("g_0")
                       , Op("TNil", [])
                       ]
                     )
                   ]
                 )
               )
             , Where(
                 PrimT(
                   "SSL_fprintnl"
                 , []
                 , [Var("f_0"), Var("g_0")]
                 )
               )
             )
           )
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "33,3,41,30")
        ; ?Scope(
             [a_0]
           , Seq(
               Build(Var("b_0"))
             , Seq(
                 Match(Var("f_0"))
               , Seq(
                   Build(Var("c_0"))
                 , Seq(
                     Match(Var("g_0"))
                   , Seq(
                       Build(
                         Op(
                           "TCons"
                         , [ Var("b_0")
                           , Op(
                               "TCons"
                             , [ Var("c_0")
                               , Op("TNil", [])
                               ]
                             )
                           ]
                         )
                       )
                     , Seq(
                         Match(Var(a_0))
                       , Seq(
                           PrimT(
                             "SSL_fprintnl"
                           , []
                           , [Var("f_0"), Var("g_0")]
                           )
                         , Build(Var(a_0))
                         )
                       )
                     )
                   )
                 )
               )
             )
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "test2", "27,2,42,1")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "test2", "27,2,42,1")
      ; fail

  test3 =
    s-enter(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "test3", "44,2,55,1")
    ; s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "45,4,55,1")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "45,15,45,22")
        ; !"test3"
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "46,3,46,10") ; simplify
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "47,3,49,65")
        ; !Seq(
             Build(
               Op(
                 "TCons"
               , [ Var("b_0")
                 , Op(
                     "TCons"
                   , [ Var("c_0")
                     , Op("TNil", [])
                     ]
                   )
                 ]
               )
             )
           , Seq(
               Match(
                 Op(
                   "TCons"
                 , [ Var("f_0")
                   , Op(
                       "TCons"
                     , [ Var("g_0")
                       , Op("TNil", [])
                       ]
                     )
                   ]
                 )
               )
             , PrimT(
                 "SSL_fprintnl"
               , []
               , [Var("f_0"), Var("g_0")]
               )
             )
           )
      , s-step(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "50,3,54,59")
        ; !Seq(
             Build(Var("b_0"))
           , Seq(
               Match(Var("f_0"))
             , Seq(
                 Build(Var("c_0"))
               , Seq(
                   Match(Var("g_0"))
                 , PrimT(
                     "SSL_fprintnl"
                   , []
                   , [Var("f_0"), Var("g_0")]
                   )
                 )
               )
             )
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "test3", "44,2,55,1")
    + s-exit(|"strategoxt/stratego-libraries/strc/tests/unit/build-match-laws-test.str", "test3", "44,2,55,1")
      ; fail