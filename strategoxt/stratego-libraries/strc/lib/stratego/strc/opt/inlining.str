module inlining

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  Stratego-Amb
  stratego/strc/lib/stratlib
  stratego/strc/opt/stratego-laws
  stratego/strc/front/rename-defs


overlays
  dont-inline = []

  INLINE_MAX_TERM_SIZE = 50


strategies
  inline-strategies =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-strategies", "39,2,40,47")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "40,4,40,47")
    ; Specification(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "40,18,40,46")
        ; [ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "40,19,40,20") ; id
          , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "40,22,40,45")
            ; Strategies(
                s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "40,33,40,44") ; inline-sdefs
              )
          ]
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-strategies", "39,2,40,47")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-strategies", "39,2,40,47")
      ; fail

  inline-sdefs =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-sdefs", "42,2,49,103")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "43,4,49,103")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "43,4,43,20")
       ; try(
           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "43,8,43,19")
           ; olevel3(
               s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "43,16,43,18") ; ?o3
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "44,6,49,103")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "44,6,48,6")
       ; map(
           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,8,47,71")
           ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,8,45,63")
              ; AnnoDef(
                  s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,16,45,25")
                  ; [ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,17,45,24") ; Internal
                    ]
                , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,28,45,62")
                  ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,28,45,36") ; simplify0)
                  ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,39,45,62")
                  ; try(
                      s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,43,45,61")
                      ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,43,45,52") ; inlineable)
                      ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "45,55,45,61")
                      ; AddSDef
                    )
                )
              <+ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,8,47,71")
                 ; ignore-anno-def(
                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,24,47,70")
                     ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,24,47,32") ; simplify0)
                     ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,35,47,70")
                     ; try(
                         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,39,47,69")
                         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,39,47,48")
                            ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,45,47,47") ; !o3))
                         ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,51,47,69")
                         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,51,47,60") ; inlineable)
                         ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "47,63,47,69")
                         ; AddSDef
                       )
                   ))
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,6,49,103")
    ; map(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,10,49,102")
        ; ignore-anno-def(
            s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,26,49,101")
            ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,26,49,60")
               ; SDefT(
                   s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,32,49,50") ; "DYNAMIC_CALLS_0_0"
                 , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,52,49,53") ; id
                 , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,55,49,56") ; id
                 , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,58,49,59") ; id
                 )
               <+ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,65,49,101")
                  ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,65,49,75") ; inline-sdef)
                  ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,78,49,101")
                  ; try(
                      s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,82,49,100")
                      ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,82,49,91") ; inlineable)
                      ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "49,94,49,100")
                      ; AddSDef
                    ))
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-sdefs", "42,2,49,103")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-sdefs", "42,2,49,103")
      ; fail

  inline-sdef =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-sdef", "51,2,54,63")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "52,4,54,63")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "52,4,52,29")
       ; DeclareInline(
           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "52,18,52,28") ; inline-sdef
         )
       <+ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "53,7,54,63")
          ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "53,7,53,31")
             ; UndefineSDef(
                 s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "53,20,53,30") ; inline-sdef
               )
             <+ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "54,7,54,63")
                ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "54,7,54,45")
                   ; repeat(
                       s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "54,35,54,44") ; InlineCall
                     ))
                ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "54,48,54,63")
                ; all(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "54,52,54,62") ; inline-sdef)))
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-sdef", "51,2,54,63")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inline-sdef", "51,2,54,63")
      ; fail

  DeclareInline(x) =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "DeclareInline", "56,2,61,8")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "57,4,61,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "57,4,57,16")
       ; ?Let(defs, s))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "58,6,61,8")
    ; {|InlineCall:
         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,11,60,12")
         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,11,59,57")
            ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,17,59,56")
                    ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,18,59,50")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,22,59,49")
                            ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,22,59,40")
                               ; local-inlinable(|s))
                            ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "59,43,59,49")
                            ; AddSDef
                          ))> defs))
         ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "60,4,60,12")
         ; Let(
             s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "60,8,60,8") ; x
           , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "60,11,60,11") ; x
           )
      |}
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "DeclareInline", "56,2,61,8")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "DeclareInline", "56,2,61,8")
      ; fail

  UndefineSDef(x) =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "UndefineSDef", "63,2,68,8")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "64,4,68,8")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "64,4,64,18")
       ; ?SDefT(f, _, _, _))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "65,6,68,8")
    ; {|InlineCall:
         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "66,9,67,25")
         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "66,9,66,53")
            ; rules (
                InlineCall :-
                  CallT(SVar(f), ss, ts)
              ))
         ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "67,9,67,25")
         ; SDefT(
             s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "67,15,67,16") ; id
           , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "67,18,67,19") ; id
           , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "67,21,67,22") ; id
           , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "67,24,67,24") ; x
           )
      |}
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "UndefineSDef", "63,2,68,8")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "UndefineSDef", "63,2,68,8")
      ; fail

  AddSDef =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "AddSDef", "70,2,72,42")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "71,4,72,42")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "71,4,71,30")
       ; ?ExtSDefInl(f, as1, as2, s))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "72,6,72,42")
    ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "72,12,72,41")
            ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "72,13,72,19") ; AddSDef)> SDefT(f, as1, as2, s))
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "AddSDef", "70,2,72,42")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "AddSDef", "70,2,72,42")
      ; fail

  AddSDef =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "AddSDef", "74,2,100,4")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "75,4,100,4")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "75,4,75,26")
       ; ?sdef@SDefT(f, _, _, _))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "76,6,100,4")
    ; rules (
        InlineCall :
          CallT(SVar(f), ss, ts) -> <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "78,35,78,42") ; simplify> s''
          where s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "80,6,86,55")
                ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "80,6,80,43")
                   ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "80,6,80,20")
                      ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "80,7,80,14") ; strename)> sdef) => SDefT(f, xs, ys, s))
                ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "81,14,86,55")
                ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "81,14,81,48")
                   ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "81,14,81,42")
                      ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "81,15,81,29") ; substitute-args)> (xs, ss, s)) => s')
                ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "82,7,86,55")
                ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "82,7,82,38")
                   ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "82,7,82,31")
                      ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "82,8,82,27")
                          ; map(
                              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "82,12,82,26")
                              ; ?VarDec(
                                   <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "82,21,82,22") ; id>
                                 , _
                                 )
                            ))> ys) => ys')
                ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "83,7,86,55")
                ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "83,7,85,19")
                   ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "83,7,84,85")
                      ; !Scope(
                           ys'
                         , Seq(
                             <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "84,12,84,69")
                              ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "84,12,84,63")
                                 ; zip(
                                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "84,16,84,61")
                                     ; \ (t, y) -> Where(
                                                     Seq(
                                                       Build(t)
                                                     , Match(Var(y))
                                                     )
                                                   ) \
                                   ))
                              ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "84,66,84,69")
                              ; seqs> (ts, ys')
                           , s'
                           )
                         )) => s'')
                ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "86,14,86,55")
                ; rules (
                    InlineCall :-
                      CallT(SVar(f), _, _)
                  )
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "AddSDef", "74,2,100,4")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "AddSDef", "74,2,100,4")
      ; fail

  substitute-args =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-args", "102,2,107,5")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "103,4,107,5")
    ; {|SubsArgCall1, SubsArgCall2:
         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "104,7,106,53")
         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "104,7,104,18")
            ; ?(xs, ss, s))
         ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "105,9,106,53")
         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "105,9,105,38")
            ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "105,10,105,28")
                ; zip(
                    s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "105,14,105,27") ; substitute-arg
                  ))> (xs, ss))
         ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "106,9,106,53")
         ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "106,10,106,50")
             ; topdown(
                 s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "106,18,106,49")
                 ; try(
                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "106,22,106,48")
                     ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "106,22,106,33") ; SubsArgCall1
                        + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "106,37,106,48") ; SubsArgCall2)
                   )
               ))> s
      |}
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-args", "102,2,107,5")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-args", "102,2,107,5")
      ; fail

  substitute-arg =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-arg", "109,2,111,63")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "110,4,111,63")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "110,4,110,34")
       ; ?( VarDec(x, FunType([_], _))
          , s
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "111,4,111,63")
    ; rules (
        SubsArgCall1 :
          CallT(SVar(x), [], []) -> <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "111,52,111,59") ; strename> s
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-arg", "109,2,111,63")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-arg", "109,2,111,63")
      ; fail

  substitute-arg =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-arg", "113,2,115,73")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "114,4,115,73")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "114,4,114,59")
       ; ?( VarDec(
              x
            , FunType([_, _|_], _)
            )
          , CallT(SVar(y), [], [])
          ))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "115,4,115,73")
    ; rules (
        SubsArgCall2 :
          CallT(SVar(x), ss, ts) -> CallT(SVar(y), ss, ts)
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-arg", "113,2,115,73")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "substitute-arg", "113,2,115,73")
      ; fail

  inlineable =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inlineable", "117,2,120,66")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,4,120,66")
    ; SDefT(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,10,119,28")
        ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,10,119,24")
           ; not(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,14,119,23") ; "main_0_0"))
        ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,27,119,28")
        ; ?f
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,31,119,32") ; id
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "119,35,119,36") ; id
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "120,11,120,65")
        ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "120,11,120,49")
           ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "120,17,120,48")
                   ; not(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "120,21,120,47")
                         ; oncetd(
                             s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "120,28,120,46")
                             ; ?CallT(SVar(f), _, _)
                           ))))
        ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "120,52,120,65")
        ; body-to-inline
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inlineable", "117,2,120,66")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inlineable", "117,2,120,66")
      ; fail

  inlineable =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inlineable", "124,2,127,66")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,4,127,66")
    ; ExtSDefInl(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,15,126,33")
        ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,15,126,29")
           ; not(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,19,126,28") ; "main_0_0"))
        ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,32,126,33")
        ; ?f
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,36,126,37") ; id
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "126,40,126,41") ; id
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "127,11,127,65")
        ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "127,11,127,49")
           ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "127,17,127,48")
                   ; not(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "127,21,127,47")
                         ; oncetd(
                             s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "127,28,127,46")
                             ; ?CallT(SVar(f), _, _)
                           ))))
        ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "127,52,127,65")
        ; body-to-inline
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inlineable", "124,2,127,66")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "inlineable", "124,2,127,66")
      ; fail

  local-inlinable(|s1) =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "local-inlinable", "131,2,136,6")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "132,4,136,6")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "132,4,132,22")
       ; ?SDefT(f, _, _, s2))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "133,6,136,6")
    ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "134,1,135,56")
            ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "134,1,134,37")
               ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "134,2,134,33")
                   ; not(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "134,6,134,32")
                         ; oncetd(
                             s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "134,13,134,31")
                             ; ?CallT(SVar(f), _, _)
                           )))> s2)
            ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "135,10,135,56")
            ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "135,11,135,13") ; leq)> ( <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "135,17,135,48")
                                                                                                                             ; occurrences(
                                                                                                                                 s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "135,29,135,47")
                                                                                                                                 ; ?CallT(SVar(f), _, _)
                                                                                                                               )> s1
                                                                                                                          , 1
                                                                                                                          ))
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "local-inlinable", "131,2,136,6")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "local-inlinable", "131,2,136,6")
      ; fail

  body-to-inline =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "body-to-inline", "144,2,162,52")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "145,4,162,52")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "145,4,161,4")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "146,8,159,13")
           ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "146,8,146,11") ; Id
              + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "147,3,159,13")
                ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "147,3,147,8") ; Fail
                   + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "148,3,159,13")
                     ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "148,3,148,23")
                        ; CallT(
                            s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "148,9,148,16")
                            ; SVar(
                                s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "148,14,148,15") ; id
                              )
                          , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "148,18,148,19") ; id
                          , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "148,21,148,22") ; id
                          )
                        + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "149,3,159,13")
                          ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "149,3,149,23")
                             ; PrimT(
                                 s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "149,9,149,16")
                                 ; SVar(
                                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "149,14,149,15") ; id
                                   )
                               , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "149,18,149,19") ; id
                               , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "149,21,149,22") ; id
                               )
                             + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "150,3,159,13")
                               ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "150,3,150,11")
                                  ; Build(
                                      s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "150,9,150,10") ; id
                                    )
                                  + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "151,3,159,13")
                                    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "151,3,151,11")
                                       ; Match(
                                           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "151,9,151,10") ; id
                                         )
                                       + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "152,3,159,13")
                                         ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "152,3,152,20")
                                            ; Seq(
                                                s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "152,7,152,15")
                                                ; Match(
                                                    s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "152,13,152,14") ; id
                                                  )
                                              , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "152,18,152,19") ; id
                                              )
                                            + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "153,3,159,13")
                                              ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "153,3,153,22")
                                                 ; Scope(
                                                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "153,9,153,10") ; id
                                                   , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "153,13,153,21")
                                                     ; Match(
                                                         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "153,19,153,20") ; id
                                                       )
                                                   )
                                                 + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,3,159,13")
                                                   ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,3,154,31")
                                                      ; Scope(
                                                          s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,9,154,10") ; id
                                                        , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,13,154,30")
                                                          ; Seq(
                                                              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,17,154,25")
                                                              ; Match(
                                                                  s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,23,154,24") ; id
                                                                )
                                                            , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "154,28,154,29") ; id
                                                            )
                                                        )
                                                      + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,3,159,13")
                                                        ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,3,155,40")
                                                           ; Seq(
                                                               s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,7,155,35")
                                                               ; Scope(
                                                                   s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,13,155,14") ; id
                                                                 , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,17,155,34")
                                                                   ; Seq(
                                                                       s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,21,155,29")
                                                                       ; Match(
                                                                           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,27,155,28") ; id
                                                                         )
                                                                     , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,32,155,33") ; id
                                                                     )
                                                                 )
                                                             , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "155,38,155,39") ; id
                                                             )
                                                           + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "156,3,159,13")
                                                             ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "156,3,156,14")
                                                                ; Choice(
                                                                    s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "156,10,156,10") ; x
                                                                  , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "156,13,156,13") ; x
                                                                  )
                                                                + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "157,3,159,13")
                                                                  ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "157,3,157,15")
                                                                     ; LChoice(
                                                                         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "157,11,157,11") ; x
                                                                       , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "157,14,157,14") ; x
                                                                       )
                                                                     + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "158,3,159,13")
                                                                       ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "158,3,158,25")
                                                                          ; GuardedLChoice(
                                                                              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "158,18,158,18") ; x
                                                                            , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "158,21,158,21") ; x
                                                                            , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "158,24,158,24") ; x
                                                                            )
                                                                          + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "159,3,159,13")
                                                                            ; Cong(
                                                                                s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "159,8,159,9") ; id
                                                                              , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "159,11,159,12") ; id
                                                                              ))))))))))))))
         ))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "162,4,162,52")
    ; where(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "162,10,162,51")
            ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "162,11,162,13") ; leq)> ( <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "162,17,162,25") ; term-size>
                                                                                                                          , INLINE_MAX_TERM_SIZE()
                                                                                                                          ))
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "body-to-inline", "144,2,162,52")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/opt/inlining.str", "body-to-inline", "144,2,162,52")
      ; fail