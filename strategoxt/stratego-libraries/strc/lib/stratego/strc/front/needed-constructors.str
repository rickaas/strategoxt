module needed-constructors

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  stratego/strc/lib/stratlib
  Stratego-MetaTransition


strategies
  needed-constructors :
    Specification(
      [sig, ols, Strategies(sdefs)]
    ) -> <r-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "needed-constructors", "5,2,9,68")> Specification(
                                                                                                                                              [sig', ols, Strategies(sdefs)]
                                                                                                                                            )
    where r-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "needed-constructors", "5,2,9,68")
          <+ r-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "needed-constructors", "5,2,9,68")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "8,10,9,68")
          ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "8,10,8,55")
             ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "8,11,8,48")
                 ; topdown(
                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "8,19,8,47")
                     ; try(
                         s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "8,23,8,46") ; DeclareConstructorNeeded
                       )
                   ))> sdefs)
          ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,3,9,68")
          ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,3,9,60")
             ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,4,9,55")
                 ; Signature(
                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,14,9,54")
                     ; [ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,15,9,53")
                         ; Constructors(
                             s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,28,9,52")
                             ; filter(
                                 s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "9,35,9,51") ; ConstructorNeeded
                               )
                           )
                       ]
                   ))> sig) => sig'
          <+ r-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "needed-constructors", "5,2,9,68")
             ; fail

  DeclareConstructorNeeded =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "DeclareConstructorNeeded", "11,2,15,6")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "12,4,15,6")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "12,4,12,12")
       ; ?Op(c, _))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "13,6,15,6")
    ; rules (
        ConstructorNeeded :
          OpDecl(c, t) -> OpDecl(c, t)
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "DeclareConstructorNeeded", "11,2,15,6")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "DeclareConstructorNeeded", "11,2,15,6")
      ; fail

  DeclareConstructorNeeded =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "DeclareConstructorNeeded", "18,2,20,60")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "19,4,20,60")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "19,4,19,14")
       ; ?Cong(c, _))
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "20,6,20,60")
    ; rules (
        ConstructorNeeded :
          OpDecl(c, t) -> OpDecl(c, t)
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "DeclareConstructorNeeded", "18,2,20,60")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/needed-constructors.str", "DeclareConstructorNeeded", "18,2,20,60")
      ; fail