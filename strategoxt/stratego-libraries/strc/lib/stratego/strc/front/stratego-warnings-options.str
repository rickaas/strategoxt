module stratego-warnings-options

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  Stratego-Sugar


overlays
  AllWarnings (  ) =
    [ ("debug-arguments", "        missing build operator", "on")
    , ("obsolete-strategy-calls", "obsolete strategies", "on")
    , ("maybe-unbound-variables", "unbound variables", "off")
    , ("lower-case-constructors", "lower-case constructors", "on")
    ]


strategies
  stratego-warnings-options =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "stratego-warnings-options", "28,2,52,4")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "29,4,52,4")
    ; ArgOption(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "29,14,29,31")
        ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "29,14,29,24") ; "--warning"
           + s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "29,28,29,31") ; "-W")
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "30,6,46,8")
        ; switch s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "30,13,30,14") ; id
            case s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "31,13,31,17") ; "all" :
              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "32,10,32,61")
              ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "32,11,32,20") ; set-config)> ( "--warning"
                                                                                                                                                    , <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "32,38,32,45")
                                                                                                                                                       ; map(
                                                                                                                                                           s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "32,42,32,44") ; Fst
                                                                                                                                                         )> AllWarnings()
                                                                                                                                                    )
            case s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "34,13,34,54")
                 ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "34,13,34,26") ; explode-string) => ['n', 'o', '-'|wchars] :
              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "35,10,39,43")
              ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "35,10,35,43")
                 ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "35,10,35,32")
                    ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "35,11,35,24") ; implode-string)> wchars) => wstring)
              ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "36,12,39,43")
              ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "36,12,36,25") ; warning-exists)
              ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "37,12,39,43")
              ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "37,12,37,59")
                 ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "37,13,37,46")
                     ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "37,13,37,22") ; get-config
                        <+ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "37,27,37,46") ; get-default-warnings))> "--warning")
              ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "38,12,39,43")
              ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "38,12,38,32")
                 ; filter(
                     s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "38,19,38,31")
                     ; not(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "38,23,38,30") ; ?wstring)
                   ))
              ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "39,12,39,43")
              ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "39,13,39,22") ; set-config)> ( "--warning"
                                                                                                                                                    , <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "39,40,39,41") ; id>
                                                                                                                                                    )
            case s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "41,13,41,46")
                 ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "41,14,41,17") ; elem)> ( <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "41,22,41,23") ; id>
                                                                                                                                                 , <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "41,29,41,44") ; get-all-warnings>
                                                                                                                                                 ) :
              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "42,10,42,46")
              ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "42,11,42,23") ; extend-config)> ( "--warning"
                                                                                                                                                       , [<s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "42,42,42,43") ; id>]
                                                                                                                                                       )
            otherwise :
              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "45,10,45,80")
              ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "45,11,45,21") ; fatal-error)> [ <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "45,26,45,35") ; get-config> "program"
                                                                                                                                                     , ": "
                                                                                                                                                     , <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "45,56,45,57") ; id>
                                                                                                                                                     , ": no such warning"
                                                                                                                                                     ]
          end
      , s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "47,6,51,52")
        ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "47,7,47,20") ; concat-strings)> ["-W,--warning C   Report warnings falling in category C. Categories:\n", "                      all                      all categories \n", "                      no-C                     no warnings in category C\n"|<s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "51,11,51,35") ; Display-possible-warnings> AllWarnings()]
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "stratego-warnings-options", "28,2,52,4")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "stratego-warnings-options", "28,2,52,4")
      ; fail

  get-default-warnings =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-default-warnings", "54,2,55,57")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "55,4,55,57")
    ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "55,5,55,43")
        ; filter(
            s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "55,12,55,42")
            ; \ (warning, _, "on") -> warning \
          ))> AllWarnings()
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-default-warnings", "54,2,55,57")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-default-warnings", "54,2,55,57")
      ; fail

  get-all-warnings =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-all-warnings", "57,2,58,27")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "58,4,58,27")
    ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "58,5,58,12")
        ; map(
            s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "58,9,58,11") ; Fst
          ))> AllWarnings()
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-all-warnings", "57,2,58,27")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-all-warnings", "57,2,58,27")
      ; fail

  warning-exists =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "warning-exists", "60,2,61,55")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "61,4,61,55")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "61,4,61,11") ; ?warning)
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "61,15,61,55")
    ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "61,16,61,41")
        ; fetch-elem(
            s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "61,27,61,40")
            ; ?(warning, _, _)
          ))> AllWarnings()
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "warning-exists", "60,2,61,55")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "warning-exists", "60,2,61,55")
      ; fail

  Display-possible-warnings =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "Display-possible-warnings", "63,2,64,102")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "64,5,64,102")
    ; map(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "64,10,64,100")
        ; \ (s, txt, df) -> <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "64,27,64,40") ; concat-strings> [ "                      "
                                                                                                                                                                  , s
                                                                                                                                                                  , "  "
                                                                                                                                                                  , txt
                                                                                                                                                                  , " [ "
                                                                                                                                                                  , df
                                                                                                                                                                  , " ]\n"
                                                                                                                                                                  ] \
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "Display-possible-warnings", "63,2,64,102")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "Display-possible-warnings", "63,2,64,102")
      ; fail

  get-warnings =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-warnings", "66,2,67,55")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,4,67,55")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,4,67,27")
       ; <(s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,5,67,14") ; get-config)> "--warning"
       <+ s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,32,67,55")
          ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,32,67,45")
             ; !AllWarnings())
          ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,48,67,55")
          ; map(
              s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "67,52,67,54") ; Fst
            ))
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-warnings", "66,2,67,55")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "get-warnings", "66,2,67,55")
      ; fail

  pass-warnings =
    s-enter(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "pass-warnings", "69,2,71,36")
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "70,4,71,36")
    ; (s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "70,4,70,15") ; get-warnings)
    ; s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "71,6,71,36")
    ; mapconcat(
        s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "71,16,71,35")
        ; ![ "--warning"
           , <s-step(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "71,32,71,33") ; id>
           ]
      )
    < s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "pass-warnings", "69,2,71,36")
    + s-exit(|"strategoxt/stratego-libraries/strc/lib/stratego/strc/front/stratego-warnings-options.str", "pass-warnings", "69,2,71,36")
      ; fail