module explode-implode-tests

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  libstratego-aterm


strategies
  main-explode-implode-tests =
    s-enter(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "main-explode-implode-tests", "8,2,13,4")
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "9,4,13,4")
    ; option-wrap(
        s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "9,16,9,30") ; general-options
      , s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "10,6,12,6")
        ; test-suite(
            s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "10,17,10,40")
            ; !"explode-implode tests"
          , s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "11,8,11,22") ; roundtrip-tests
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "main-explode-implode-tests", "8,2,13,4")
    + s-exit(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "main-explode-implode-tests", "8,2,13,4")
      ; fail

  roundtrip-tests =
    s-enter(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "roundtrip-tests", "15,2,35,36")
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "15,20,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "15,20,15,21") ; id)
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "16,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "16,6,16,25")
       ; roundtrip-test(|"1"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "17,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "17,6,17,25")
       ; roundtrip-test(|"2"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "19,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "19,6,19,28")
       ; roundtrip-test(|"\"\""))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "20,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "20,6,20,29")
       ; roundtrip-test(|"\"a\""))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "21,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "21,6,21,31")
       ; roundtrip-test(|"\"abc\""))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "23,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "23,6,23,26")
       ; roundtrip-test(|"[]"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "24,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "24,6,24,27")
       ; roundtrip-test(|"[1]"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "25,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "25,6,25,33")
       ; roundtrip-test(|"[1, 2, 3]"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "27,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "27,6,27,26")
       ; roundtrip-test(|"()"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "28,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "28,6,28,27")
       ; roundtrip-test(|"(1)"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "29,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "29,6,29,30")
       ; roundtrip-test(|"(1, 2)"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "30,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "30,6,30,33")
       ; roundtrip-test(|"(1, 2, 3)"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "32,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "32,6,32,29")
       ; roundtrip-test(|"Foo{}"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "33,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "33,6,33,30")
       ; roundtrip-test(|"Foo{1}"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "34,6,35,36")
    ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "34,6,34,33")
       ; roundtrip-test(|"Foo{1, 2}"))
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "35,6,35,36")
    ; roundtrip-test(|"Foo{1, 2, 3}")
    < s-exit(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "roundtrip-tests", "15,2,35,36")
    + s-exit(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "roundtrip-tests", "15,2,35,36")
      ; fail

  roundtrip-test(|s) =
    s-enter(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "roundtrip-test", "37,2,43,4")
    ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "38,4,43,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "39,6,39,42")
        ; <(s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "39,7,39,18") ; conc-strings)> ("Roundtrip test ", s)
      , s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "40,6,40,33")
        ; (s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "40,6,40,18") ; explode-aterm)
        ; s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "40,21,40,33")
        ; implode-aterm
      , s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "41,6,41,25")
        ; <(s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "41,7,41,22") ; read-from-string)> s
      , s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "42,6,42,25")
        ; <(s-step(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "42,7,42,22") ; read-from-string)> s
      )
    < s-exit(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "roundtrip-test", "37,2,43,4")
    + s-exit(|"strategoxt/stratego-libraries/aterm/tests/explode-implode-tests.str", "roundtrip-test", "37,2,43,4")
      ; fail