module bin-tree-set

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  bin-tree
  term


strategies
  branch(mky, lt, gt, et) =
    s-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "branch", "11,2,15,13")
    ; s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,1,15,13")
    ; (s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,1,12,47")
       ; BinNode(
           s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,9,12,38")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,15,12,37")
                   ; \ x -> <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,22,12,23") ; eq> ( x
                                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,30,12,32") ; mky> ()
                                                                                                                           ) \)
         , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,41,12,42") ; id
         , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "12,45,12,46") ; id
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,1,15,13")
          ; (s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,1,13,55")
             ; BinNode(
                 s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,9,13,46")
                 ; where(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,15,13,45")
                         ; \ x -> <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,22,13,31") ; address-lt> ( <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,35,13,37") ; mky> ()
                                                                                                                                         , x
                                                                                                                                         ) \)
               , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,49,13,50") ; lt
               , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "13,53,13,54") ; id
               )
             <+ s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,1,15,13")
                ; (s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,1,14,55")
                   ; BinNode(
                       s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,9,14,46")
                       ; where(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,15,14,45")
                               ; \ x -> <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,22,14,31") ; address-lt> ( x
                                                                                                                                               , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,38,14,40") ; mky> ()
                                                                                                                                               ) \)
                     , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,49,14,50") ; id
                     , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "14,53,14,54") ; gt
                     )
                   <+ s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "15,1,15,13")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "15,1,15,9") ; EmptyNode)
                      ; s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "15,12,15,13")
                      ; et)))
    < s-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "branch", "11,2,15,13")
    + s-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "branch", "11,2,15,13")
      ; fail


rules

  bin-add :
    (a, t) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "bin-add", "19,2,21,62")> <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "21,2,21,59")
                                                                                                                   ; rec x (
                                                                                                                       s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "21,8,21,58")
                                                                                                                       ; branch(
                                                                                                                           s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "21,15,21,16") ; !a
                                                                                                                         , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "21,19,21,19") ; x
                                                                                                                         , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "21,22,21,22") ; x
                                                                                                                         , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "21,25,21,57")
                                                                                                                           ; !BinNode(a, EmptyNode, EmptyNode)
                                                                                                                         )
                                                                                                                     )> t
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "bin-add", "19,2,21,62")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "bin-add", "19,2,21,62")
             ; fail

  Merge(s) :
    (EmptyNode, x) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "23,2,24,19")> x
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "23,2,24,19")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "23,2,24,19")
             ; fail

  Merge(s) :
    (x, EmptyNode) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "26,2,27,19")> x
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "26,2,27,19")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "26,2,27,19")
             ; fail

  Merge(s) :
    ( BinNode(x, l1, r1)
    , BinNode(x, l2, r2)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "29,2,31,38")> BinNode(
                                                                                                             x
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "31,13,31,13") ; s> (l1, l2)
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "31,27,31,27") ; s> (r1, r2)
                                                                                                           )
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "29,2,31,38")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "29,2,31,38")
             ; fail

  Merge(s) :
    ( BinNode(x, l1, EmptyNode)
    , BinNode(y, l2, r2)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "33,2,36,25")> BinNode(
                                                                                                             y
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "35,13,35,13") ; s> (BinNode(x, l1, EmptyNode), l2)
                                                                                                           , r2
                                                                                                           )
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "33,2,36,25")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "33,2,36,25")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "36,7,36,25")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "36,8,36,17") ; address-lt)> (x, y)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "33,2,36,25")
             ; fail

  Merge(s) :
    ( BinNode(x, EmptyNode, r1)
    , BinNode(y, l2, r2)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "38,2,41,25")> BinNode(
                                                                                                             y
                                                                                                           , l2
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "40,17,40,17") ; s> (BinNode(x, EmptyNode, r1), r2)
                                                                                                           )
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "38,2,41,25")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "38,2,41,25")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "41,7,41,25")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "41,8,41,17") ; address-lt)> (y, x)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "38,2,41,25")
             ; fail

  Merge(s) :
    ( BinNode(x, l1, r1)
    , BinNode(y, l2, r2)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "43,2,46,25")> <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "45,2,45,2") ; s> ( r1
                                                                                                                                                                                                       , BinNode(
                                                                                                                                                                                                           y
                                                                                                                                                                                                         , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "45,22,45,22") ; s> (BinNode(x, l1, EmptyNode), l2)
                                                                                                                                                                                                         , r2
                                                                                                                                                                                                         )
                                                                                                                                                                                                       )
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "43,2,46,25")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "43,2,46,25")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "46,7,46,25")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "46,8,46,17") ; address-lt)> (x, y)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "43,2,46,25")
             ; fail

  Merge(s) :
    ( BinNode(x, l1, r1)
    , BinNode(y, l2, r2)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "48,2,51,25")> <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "50,2,50,2") ; s> ( r2
                                                                                                                                                                                                       , BinNode(
                                                                                                                                                                                                           x
                                                                                                                                                                                                         , <s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "50,22,50,22") ; s> (BinNode(y, l2, EmptyNode), l1)
                                                                                                                                                                                                         , r1
                                                                                                                                                                                                         )
                                                                                                                                                                                                       )
    where r-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "48,2,51,25")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "48,2,51,25")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "51,7,51,25")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "51,8,51,17") ; address-lt)> (y, x)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "Merge", "48,2,51,25")
             ; fail


strategies
  merge =
    s-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "merge", "55,2,55,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "55,10,55,24")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "55,16,55,23")
        ; Merge(
            s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "55,22,55,22") ; x
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "merge", "55,2,55,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "merge", "55,2,55,24")
      ; fail

  mkbinset =
    s-enter(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "mkbinset", "57,2,57,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "57,13,57,38")
    ; foldr(
        s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "57,19,57,28") ; !EmptyNode
      , s-step(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "57,31,57,37") ; bin-add
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "mkbinset", "57,2,57,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/ssl-compat/bin-tree-set.str", "mkbinset", "57,2,57,38")
      ; fail