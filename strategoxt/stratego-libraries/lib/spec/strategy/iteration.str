module strategy/iteration

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  strategy/conditional


strategies
  repeat(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "11,2,12,20")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "12,4,12,20")
    ; try(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "12,8,12,19")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "12,8,12,8") ; s)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "12,11,12,19")
        ; repeat(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "12,18,12,18") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "11,2,12,20")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "11,2,12,20")
      ; fail

  repeat(s, c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "17,2,18,25")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,4,18,25")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,5,18,19")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,5,18,5") ; s)
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,8,18,19")
       ; repeat(
           s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,15,18,15") ; s
         , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,18,18,18") ; c
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "18,25,18,25") ; c)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "17,2,18,25")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "17,2,18,25")
      ; fail

  repeat1(s, c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat1", "23,2,24,26")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,4,24,26")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,4,24,4") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,8,24,25")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,8,24,20")
       ; repeat1(
           s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,16,24,16") ; s
         , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,19,24,19") ; c
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "24,25,24,25") ; c)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat1", "23,2,24,26")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat1", "23,2,24,26")
      ; fail

  repeat1(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat1", "29,2,30,17")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "30,4,30,17")
    ; repeat1(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "30,12,30,12") ; s
      , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "30,15,30,16") ; id
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat1", "29,2,30,17")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat1", "29,2,30,17")
      ; fail

  repeat-until(s, c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat-until", "35,2,36,31")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,4,36,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,4,36,4") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,8,36,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,8,36,8") ; c
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,13,36,30")
          ; repeat-until(
              s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,26,36,26") ; s
            , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "36,29,36,29") ; c
            ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat-until", "35,2,36,31")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat-until", "35,2,36,31")
      ; fail

  repeat(s|n) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "43,2,49,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "44,4,49,6")
    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "44,7,44,16")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "44,8,44,9") ; eq)> (n, 0) then
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "46,6,46,7") ; id
      else
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "48,6,48,24")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "48,6,48,6") ; s)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "48,9,48,24")
        ; repeat(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "48,16,48,16") ; s
          | <s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "48,19,48,21") ; dec> n
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "43,2,49,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "repeat", "43,2,49,6")
      ; fail

  while(c, s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "while", "54,2,55,25")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,4,55,25")
    ; try(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,8,55,24")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,8,55,8") ; c)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,11,55,24")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,11,55,11") ; s)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,14,55,24")
        ; while(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,20,55,20") ; c
          , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "55,23,55,23") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "while", "54,2,55,25")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "while", "54,2,55,25")
      ; fail

  while-not(c, s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "while-not", "60,2,61,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,4,61,28")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,4,61,4") ; c
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,10,61,27")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,10,61,10") ; s)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,13,61,27")
          ; while-not(
              s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,23,61,23") ; c
            , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "61,26,61,26") ; s
            ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "while-not", "60,2,61,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "while-not", "60,2,61,28")
      ; fail

  do-while(s, c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "do-while", "66,2,67,17")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "67,4,67,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "67,4,67,4") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "67,7,67,17")
    ; while(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "67,13,67,13") ; c
      , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "67,16,67,16") ; s
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "do-while", "66,2,67,17")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "do-while", "66,2,67,17")
      ; fail

  for(i, c, s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "for", "73,2,74,21")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "74,4,74,21")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "74,4,74,4") ; i)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "74,7,74,21")
    ; while-not(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "74,17,74,17") ; c
      , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "74,20,74,20") ; s
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "for", "73,2,74,21")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "for", "73,2,74,21")
      ; fail

  for(s : Int * a -> a|low, up) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "for", "79,2,83,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "80,4,83,6")
    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "80,7,80,20")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "80,8,80,10") ; leq)> (low, up) then
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "81,6,82,28")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "81,6,81,12")
           ; s(|low))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "82,8,82,28")
        ; for(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "82,12,82,12") ; s
          | <s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "82,17,82,19") ; inc> low
          , up
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "for", "79,2,83,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/iteration.str", "for", "79,2,83,6")
      ; fail