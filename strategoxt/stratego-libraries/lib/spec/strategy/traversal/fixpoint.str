module strategy/traversal/fixpoint

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  strategy/iteration
  strategy/traversal/simple
  strategy/general/memo


strategies
  reduce(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "reduce", "15,2,16,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "16,4,16,29")
    ; repeat(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "16,11,16,28")
        ; rec x (
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "16,17,16,27")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "16,17,16,23")
               ; some(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "16,22,16,22") ; x)
               + s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "16,27,16,27") ; s)
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "reduce", "15,2,16,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "reduce", "15,2,16,29")
      ; fail

  outermost(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "outermost", "18,2,19,20")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "19,4,19,20")
    ; repeat(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "19,11,19,19")
        ; oncetd(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "19,18,19,18") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "outermost", "18,2,19,20")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "outermost", "18,2,19,20")
      ; fail

  innermost'(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost'", "21,2,22,20")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "22,4,22,20")
    ; repeat(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "22,11,22,19")
        ; oncebu(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "22,18,22,18") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost'", "21,2,22,20")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost'", "21,2,22,20")
      ; fail

  innermost(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost", "24,2,25,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "25,4,25,33")
    ; bottomup(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "25,13,25,32")
        ; try(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "25,17,25,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "25,17,25,17") ; s)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "25,20,25,31")
            ; innermost(
                s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "25,30,25,30") ; s
              )
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost", "24,2,25,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost", "24,2,25,33")
      ; fail

  innermost-old(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-old", "27,2,28,30")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,4,28,30")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,10,28,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,10,28,15")
           ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,14,28,14") ; x))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,19,28,28")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,19,28,22")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,19,28,19") ; s)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,22,28,22")
           ; x
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "28,27,28,28") ; id)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-old", "27,2,28,30")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-old", "27,2,28,30")
      ; fail

  pseudo-innermost3(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "pseudo-innermost3", "30,2,31,58")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,4,31,58")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,10,31,57")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,10,31,15")
           ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,14,31,14") ; x))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,18,31,57")
        ; rec y (
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,24,31,56")
            ; try(
                s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,28,31,55")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,28,31,28") ; s)
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,31,31,55")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,31,31,52")
                   ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,35,31,51")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,35,31,48")
                            ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,39,31,47")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,39,31,44")
                                     ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,43,31,43") ; y))
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,47,31,47")
                                  ; y))
                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,51,31,51")
                         ; y))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "31,55,31,55")
                ; y
              )
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "pseudo-innermost3", "30,2,31,58")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "pseudo-innermost3", "30,2,31,58")
      ; fail

  innermost-memo(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-memo", "33,2,34,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,4,34,36")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,10,34,35")
        ; memo(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,15,34,34")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,15,34,20")
               ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,19,34,19") ; x))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,24,34,33")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,24,34,27")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,24,34,24") ; s)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,27,34,27")
               ; x
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "34,32,34,33") ; id)
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-memo", "33,2,34,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-memo", "33,2,34,36")
      ; fail

  innermost-tagged(s : a -> a) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-tagged", "41,2,44,23")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "42,4,44,23")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "42,4,42,20")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "42,10,42,19")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "42,10,42,12") ; new) => tag))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,4,44,23")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,4,43,51")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,10,43,50")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,10,43,16")
              ; ?_{tag}
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,22,43,49")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,22,43,27")
                    ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,26,43,26") ; x))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,31,43,48")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,31,43,34")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,31,43,31") ; s)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,34,43,34")
                    ; x
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,39,43,48")
                       ; !<s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "43,41,43,42") ; id>{tag}))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "44,4,44,23")
    ; bottomup(
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "44,13,44,22")
        ; ?<s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "44,15,44,16") ; id>{tag}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-tagged", "41,2,44,23")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/fixpoint.str", "innermost-tagged", "41,2,44,23")
      ; fail