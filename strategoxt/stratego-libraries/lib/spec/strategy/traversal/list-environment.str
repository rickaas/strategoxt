module strategy/traversal/list-environment

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  strategy/traversal/environment
  strategy/traversal/list


rules

  all-l-dist(s) :
    (t, env) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "all-l-dist", "10,2,11,43")> <s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "11,17,11,40")
                                                                                                                                         ; all-l(
                                                                                                                                             s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "11,23,11,39")
                                                                                                                                             ; \ x -> <s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "11,30,11,30") ; s> (x, env) \
                                                                                                                                           )> t
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "all-l-dist", "10,2,11,43")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "all-l-dist", "10,2,11,43")
             ; fail


strategies
  env-alltd-l(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-alltd-l", "15,2,16,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "16,4,16,28")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "16,10,16,27")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "16,10,16,10") ; s
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "16,15,16,27")
              ; all-l-dist(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "16,26,16,26") ; x
                ))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-alltd-l", "15,2,16,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-alltd-l", "15,2,16,28")
      ; fail

  env-topdown-l(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-topdown-l", "18,2,19,26")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "19,4,19,26")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "19,10,19,25")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "19,10,19,10") ; s)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "19,13,19,25")
        ; all-l-dist(
            s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "19,24,19,24") ; x
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-topdown-l", "18,2,19,26")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-topdown-l", "18,2,19,26")
      ; fail

  env-topdown-l(s, skip : ( term -> term ) * term -> term) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-topdown-l", "21,2,22,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,4,22,39")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,10,22,38")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,10,22,10") ; s)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,14,22,37")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,14,22,20")
           ; skip(
               s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,19,22,19") ; x
             )
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,25,22,37")
              ; all-l-dist(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "22,36,22,36") ; x
                ))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-topdown-l", "21,2,22,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-topdown-l", "21,2,22,39")
      ; fail

  env-bottomup-l(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-bottomup-l", "24,2,25,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,4,25,38")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,10,25,37")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,10,25,34")
           ; split(
               s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,16,25,28")
               ; all-l-dist(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,27,25,27") ; x
                 )
             , s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,31,25,33") ; Snd
             ))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "25,37,25,37")
        ; s
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-bottomup-l", "24,2,25,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/strategy/traversal/list-environment.str", "env-bottomup-l", "24,2,25,38")
      ; fail