module collection/list/lookup

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/common


strategies
  lookup =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup", "37,2,37,35")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "37,11,37,35")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "37,17,37,34")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "37,17,37,21") ; Look1
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "37,26,37,34")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "37,26,37,30") ; Look2)
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "37,34,37,34")
              ; x)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup", "37,2,37,35")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup", "37,2,37,35")
      ; fail

  getfirst(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "getfirst", "46,2,46,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,16,46,36")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,22,46,35")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,22,46,26")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,22,46,23") ; Hd)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,26,46,26")
           ; s
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,31,46,35")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,31,46,32") ; Tl)
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "46,35,46,35")
              ; x)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "getfirst", "46,2,46,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "getfirst", "46,2,46,36")
      ; fail

  lookup' =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup'", "57,2,57,62")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,12,57,62")
    ; {x, xs:
        s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,20,57,61")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,20,57,27")
           ; ?(x, xs))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,31,57,61")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,32,57,57")
            ; getfirst(
                s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,41,57,56")
                ; {y:
                    s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,45,57,55")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,45,57,51")
                       ; ?(x, y))
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "57,54,57,55")
                    ; !y
                  }
              ))> xs
      }
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup'", "57,2,57,62")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup'", "57,2,57,62")
      ; fail

  lookup(keyeq) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup", "65,2,65,51")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,18,65,51")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,25,65,49")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,25,65,37")
           ; Look1'(
               s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,32,65,36") ; keyeq
             )
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,42,65,49")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,42,65,46") ; Look2)
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "65,49,65,49")
              ; x)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup", "65,2,65,51")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "lookup", "65,2,65,51")
      ; fail


rules

  Look1 :
    (x, [(x, y)|_]) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1", "70,2,70,29")> y
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1", "70,2,70,29")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1", "70,2,70,29")
             ; fail

  Look2 :
    (x, [_|xs]) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look2", "73,2,73,31")> (x, xs)
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look2", "73,2,73,31")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look2", "73,2,73,31")
             ; fail

  Look1'(keyeq) :
    (x, [y|_]) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1'", "76,2,76,53")> y
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1'", "76,2,76,53")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1'", "76,2,76,53")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "76,40,76,53")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "76,41,76,45") ; keyeq)> (x, y)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/collection/list/lookup.str", "Look1'", "76,2,76,53")
             ; fail