module lang/dynamic-rules

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/hash-table/common
  strategy/traversal/simple
  collection/set/indexed
  system/io/file


signature
  constructors
    RuleScope   : IndexedSet * Hashtable -> RuleScope
    ChangeSet   : IndexedSet * IndexedSet * Hashtable -> RuleScope
    Label       : String -> Label
    SplitPos    : String * String -> SplitPos
    BreakCS     : String * String -> BreakCS
    ContinueCS  : String * String -> ContinueCS
    IgnoreB     : String -> IgnoreB
    IgnoreC     : String -> IgnoreC
    Catch       : String * String -> Catch
    Finally     : String -> Finally
    TryBlock    : Int * String * [ Catch ] * Finally -> TryBlock
    Structure   : String -> Structure
    IgnoreT     : String -> IgnoreT
    ThrowCS     : String * String -> ThrowCS
    ExceptionCS : String * String -> ExceptionCS


strategies
  dr-rule-sets-hashtable =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rule-sets-hashtable", "52,2,53,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "53,4,53,38")
    ; prim("SSL_dynamic_rules_hashtable")
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rule-sets-hashtable", "52,2,53,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rule-sets-hashtable", "52,2,53,38")
      ; fail

  dr-get-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-rule-set", "58,2,61,30")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "59,4,61,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "59,4,59,60")
       ; prim(
           "SSL_hashtable_get"
         , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "59,31,59,52") ; dr-rule-sets-hashtable>
         , name
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "60,7,61,30")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "60,7,60,21") ; dr-new-rule-set)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "61,9,61,30")
          ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-rule-set", "58,2,61,30")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-rule-set", "58,2,61,30")
      ; fail

  dr-set-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule-set", "63,2,67,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "64,4,67,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "65,6,66,73")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "65,6,65,13") ; ?ruleset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "66,8,66,73")
            ; prim(
                "SSL_hashtable_put"
              , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "66,35,66,56") ; dr-rule-sets-hashtable>
              , name
              , ruleset
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule-set", "63,2,67,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule-set", "63,2,67,4")
      ; fail

  dr-switch-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-switch-rule-set", "69,2,72,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "70,4,72,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "70,4,70,38")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "70,10,70,37")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "70,10,70,31")
                  ; dr-get-rule-set(|name)) => rs))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "71,6,72,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "71,6,71,27")
       ; dr-set-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "72,6,72,8")
    ; !rs
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-switch-rule-set", "69,2,72,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-switch-rule-set", "69,2,72,8")
      ; fail


strategies
  dr-scope(s|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope", "101,2,104,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "102,4,104,36")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "102,4,102,24")
       ; dr-begin-scope(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "103,7,104,35")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "103,7,103,7") ; s
       < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "103,11,103,29")
         ; dr-end-scope(|name)
       + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "104,11,104,35")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "104,11,104,29")
            ; dr-end-scope(|name))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "104,32,104,35")
         ; fail)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope", "101,2,104,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope", "101,2,104,36")
      ; fail

  dr-begin-scope(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-begin-scope", "109,2,114,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "110,4,114,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "111,6,113,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "111,6,111,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "112,8,113,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "112,8,112,19") ; dr-add-scope)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "113,8,113,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-begin-scope", "109,2,114,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-begin-scope", "109,2,114,4")
      ; fail

  dr-end-scope(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-end-scope", "119,2,124,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "120,4,124,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "121,6,123,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "121,6,121,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "122,8,123,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "122,8,122,21") ; dr-leave-scope)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "123,8,123,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-end-scope", "119,2,124,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-end-scope", "119,2,124,4")
      ; fail

  dr-scope-all(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all", "132,2,138,5")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "133,4,138,5")
    ; {|DrScopedRules, DrScopedConfig:
         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "134,6,137,6")
         ; finally(
             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "135,8,135,28")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "135,8,135,25") ; dr-scope-all-start)
             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "135,28,135,28")
             ; s
           , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "136,8,136,23") ; dr-scope-all-end
           )
      |}
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all", "132,2,138,5")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all", "132,2,138,5")
      ; fail

  dr-scope-all-start =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all-start", "148,2,161,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "149,4,161,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "150,6,160,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "150,6,150,40")
               ; config := <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "150,17,150,39")
                            ; lookup-table(|"config")>)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "151,6,160,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "151,6,151,20") ; table-hashtable)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "152,6,160,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "152,6,152,54")
               ; hashtable-put(
                 | "config"
                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "152,32,152,45") ; hashtable-copy> config
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "153,6,160,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "153,6,153,50")
               ; table := Hashtable(
                            <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "153,27,153,48") ; dr-rule-sets-hashtable>
                          ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "154,6,160,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "154,6,154,57")
               ; names := ["DrScopedRules"|<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "154,36,154,49") ; hashtable-keys> table])
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "156,6,160,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "156,6,156,28")
               ; dr-begin-scopes(|names))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "157,6,160,6")
            ; rules ( DrScopedRules := names DrScopedConfig := config ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all-start", "148,2,161,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all-start", "148,2,161,4")
      ; fail

  dr-scope-all-end =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all-end", "168,2,183,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "169,4,183,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "170,6,182,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "170,6,170,49")
               ; table := Hashtable(
                            <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "170,26,170,47") ; dr-rule-sets-hashtable>
                          ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "171,6,182,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "171,6,171,29")
               ; names := <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "171,16,171,28") ; DrScopedRules>)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "172,6,182,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "172,6,172,20") ; table-hashtable)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "173,6,182,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "173,6,173,47")
               ; hashtable-put(
                 | "config"
                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "173,32,173,45") ; DrScopedConfig>
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "174,6,182,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "174,6,174,26")
               ; dr-end-scopes(|names))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "177,6,182,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "177,6,177,43")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "177,7,177,10") ; diff)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "177,15,177,28") ; hashtable-keys> table
                                                                                                                     , names
                                                                                                                     ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "178,6,182,6")
            ; list-loop(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "179,8,181,8")
                ; {key:
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "179,15,180,39")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "179,15,179,18") ; ?key)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "180,10,180,39")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "180,11,180,32")
                        ; hashtable-remove(|key))> table
                  }
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all-end", "168,2,183,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scope-all-end", "168,2,183,4")
      ; fail

  dr-scopes(s|names) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scopes", "185,2,188,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "186,4,188,38")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "186,4,186,26")
       ; dr-begin-scopes(|names))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "187,7,188,37")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "187,7,187,7") ; s
       < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "187,11,187,31")
         ; dr-end-scopes(|names)
       + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "188,11,188,37")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "188,11,188,31")
            ; dr-end-scopes(|names))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "188,34,188,37")
         ; fail)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scopes", "185,2,188,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-scopes", "185,2,188,38")
      ; fail

  dr-begin-scopes(|names) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-begin-scopes", "193,2,200,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "194,4,200,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "195,6,199,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "195,6,195,11") ; !names)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "196,8,199,38")
            ; map(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "196,12,199,37")
                ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "196,13,199,36")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "196,13,196,17") ; ?name)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "197,15,199,36")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "197,15,197,36")
                      ; dr-get-rule-set(|name))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "198,15,199,36")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "198,15,198,26") ; dr-add-scope)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "199,15,199,36")
                   ; dr-set-rule-set(|name)}
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-begin-scopes", "193,2,200,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-begin-scopes", "193,2,200,4")
      ; fail

  dr-end-scopes(|names) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-end-scopes", "205,2,212,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "206,4,212,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "207,6,211,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "207,6,207,11") ; !names)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "208,8,211,38")
            ; map(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "208,12,211,37")
                ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "208,13,211,36")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "208,13,208,17") ; ?name)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "209,15,211,36")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "209,15,209,36")
                      ; dr-get-rule-set(|name))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "210,15,211,36")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "210,15,210,28") ; dr-leave-scope)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "211,15,211,36")
                   ; dr-set-rule-set(|name)}
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-end-scopes", "205,2,212,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-end-scopes", "205,2,212,4")
      ; fail

  dr-start-change-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-start-change-set", "217,2,222,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "218,4,222,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "219,6,221,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "219,6,219,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "220,8,221,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "220,8,220,26") ; dr-start-change-set)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "221,8,221,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-start-change-set", "217,2,222,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-start-change-set", "217,2,222,4")
      ; fail

  dr-commit-change-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "227,2,232,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "228,4,232,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "229,6,231,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "229,6,229,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "230,8,231,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "230,8,230,27") ; dr-commit-change-set)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "231,8,231,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "227,2,232,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "227,2,232,4")
      ; fail

  dr-discard-change-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "237,2,242,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "238,4,242,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "239,6,241,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "239,6,239,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "240,8,241,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "240,8,240,28") ; dr-discard-change-set)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "241,8,241,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "237,2,242,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "237,2,242,4")
      ; fail

  dr-label-scope(|name, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-scope", "247,2,252,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "248,4,252,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "249,6,251,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "249,6,249,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "250,8,251,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "250,8,250,29")
               ; dr-label-scope(|label))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "251,8,251,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-scope", "247,2,252,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-scope", "247,2,252,4")
      ; fail

  dr-get-scope-labels(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-scope-labels", "258,2,260,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "259,4,260,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "259,4,259,25")
       ; dr-get-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "260,6,260,24")
    ; dr-get-scope-labels
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-scope-labels", "258,2,260,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-scope-labels", "258,2,260,24")
      ; fail

  dr-get-first-scope-label(s|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-first-scope-label", "267,2,269,32")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "268,4,269,32")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "268,4,268,25")
       ; dr-get-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "269,6,269,32")
    ; dr-get-first-scope-label(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "269,31,269,31") ; s
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-first-scope-label", "267,2,269,32")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-first-scope-label", "267,2,269,32")
      ; fail


strategies
  dr-ignore-state(s|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-ignore-state", "280,2,289,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "281,4,289,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "281,4,284,4")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "282,6,283,43")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "282,6,282,31")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "282,6,282,20") ; dr-new-rule-set) => newrule)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "283,8,283,43")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "283,8,283,32")
                  ; dr-switch-rule-set(|name)) => oldrule))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "285,4,289,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "285,4,285,4") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "286,4,289,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "287,6,288,39")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "287,6,287,29")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "287,7,287,20") ; dr-leave-scope)> newrule)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "288,8,288,39")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "288,9,288,30")
                ; dr-set-rule-set(|name))> oldrule)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-ignore-state", "280,2,289,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-ignore-state", "280,2,289,4")
      ; fail

  dr-ignore-states(s|names) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-ignore-states", "298,2,307,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "299,4,307,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "299,4,302,4")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "300,6,301,50")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "300,6,300,45")
                  ; newrules := <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "300,19,300,38")
                                 ; map(
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "300,23,300,37") ; dr-new-rule-set
                                   )> names)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "301,8,301,50")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "301,8,301,38")
                  ; zip(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "301,12,301,29") ; dr-switch-rule-set
                    | names
                    )) => oldrules))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "303,6,307,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "303,6,303,6") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "304,6,307,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "305,8,306,46")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "305,8,305,43")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "305,9,305,33")
                   ; list-loop(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "305,19,305,32") ; dr-leave-scope
                     ))> newrules)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "306,8,306,46")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "306,9,306,36")
                ; zip(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "306,13,306,27") ; dr-set-rule-set
                  | names
                  ))> oldrules)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-ignore-states", "298,2,307,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-ignore-states", "298,2,307,6")
      ; fail


strategies
  dr-lookup-rule(|name, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "311,2,313,25")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "312,4,313,25")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "312,4,312,25")
       ; dr-get-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "313,6,313,25")
    ; dr-lookup-rule(|key)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "311,2,313,25")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "311,2,313,25")
      ; fail

  dr-lookup-all-rules(|name, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "315,2,317,30")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "316,4,317,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "316,4,316,25")
       ; dr-get-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "317,6,317,30")
    ; dr-lookup-all-rules(|key)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "315,2,317,30")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "315,2,317,30")
      ; fail

  dr-lookup-rule-pointer(|name, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "319,2,321,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "320,4,321,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "320,4,320,25")
       ; dr-get-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "321,6,321,33")
    ; dr-lookup-rule-pointer(|key)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "319,2,321,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "319,2,321,33")
      ; fail

  dr-all-keys(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "323,2,325,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "324,4,325,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "324,4,324,25")
       ; dr-get-rule-set(|name))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "325,6,325,33")
    ; dr-all-keys(
      | []
      , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "325,24,325,31") ; new-iset>
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "323,2,325,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "323,2,325,33")
      ; fail

  dr-set-rule(|name, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule", "327,2,332,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "328,4,332,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "329,6,331,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "329,6,329,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "330,8,331,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "330,8,330,40")
               ; dr-set-in-rule-set(|key, [value]))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "331,8,331,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule", "327,2,332,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule", "327,2,332,4")
      ; fail

  dr-set-rule(|name, label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule", "334,2,339,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "335,4,339,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "336,6,338,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "336,6,336,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "337,8,338,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "337,8,337,47")
               ; dr-set-in-rule-set(|label, key, [value]))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "338,8,338,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule", "334,2,339,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule", "334,2,339,4")
      ; fail

  dr-set-rule-vis(|name, label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule-vis", "341,2,346,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "342,4,346,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "343,6,345,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "343,6,343,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "344,8,345,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "344,8,344,51")
               ; dr-set-in-rule-set-vis(|label, key, [value]))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "345,8,345,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule-vis", "341,2,346,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rule-vis", "341,2,346,4")
      ; fail

  dr-set-rules-vis(|name, label, key, values) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rules-vis", "348,2,353,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "349,4,353,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "350,6,352,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "350,6,350,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "351,8,352,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "351,8,351,50")
               ; dr-set-in-rule-set-vis(|label, key, values))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "352,8,352,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rules-vis", "348,2,353,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-rules-vis", "348,2,353,4")
      ; fail

  dr-undefine-rule(|name, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule", "355,2,360,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "356,4,360,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "357,6,359,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "357,6,357,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "358,8,359,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "358,8,358,35")
               ; dr-set-in-rule-set(|key, []))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "359,8,359,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule", "355,2,360,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule", "355,2,360,4")
      ; fail

  dr-undefine-rule(|name, label, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule", "362,2,367,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "363,4,367,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "364,6,366,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "364,6,364,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "365,8,366,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "365,8,365,42")
               ; dr-set-in-rule-set(|label, key, []))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "366,8,366,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule", "362,2,367,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule", "362,2,367,4")
      ; fail

  dr-undefine-rule-vis(|name, label, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule-vis", "369,2,374,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "370,4,374,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "371,6,373,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "371,6,371,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "372,8,373,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "372,8,372,46")
               ; dr-set-in-rule-set-vis(|label, key, []))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "373,8,373,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule-vis", "369,2,374,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-undefine-rule-vis", "369,2,374,4")
      ; fail

  dr-add-rule(|name, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule", "376,2,381,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "377,4,381,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "378,6,380,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "378,6,378,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "379,8,380,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "379,8,379,38")
               ; dr-add-to-rule-set(|key, value))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "380,8,380,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule", "376,2,381,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule", "376,2,381,4")
      ; fail

  dr-add-rule(|name, label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule", "383,2,388,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "384,4,388,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "385,6,387,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "385,6,385,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "386,8,387,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "386,8,386,45")
               ; dr-add-to-rule-set(|label, key, value))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "387,8,387,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule", "383,2,388,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule", "383,2,388,4")
      ; fail

  dr-add-rule-vis(|name, label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule-vis", "390,2,395,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "391,4,395,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "392,6,394,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "392,6,392,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "393,8,394,29")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "393,8,393,49")
               ; dr-add-to-rule-set-vis(|label, key, value))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "394,8,394,29")
            ; dr-set-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule-vis", "390,2,395,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-rule-vis", "390,2,395,4")
      ; fail

  dr-intersect-with(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-with", "401,2,403,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "402,4,403,27")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "402,4,402,59")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "402,5,402,26") ; dr-intersect-rule-sets)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "402,30,402,51")
                                                                                                                                  ; dr-get-rule-set(|name)>
                                                                                                                               , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "402,56,402,57") ; id>
                                                                                                                               ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "403,6,403,27")
    ; dr-set-rule-set(|name)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-with", "401,2,403,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-with", "401,2,403,27")
      ; fail

  dr-intersect-symm(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-symm", "409,2,411,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "410,4,411,27")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "410,4,410,64")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "410,5,410,31") ; dr-intersect-rule-sets-symm)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "410,35,410,56")
                                                                                                                                       ; dr-get-rule-set(|name)>
                                                                                                                                    , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "410,61,410,62") ; id>
                                                                                                                                    ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "411,6,411,27")
    ; dr-set-rule-set(|name)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-symm", "409,2,411,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-symm", "409,2,411,27")
      ; fail

  dr-union-with(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-with", "417,2,419,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "418,4,419,27")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "418,4,418,55")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "418,5,418,22") ; dr-union-rule-sets)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "418,26,418,47")
                                                                                                                              ; dr-get-rule-set(|name)>
                                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "418,52,418,53") ; id>
                                                                                                                           ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "419,6,419,27")
    ; dr-set-rule-set(|name)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-with", "417,2,419,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-with", "417,2,419,27")
      ; fail

  dr-union-symm(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-symm", "425,2,428,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "427,4,428,27")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "427,4,427,60")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "427,5,427,27") ; dr-union-rule-sets-symm)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "427,31,427,52")
                                                                                                                                   ; dr-get-rule-set(|name)>
                                                                                                                                , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "427,57,427,58") ; id>
                                                                                                                                ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "428,6,428,27")
    ; dr-set-rule-set(|name)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-symm", "425,2,428,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-symm", "425,2,428,27")
      ; fail

  dr-left-choice(s1, s2|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-left-choice", "435,2,440,9")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,4,440,9")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,4,437,7")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,4,436,53")
          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,10,436,52")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,11,436,41")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,15,436,40")
                          ; dr-start-change-set(
                            | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "436,37,436,38") ; id>
                            )
                        ))> rulenames))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "437,6,437,7")
       ; s1
       < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "438,6,438,56")
         ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "438,12,438,55")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "438,13,438,44")
                     ; map(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "438,17,438,43")
                         ; dr-commit-change-set(
                           | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "438,40,438,41") ; id>
                           )
                       ))> rulenames)
       + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "439,6,440,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "439,6,439,57")
            ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "439,12,439,56")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "439,13,439,45")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "439,17,439,44")
                            ; dr-discard-change-set(
                              | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "439,41,439,42") ; id>
                              )
                          ))> rulenames))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "440,8,440,9")
         ; s2)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-left-choice", "435,2,440,9")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-left-choice", "435,2,440,9")
      ; fail


strategies
  dr-save-rule-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-save-rule-set", "448,2,449,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "449,4,449,27")
    ; alltd(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "449,10,449,26") ; hashtable-getlist
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-save-rule-set", "448,2,449,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-save-rule-set", "448,2,449,27")
      ; fail


strategies
  dr-new-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-scope", "455,2,456,57")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "456,4,456,57")
    ; !RuleScope(
         <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "456,16,456,38")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "456,16,456,23") ; new-iset)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "456,26,456,38")
          ; iset-add(|())>
       , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "456,43,456,55") ; new-hashtable>
       )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-scope", "455,2,456,57")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-scope", "455,2,456,57")
      ; fail

  dr-new-rule-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-rule-set", "458,2,459,20")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "459,4,459,20")
    ; ![ <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "459,7,459,18") ; dr-new-scope>
       ]
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-rule-set", "458,2,459,20")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-rule-set", "458,2,459,20")
      ; fail

  dr-add-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-scope", "461,2,462,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "462,4,462,27")
    ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "462,7,462,18") ; dr-new-scope>|<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "462,24,462,25") ; id>]
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-scope", "461,2,462,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-scope", "461,2,462,27")
      ; fail

  dr-destroy-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-scope", "464,2,465,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "465,4,465,45")
    ; RuleScope(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "465,14,465,25") ; iset-destroy
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "465,28,465,44") ; hashtable-destroy
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-scope", "464,2,465,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-scope", "464,2,465,45")
      ; fail

  dr-leave-scope :
    [scope|scopes] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-leave-scope", "467,2,469,33")> scopes
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-leave-scope", "467,2,469,33")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-leave-scope", "467,2,469,33")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "469,10,469,33")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "469,11,469,26") ; dr-destroy-scope)> scope
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-leave-scope", "467,2,469,33")
             ; fail

  dr-get-inner-scope :
    [scope|scopes] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-inner-scope", "471,2,472,28")> scope
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-inner-scope", "471,2,472,28")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-inner-scope", "471,2,472,28")
             ; fail

  dr-label-scope(|label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-scope", "474,2,477,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "475,4,477,8")
    ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "475,6,476,42")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "475,6,475,36")
          ; RuleScope(
              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "475,16,475,31")
              ; iset-add(|label)
            , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "475,34,475,35") ; id
            )
          + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "476,8,476,42")
            ; ChangeSet(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "476,18,476,33")
                ; iset-add(|label)
              , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "476,36,476,37") ; id
              , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "476,40,476,41") ; id
              ))|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "477,6,477,7") ; id]
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-scope", "474,2,477,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-scope", "474,2,477,8")
      ; fail

  dr-get-scope-labels =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-scope-labels", "481,3,482,78")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "482,5,482,78")
    ; mapconcat(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "482,15,482,77")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "482,15,482,43")
           ; ?RuleScope(
                <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "482,27,482,39") ; iset-elements>
              , _
              )
           + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "482,47,482,77")
             ; ?ChangeSet(
                  <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "482,59,482,71") ; iset-elements>
                , _
                , _
                ))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-scope-labels", "481,3,482,78")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-scope-labels", "481,3,482,78")
      ; fail

  dr-get-first-scope-label(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-first-scope-label", "488,3,490,64")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,5,490,64")
    ; fetch-elem(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,16,490,63")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,16,489,59")
           ; ?RuleScope(
                <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,28,489,55")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,28,489,40") ; iset-elements)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,43,489,55")
                 ; fetch-elem(
                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "489,54,489,54") ; s
                   )>
              , _
              )
           + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "490,18,490,63")
             ; ?ChangeSet(
                  <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "490,30,490,57")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "490,30,490,42") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "490,45,490,57")
                   ; fetch-elem(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "490,56,490,56") ; s
                     )>
                , _
                , _
                ))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-first-scope-label", "488,3,490,64")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-get-first-scope-label", "488,3,490,64")
      ; fail


strategies
  dr-new-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-change-set", "494,2,495,54")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "495,4,495,54")
    ; !ChangeSet(
         <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "495,16,495,23") ; new-iset>
       , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "495,28,495,35") ; new-iset>
       , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "495,40,495,52") ; new-hashtable>
       )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-change-set", "494,2,495,54")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-new-change-set", "494,2,495,54")
      ; fail

  dr-start-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-start-change-set", "497,2,498,32")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "498,4,498,32")
    ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "498,7,498,23") ; dr-new-change-set>|<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "498,29,498,30") ; id>]
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-start-change-set", "497,2,498,32")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-start-change-set", "497,2,498,32")
      ; fail

  dr-destroy-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-change-set", "500,2,501,63")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "501,4,501,63")
    ; ChangeSet(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "501,14,501,25") ; iset-destroy
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "501,28,501,39") ; iset-destroy
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "501,42,501,62") ; dr-destroy-and-unmark
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-change-set", "500,2,501,63")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-change-set", "500,2,501,63")
      ; fail

  dr-destroy-and-unmark =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-and-unmark", "503,2,517,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "504,4,517,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "504,4,504,19")
       ; ?Hashtable(csid))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "505,6,517,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "505,6,505,22") ; hashtable-destroy)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "506,6,517,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "506,6,509,6")
       ; try(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "507,8,508,48")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "507,8,507,40")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "507,8,507,30")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "507,9,507,16") ; DR_BREAK)> IgnoreB(csid)) => labelb)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "508,10,508,48")
           ; rules ( DR_BREAK.labelb :-
                       IgnoreB(csid) )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "510,6,517,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "510,6,513,6")
       ; try(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "511,8,512,48")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "511,8,511,40")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "511,8,511,30")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "511,9,511,16") ; DR_BREAK)> IgnoreC(csid)) => labelc)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "512,10,512,48")
           ; rules ( DR_BREAK.labelc :-
                       IgnoreC(csid) )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "514,6,517,6")
    ; try(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "515,8,516,45")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "515,8,515,34")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "515,9,515,20") ; DR_EXCEPTION)> IgnoreT(csid))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "516,10,516,45")
        ; rules ( DR_EXCEPTION :-
                    IgnoreT(csid) )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-and-unmark", "503,2,517,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-destroy-and-unmark", "503,2,517,6")
      ; fail

  dr-clone-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-clone-change-set", "519,2,526,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "520,4,526,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "520,4,520,36")
       ; ?ChangeSet(labels1, rmset1, tbl1))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "521,6,526,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "521,6,521,61")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "521,6,521,22") ; dr-new-change-set) => cs@ChangeSet(labels2, rmset2, tbl2))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "522,6,526,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "522,6,522,51")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "522,7,522,43")
           ; iset-addlist(
             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "522,22,522,34") ; iset-elements> labels1
             ))> labels2)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "523,6,526,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "523,6,523,49")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "523,7,523,42")
           ; iset-addlist(
             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "523,22,523,34") ; iset-elements> rmset1
             ))> rmset2)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "524,6,526,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "524,6,524,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "524,7,524,20") ; hashtable-keys)> tbl1)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,6,526,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,6,525,76")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,10,525,75")
           ; {key:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,17,525,74")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,17,525,20") ; ?key)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,23,525,74")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,24,525,69")
                   ; hashtable-put(
                     | key
                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "525,45,525,63")
                        ; hashtable-get(|key)> tbl1
                     ))> tbl2
             }
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "526,6,526,8")
    ; !cs
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-clone-change-set", "519,2,526,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-clone-change-set", "519,2,526,8")
      ; fail

  dr-commit-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "528,2,529,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "529,4,529,27")
    ; dr-commit-change-set(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "529,25,529,26") ; id
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "528,2,529,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "528,2,529,27")
      ; fail

  dr-commit-change-set(destroy) :
    [cs@ChangeSet(
          labelset
        , rmset
        , tbl@Hashtable(csid)
        )|rs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "535,2,563,49")> rs''
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "535,2,563,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "535,2,563,49")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "537,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "537,10,537,29")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "537,11,537,24") ; hashtable-keys)> tbl)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "538,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "538,10,539,45")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "538,10,539,38")
                ; foldr(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "538,16,538,47")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "538,17,538,43")
                        ; dr-commit-labels(|labelset))> rs
                  , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "539,17,539,37")
                    ; dr-apply-change(|tbl)
                  )) => rs')
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "540,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "540,10,540,30")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "540,11,540,23") ; iset-elements)> rmset)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "541,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "541,10,541,46")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "541,10,541,38")
                ; foldr(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "541,16,541,19") ; !rs'
                  , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "541,22,541,37") ; dr-apply-removal
                  )) => rs'')
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "542,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "542,10,548,10")
             ; try(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "543,12,547,106")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "543,12,543,18") ; destroy)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "544,14,547,106")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "544,14,544,46")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "544,14,544,36")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "544,15,544,22") ; DR_BREAK)> IgnoreB(csid)) => labelb)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,15,547,105")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,15,546,53")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,15,545,67")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,16,545,62")
                           ; fetch(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,22,545,61")
                               ; ChangeSet(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,32,545,33") ; id
                                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,36,545,37") ; id
                                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "545,40,545,60")
                                   ; ?Hashtable(csidnextb)
                                 )
                             ))> rs'')
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "546,17,546,53")
                    ; dr-define-ignoreB(|csidnextb, labelb)
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "547,18,547,105")
                       ; fatal-err(|"dr-break was called outside of a fix and merge operator or a dr-label call"))
               ))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "549,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "549,10,555,10")
             ; try(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "550,12,554,95")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "550,12,550,18") ; destroy)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "551,14,554,95")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "551,14,551,46")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "551,14,551,36")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "551,15,551,22") ; DR_BREAK)> IgnoreC(csid)) => labelc)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,15,554,94")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,15,553,53")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,15,552,67")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,16,552,62")
                           ; fetch(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,22,552,61")
                               ; ChangeSet(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,32,552,33") ; id
                                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,36,552,37") ; id
                                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "552,40,552,60")
                                   ; ?Hashtable(csidnextc)
                                 )
                             ))> rs'')
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "553,17,553,53")
                    ; dr-define-ignoreC(|csidnextc, labelc)
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "554,18,554,94")
                       ; fatal-err(|"dr-continue was called outside of a fix and merge operator call"))
               ))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "556,10,563,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "556,10,562,10")
             ; try(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "557,12,561,96")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "557,12,557,18") ; destroy)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "558,14,561,96")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "558,14,558,40")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "558,15,558,26") ; DR_EXCEPTION)> IgnoreT(csid))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,15,561,95")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,15,560,45")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,15,559,67")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,16,559,62")
                           ; fetch(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,22,559,61")
                               ; ChangeSet(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,32,559,33") ; id
                                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,36,559,37") ; id
                                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "559,40,559,60")
                                   ; ?Hashtable(csidnextt)
                                 )
                             ))> rs'')
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "560,17,560,45")
                    ; dr-define-ignoreT(|csidnextt)
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "561,18,561,95")
                       ; fatal-err(|"dr-throw was not called in the proper exception handling context"))
               ))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "563,10,563,49")
          ; try(
              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "563,14,563,48")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "563,14,563,20") ; destroy)
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "563,23,563,48")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "563,24,563,44") ; dr-destroy-change-set)> cs
            )
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-change-set", "535,2,563,49")
             ; fail

  dr-discard-change-set :
    [cs@ChangeSet(_, _, _)|rs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "565,2,567,35")> rs
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "565,2,567,35")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "565,2,567,35")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "567,10,567,35")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "567,11,567,31") ; dr-destroy-change-set)> cs
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-discard-change-set", "565,2,567,35")
             ; fail

  dr-commit-labels(|labelset) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-labels", "569,2,572,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "570,4,572,8")
    ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "570,6,571,43")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "570,6,570,45")
          ; ChangeSet(
              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "570,16,570,36")
              ; iset-union(|labelset)
            , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "570,39,570,40") ; id
            , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "570,43,570,44") ; id
            )
          + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "571,8,571,43")
            ; RuleScope(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "571,18,571,38")
                ; iset-union(|labelset)
              , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "571,41,571,42") ; id
              ))|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "572,6,572,7") ; id]
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-labels", "569,2,572,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-labels", "569,2,572,8")
      ; fail

  dr-apply-change(|tbl):
    (key1@(scpid, key), rs) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-apply-change", "580,2,581,97")> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "581,32,581,93")
                                                                                                                                              ; dr-commit-to-rule-set(
                                                                                                                                                | scpid
                                                                                                                                                , key
                                                                                                                                                , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "581,68,581,87")
                                                                                                                                                   ; hashtable-get(|key1)> tbl
                                                                                                                                                )> rs
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-apply-change", "580,2,581,97")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-apply-change", "580,2,581,97")
             ; fail

  dr-commit-to-rule-set(|scpid, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-rule-set", "584,2,586,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "585,4,586,49")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "585,4,585,46")
       ; dr-commit-to-change-set(|scpid, key, value)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "586,7,586,49")
          ; dr-commit-to-rule-scope(|scpid, key, value))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-rule-set", "584,2,586,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-rule-set", "584,2,586,49")
      ; fail

  dr-commit-to-change-set(|scpid, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-change-set", "588,2,595,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "589,4,595,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "589,4,589,35")
       ; ?[ChangeSet(_, rmset, tbl)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "590,6,595,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "591,8,594,42")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "591,9,593,50")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "591,9,591,57")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "591,9,591,48")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "591,10,591,45")
                         ; dr-lookup-rule-in-scope(|key, scpid))> rs) => value
                  < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "592,11,592,46")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "592,12,592,42")
                        ; hashtable-remove(|(scpid, key)))> tbl
                  + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "593,11,593,50")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "593,12,593,46")
                        ; hashtable-put(|(scpid, key), value))> tbl))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "594,10,594,42")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "594,11,594,36")
                ; iset-remove(|(scpid, key)))> rmset)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-change-set", "588,2,595,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-change-set", "588,2,595,6")
      ; fail

  dr-commit-to-rule-scope(|scpid, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-rule-scope", "597,2,600,70")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "598,4,600,70")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "598,4,599,43")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "598,4,598,45")
          ; ?[RuleScope(_, tbl@Hashtable(scpid))|rs])
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "599,6,599,43")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "599,12,599,42")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "599,13,599,38")
                   ; hashtable-put(|key, value))> tbl)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "600,7,600,70")
          ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "600,8,600,24")
             ; RuleScope(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "600,18,600,19") ; id
               , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "600,22,600,23") ; id
               )|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "600,28,600,68")
                 ; dr-commit-to-rule-set(|scpid, key, value)])
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-rule-scope", "597,2,600,70")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-commit-to-rule-scope", "597,2,600,70")
      ; fail

  dr-apply-removal :
    (key1@(scpid, key), rs) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-apply-removal", "620,2,621,71")> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "621,32,621,67")
                                                                                                                                               ; dr-remove-from-rule-set(|scpid, key)> rs
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-apply-removal", "620,2,621,71")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-apply-removal", "620,2,621,71")
             ; fail

  dr-remove-from-rule-set(|scpid, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-rule-set", "623,2,626,44")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "624,4,626,44")
    ; fetch(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "625,6,626,43")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "625,6,625,43")
           ; dr-remove-from-change-set(|scpid, key)
           + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "626,6,626,43")
             ; dr-remove-from-rule-scope(|scpid, key))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-rule-set", "623,2,626,44")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-rule-set", "623,2,626,44")
      ; fail

  dr-remove-from-change-set(|scpid, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-change-set", "628,2,630,47")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "629,4,630,47")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "629,4,629,47")
       ; ChangeSet(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "629,14,629,15") ; id
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "629,18,629,40")
           ; iset-add(|(scpid, key))
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "629,43,629,46") ; ?tbl
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "630,4,630,47")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "630,10,630,46")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "630,11,630,41")
                ; hashtable-remove(|(scpid, key)))> tbl)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-change-set", "628,2,630,47")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-change-set", "628,2,630,47")
      ; fail

  dr-remove-from-rule-scope(|scpid, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-rule-scope", "632,2,634,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "633,4,634,38")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "633,4,633,37")
       ; ?RuleScope(_, tbl@Hashtable(scpid)))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "634,4,634,38")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "634,10,634,37")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "634,11,634,32")
                ; hashtable-remove(|key))> tbl)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-rule-scope", "632,2,634,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-remove-from-rule-scope", "632,2,634,38")
      ; fail


strategies
  dr-lookup-rule(|key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "651,2,652,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "652,4,652,33")
    ; dr-lookup-rule(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "652,19,652,22") ; fail
      | key
      , []
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "651,2,652,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "651,2,652,33")
      ; fail

  dr-lookup-rule(look|key, removed) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "654,2,659,50")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "655,4,659,50")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "655,4,655,44")
       ; ?[RuleScope(_, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "656,7,659,49")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "656,7,656,23")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "656,8,656,11") ; look)> (hptr, key)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "657,10,659,49")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "657,10,658,36")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "657,10,657,43")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "657,11,657,34")
                    ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "657,15,657,33")
                          ; fetch(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "657,21,657,32")
                              ; ?(hptr, key)
                            )))> removed)
             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "658,12,658,36")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "658,13,658,31")
                 ; hashtable-get(|key))> tbl
             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "659,10,659,49")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "659,11,659,45")
                    ; dr-lookup-rule(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "659,26,659,29") ; look
                      | key
                      , removed
                      ))> rs))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "654,2,659,50")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "654,2,659,50")
      ; fail

  dr-lookup-rule(look1|key, removed) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "661,2,673,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "662,4,673,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "662,4,662,35")
       ; ?[ChangeSet(_, rmset, tbl)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "663,6,673,8")
    ; let look2 =
            s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "663,10,668,21")
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "663,18,668,21")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "663,18,663,22") ; look1
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "664,21,668,21")
                  ; {key':
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "665,22,667,49")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "665,22,665,26") ; ?key')
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "666,24,667,49")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "666,24,666,50")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "666,25,666,41")
                             ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "666,29,666,40")
                                   ; fetch(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "666,35,666,39") ; ?key'
                                     )))> removed)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "667,24,667,49")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "667,25,667,44")
                          ; hashtable-get(|key'))> tbl
                    })
            < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "663,10,668,21")
            + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "663,10,668,21")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "670,9,672,65")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "670,9,670,29")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "670,10,670,22") ; iset-elements)> rmset)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "671,11,672,65")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "671,11,671,35")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "671,11,671,27")
              ; filter(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "671,18,671,26")
                  ; ?(_, key)
                )) => keys)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "672,11,672,65")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "672,12,672,61")
            ; dr-lookup-rule(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "672,27,672,31") ; look2
              | key
              , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "672,41,672,44") ; conc> (keys, removed)
              ))> rs
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "661,2,673,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule", "661,2,673,8")
      ; fail

  dr-lookup-rule-in-scope(|key, scpid) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope", "683,2,685,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "684,4,685,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "684,4,684,42")
       ; dr-lookup-rule-in-scope-rs(|key, scpid)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "685,7,685,45")
          ; dr-lookup-rule-in-scope-cs(|key, scpid))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope", "683,2,685,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope", "683,2,685,45")
      ; fail

  dr-lookup-rule-in-scope-rs(|key, scpid) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope-rs", "687,2,691,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "688,4,691,49")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "688,4,688,45")
       ; ?[RuleScope(_, tbl@Hashtable(scpid))|rs]
       < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "689,6,689,29")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "689,7,689,25")
             ; hashtable-get(|key))> tbl
       + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "690,7,691,48")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "690,7,690,29")
            ; ?[RuleScope(_, _)|rs])
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "691,9,691,48")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "691,10,691,45")
             ; dr-lookup-rule-in-scope(|key, scpid))> rs)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope-rs", "687,2,691,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope-rs", "687,2,691,49")
      ; fail

  dr-lookup-rule-in-scope-cs(|key, scpid) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope-cs", "693,2,699,54")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "694,4,699,54")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "694,4,694,35")
       ; ?[ChangeSet(_, rmset, tbl)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "695,7,699,53")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "695,7,695,41")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "695,8,695,35")
           ; iset-contains(|(scpid, key)))> rmset
       < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "696,9,696,12") ; fail
       + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "698,10,699,52")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "698,10,698,42")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "698,11,698,38")
                ; hashtable-get(|(scpid, key)))> tbl
            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "699,13,699,52")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "699,14,699,49")
                   ; dr-lookup-rule-in-scope(|key, scpid))> rs))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope-cs", "693,2,699,54")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-in-scope-cs", "693,2,699,54")
      ; fail

  dr-lookup-rule-pointer(|key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "706,2,707,41")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "707,4,707,41")
    ; dr-lookup-rule-pointer(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "707,27,707,30") ; fail
      | key
      , []
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "706,2,707,41")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "706,2,707,41")
      ; fail

  dr-lookup-rule-pointer(look|key, removed) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "709,2,715,58")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "710,4,715,58")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "710,4,710,44")
       ; ?[RuleScope(_, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "711,7,715,57")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "711,7,711,23")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "711,8,711,11") ; look)> (hptr, key)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "712,10,715,57")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "712,10,714,28")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "712,10,712,43")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "712,11,712,34")
                    ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "712,15,712,33")
                          ; fetch(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "712,21,712,32")
                              ; ?(hptr, key)
                            )))> removed)
             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "713,12,714,28")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "713,12,713,36")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "713,13,713,31")
                    ; hashtable-get(|key))> tbl)
             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "714,12,714,28")
             ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "714,15,714,16") ; id>
                , key
                , tbl
                )
             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "715,10,715,57")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "715,11,715,53")
                    ; dr-lookup-rule-pointer(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "715,34,715,37") ; look
                      | key
                      , removed
                      ))> rs))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "709,2,715,58")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "709,2,715,58")
      ; fail

  dr-lookup-rule-pointer(look1|key, removed) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "717,2,729,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "718,4,729,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "718,4,718,35")
       ; ?[ChangeSet(_, rmset, tbl)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "719,6,729,8")
    ; let look2 =
            s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "719,10,724,21")
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "719,18,724,21")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "719,18,719,22") ; look1
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "720,21,724,21")
                  ; {key':
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "721,22,723,69")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "721,22,721,26") ; ?key')
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "722,24,723,69")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "722,24,722,50")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "722,25,722,41")
                             ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "722,29,722,40")
                                   ; fetch(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "722,35,722,39") ; ?key'
                                     )))> removed)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "723,24,723,69")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "723,25,723,64")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "723,25,723,44")
                             ; hashtable-get(|key'))
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "723,47,723,64")
                          ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "723,50,723,51") ; id>
                             , key'
                             , tbl
                             ))> tbl
                    })
            < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "719,10,724,21")
            + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "719,10,724,21")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "726,9,728,73")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "726,9,726,29")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "726,10,726,22") ; iset-elements)> rmset)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "727,11,728,73")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "727,11,727,35")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "727,11,727,27")
              ; filter(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "727,18,727,26")
                  ; ?(_, key)
                )) => keys)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "728,11,728,73")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "728,12,728,69")
            ; dr-lookup-rule-pointer(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "728,35,728,39") ; look2
              | key
              , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "728,49,728,52") ; conc> (keys, removed)
              ))> rs
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "717,2,729,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-rule-pointer", "717,2,729,8")
      ; fail

  dr-lookup-all-rules(|key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "735,2,736,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "736,4,736,38")
    ; dr-lookup-all-rules(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "736,24,736,27") ; fail
      | key
      , []
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "735,2,736,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "735,2,736,38")
      ; fail

  dr-lookup-all-rules(look|key, removed) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "738,2,744,65")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "739,4,744,65")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "739,4,739,44")
       ; ?[RuleScope(_, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "740,6,744,65")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "740,7,740,10") ; conc)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "740,14,743,19")
                                                                                                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "740,14,740,30")
                                                                                                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "740,15,740,18") ; look)> (hptr, key)
                                                                                                                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "741,17,743,19")
                                                                                                                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "741,17,742,43")
                                                                                                                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "741,17,741,50")
                                                                                                                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "741,18,741,41")
                                                                                                                             ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "741,22,741,40")
                                                                                                                                   ; fetch(
                                                                                                                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "741,28,741,39")
                                                                                                                                       ; ?(hptr, key)
                                                                                                                                     )))> removed)
                                                                                                                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "742,19,742,43")
                                                                                                                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "742,20,742,38")
                                                                                                                          ; hashtable-get(|key))> tbl
                                                                                                                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "743,17,743,19")
                                                                                                                         ; ![]))>
                                                                                                          , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "744,14,744,60")
                                                                                                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "744,14,744,53")
                                                                                                                ; dr-lookup-all-rules(
                                                                                                                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "744,34,744,37") ; look
                                                                                                                  | key
                                                                                                                  , removed
                                                                                                                  )
                                                                                                                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "744,58,744,60")
                                                                                                                   ; ![])> rs
                                                                                                          )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "738,2,744,65")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "738,2,744,65")
      ; fail

  dr-lookup-all-rules(look1|key, removed) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "746,2,758,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "747,4,758,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "747,4,747,35")
       ; ?[ChangeSet(_, rmset, tbl)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "748,6,758,8")
    ; let look2 =
            s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "748,10,753,21")
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "748,18,753,21")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "748,18,748,22") ; look1
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "749,21,753,21")
                  ; {key':
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "750,22,752,49")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "750,22,750,26") ; ?key')
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "751,24,752,49")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "751,24,751,50")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "751,25,751,41")
                             ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "751,29,751,40")
                                   ; fetch(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "751,35,751,39") ; ?key'
                                     )))> removed)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "752,24,752,49")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "752,25,752,44")
                          ; hashtable-get(|key'))> tbl
                    })
            < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "748,10,753,21")
            + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "look2", "748,10,753,21")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "755,9,757,70")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "755,9,755,29")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "755,10,755,22") ; iset-elements)> rmset)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "756,11,757,70")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "756,11,756,35")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "756,11,756,27")
              ; filter(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "756,18,756,26")
                  ; ?(_, key)
                )) => keys)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "757,11,757,70")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "757,12,757,66")
            ; dr-lookup-all-rules(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "757,32,757,36") ; look2
              | key
              , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "757,46,757,49") ; conc> (keys, removed)
              ))> rs
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "746,2,758,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-lookup-all-rules", "746,2,758,8")
      ; fail

  dr-all-keys(|removed, result) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "764,2,770,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "765,4,770,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "765,4,765,44")
       ; ?[RuleScope(_, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "766,6,770,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "766,6,766,60")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "766,6,766,38")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "766,7,766,30")
              ; partition(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "766,17,766,29")
                  ; ?( hptr
                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "766,26,766,27") ; id>
                     )
                ))> removed) => (localr, removed'))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "767,6,770,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "767,6,767,24")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "767,7,767,20") ; hashtable-keys)> tbl)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,6,770,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,6,768,69")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,6,768,61")
          ; filter(
              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,13,768,60")
              ; {key:
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,19,768,59")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,19,768,22") ; ?key)
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,25,768,59")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,25,768,53")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,26,768,46")
                         ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,30,768,45")
                               ; fetch-elem(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,41,768,44") ; ?key
                                 )))> localr)
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "768,56,768,59")
                  ; !key
                }
            )) => keys)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "769,6,770,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "769,6,769,32")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "769,7,769,25")
           ; iset-addlist(|keys))> result)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "770,6,770,39")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "770,7,770,36")
        ; dr-all-keys(|removed', result))> rs
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "764,2,770,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "764,2,770,39")
      ; fail

  dr-all-keys(|removed, result) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "772,2,779,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "773,4,779,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "773,4,773,35")
       ; ?[ChangeSet(_, rmset, tbl)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "774,6,779,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "774,6,774,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "774,7,774,19") ; iset-elements)> rmset)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "775,6,779,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "775,6,775,38")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "775,6,775,26")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "775,7,775,10") ; conc)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "775,14,775,15") ; id>
                                                                                                                , removed
                                                                                                                )) => removed')
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "776,6,779,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "776,6,776,24")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "776,7,776,20") ; hashtable-keys)> tbl)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,6,779,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,6,777,79")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,6,777,71")
          ; filter(
              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,13,777,70")
              ; {k, key:
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,22,777,69")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,22,777,32")
                     ; ?k@(_, key))
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,35,777,69")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,35,777,63")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,36,777,54")
                         ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,40,777,53")
                               ; fetch-elem(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,51,777,52") ; ?k
                                 )))> removed')
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "777,66,777,69")
                  ; !key
                }
            )) => keys)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "778,6,779,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "778,6,778,32")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "778,7,778,25")
           ; iset-addlist(|keys))> result)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "779,6,779,39")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "779,7,779,36")
        ; dr-all-keys(|removed', result))> rs
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "772,2,779,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "772,2,779,39")
      ; fail

  dr-all-keys(|removed, result) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "781,2,782,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "782,4,782,29")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "782,4,782,6")
       ; ?[])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "782,9,782,29")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "782,10,782,22") ; iset-elements)> result
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "781,2,782,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-all-keys", "781,2,782,29")
      ; fail


strategies
  dr-set-in-rule-set(|key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "796,2,797,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "797,4,797,38")
    ; dr-set-in-rule-set(|(), key, value)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "796,2,797,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "796,2,797,38")
      ; fail

  dr-set-in-rule-set(|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "803,2,804,54")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "804,4,804,54")
    ; dr-set-in-rule-set(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "804,23,804,33") ; dr-set-fail
      | label
      , key
      , value
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "803,2,804,54")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "803,2,804,54")
      ; fail

  dr-set-fail(|scpid, tbl, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-fail", "806,2,807,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "807,4,807,7")
    ; fail
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-fail", "806,2,807,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-fail", "806,2,807,7")
      ; fail

  dr-set-in-rule-set(set : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "809,2,817,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "811,4,817,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "811,4,811,51")
       ; ?[RuleScope(labelset, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "812,6,817,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "813,8,816,57")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "813,8,813,39")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "813,9,813,29")
                   ; iset-contains(|label))> labelset
               < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "814,11,815,52")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "814,11,814,37")
                    ; set(|hptr, tbl, key, value)
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "815,14,815,52")
                       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "815,20,815,51")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "815,21,815,46")
                                   ; hashtable-put(|key, value))> tbl))
               + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "816,10,816,57")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "816,11,816,53")
                     ; dr-set-in-rule-set(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "816,30,816,32") ; set
                       | label
                       , key
                       , value
                       ))> rs))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "809,2,817,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "809,2,817,6")
      ; fail

  dr-set-in-rule-set(set1 : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "819,2,836,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "821,4,836,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "821,4,821,43")
       ; ?[ChangeSet(labelset, rmset, tbl1)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "822,6,836,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "823,8,835,10")
            ; let set2(|scpid, tbl2, key, value) =
                    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "set2", "823,12,829,52")
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "824,14,829,52")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "824,14,824,43")
                       ; set1(|scpid, tbl2, key, value)
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "825,17,829,52")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "825,17,827,52")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "825,17,825,66")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "825,17,825,57")
                                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "825,18,825,53")
                                       ; dr-lookup-rule-in-scope(|key, scpid))> rs) => value)
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "826,19,827,52")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "826,19,826,56")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "826,20,826,50")
                                    ; hashtable-remove(|(scpid, key)))> tbl1)
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "827,19,827,52")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "827,20,827,45")
                                 ; iset-remove(|(scpid, key)))> rmset
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "828,17,829,52")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "828,17,828,58")
                                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "828,18,828,52")
                                       ; hashtable-put(|(scpid, key), value))> tbl1)
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "829,19,829,52")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "829,20,829,45")
                                    ; iset-remove(|(scpid, key)))> rmset))
                    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "set2", "823,12,829,52")
                    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "set2", "823,12,829,52")
                      ; fail
              in
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "830,12,834,14")
                ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "830,15,830,46")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "830,16,830,36")
                         ; iset-contains(|label))> labelset then
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "831,17,832,46")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "831,17,831,66")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "831,18,831,62")
                           ; fetch-elem(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "831,29,831,61")
                               ; ?RuleScope(_, tbl@Hashtable(hptr))
                             ))> rs)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "832,19,832,46")
                    ; set2(|hptr, tbl, key, value)
                  else
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "833,17,833,65")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "833,18,833,61")
                        ; dr-set-in-rule-set(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "833,37,833,40") ; set2
                          | label
                          , key
                          , value
                          ))> rs
                  end
              end)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "819,2,836,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set", "819,2,836,6")
      ; fail

  dr-set-in-rule-set-vis(|key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "854,2,855,34")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "855,4,855,34")
    ; dr-set-in-rule-set(|key, value)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "854,2,855,34")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "854,2,855,34")
      ; fail

  dr-set-in-rule-set-vis(|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "857,2,858,70")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "858,4,858,70")
    ; dr-set-in-rule-set-vis(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "858,27,858,37") ; dr-set-fail
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "858,40,858,49") ; dr-rm-fail
      | label
      , key
      , value
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "857,2,858,70")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "857,2,858,70")
      ; fail

  dr-rm-fail(|scpid, tbl, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rm-fail", "860,2,861,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "861,4,861,7")
    ; fail
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rm-fail", "860,2,861,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rm-fail", "860,2,861,7")
      ; fail

  dr-set-in-rule-set-vis(set : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm, rm : ATerm * Hashtable * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "863,2,876,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "867,4,876,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "867,4,867,51")
       ; ?[RuleScope(labelset, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "868,6,876,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "869,8,875,10")
            ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "869,11,869,42")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "869,12,869,32")
                     ; iset-contains(|label))> labelset then
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "870,10,871,44")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "870,10,870,36")
                   ; set(|hptr, tbl, key, value)
                   <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "871,13,871,44")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "871,14,871,39")
                          ; hashtable-put(|key, value))> tbl)
              else
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "873,10,874,67")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "873,11,873,61")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "873,11,873,29")
                      ; rm(|hptr, tbl, key)
                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "873,34,873,61")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "873,35,873,56")
                             ; hashtable-remove(|key))> tbl))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "874,12,874,67")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "874,13,874,63")
                    ; dr-set-in-rule-set-vis(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "874,36,874,38") ; set
                      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "874,41,874,42") ; rm
                      | label
                      , key
                      , value
                      ))> rs
              end)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "863,2,876,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "863,2,876,6")
      ; fail

  dr-set-in-rule-set-vis(set1 : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm, rm1 : ATerm * Hashtable * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "878,2,906,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "882,4,906,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "882,4,882,43")
       ; ?[ChangeSet(labelset, rmset, tbl1)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "883,6,906,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "884,8,905,10")
            ; let set2(|scpid, tbl2, key, value) =
                    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "set2", "884,12,890,52")
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "885,14,890,52")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "885,14,885,43")
                       ; set1(|scpid, tbl2, key, value)
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "886,17,890,52")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "886,17,888,52")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "886,17,886,66")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "886,17,886,57")
                                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "886,18,886,53")
                                       ; dr-lookup-rule-in-scope(|key, scpid))> rs) => value)
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "887,19,888,52")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "887,19,887,56")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "887,20,887,50")
                                    ; hashtable-remove(|(scpid, key)))> tbl1)
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "888,19,888,52")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "888,20,888,45")
                                 ; iset-remove(|(scpid, key)))> rmset
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "889,17,890,52")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "889,17,889,58")
                                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "889,18,889,52")
                                       ; hashtable-put(|(scpid, key), value))> tbl1)
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "890,19,890,52")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "890,20,890,45")
                                    ; iset-remove(|(scpid, key)))> rmset))
                    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "set2", "884,12,890,52")
                    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "set2", "884,12,890,52")
                      ; fail
                  rm2(|scpid, tbl2, key) =
                    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rm2", "892,12,897,19")
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "893,14,897,19")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "893,14,893,35")
                       ; rm1(|scpid, tbl2, key)
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "894,17,897,19")
                          ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "894,20,894,60")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "894,21,894,56")
                                   ; dr-lookup-rule-in-scope(|key, scpid))> rs then
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "895,19,896,51")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "895,19,895,56")
                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "895,20,895,50")
                                     ; hashtable-remove(|(scpid, key)))> tbl1)
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "896,21,896,51")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "896,22,896,44")
                                  ; iset-add(|(scpid, key)))> rmset
                            end)
                    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rm2", "892,12,897,19")
                    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rm2", "892,12,897,19")
                      ; fail
              in
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "899,12,904,14")
                ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "899,15,899,46")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "899,16,899,36")
                         ; iset-contains(|label))> labelset then
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "900,14,901,43")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "900,14,900,63")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "900,15,900,59")
                           ; fetch-elem(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "900,26,900,58")
                               ; ?RuleScope(_, tbl@Hashtable(hptr))
                             ))> rs)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "901,16,901,43")
                    ; set2(|hptr, tbl, key, value)
                  else
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "903,14,903,71")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "903,15,903,67")
                        ; dr-set-in-rule-set-vis(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "903,38,903,41") ; set2
                          , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "903,44,903,46") ; rm2
                          | label
                          , key
                          , value
                          ))> rs
                  end
              end)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "878,2,906,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-set-in-rule-set-vis", "878,2,906,6")
      ; fail


strategies
  dr-add-to-rule-set(|key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "914,2,915,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "915,4,915,38")
    ; dr-add-to-rule-set(|(), key, value)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "914,2,915,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "914,2,915,38")
      ; fail

  dr-add-to-rule-set(|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "923,2,924,54")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "924,4,924,54")
    ; dr-add-to-rule-set(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "924,23,924,33") ; dr-add-fail
      | label
      , key
      , value
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "923,2,924,54")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "923,2,924,54")
      ; fail

  dr-add-fail(|scpid, tbl, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-fail", "926,2,927,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "927,4,927,7")
    ; fail
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-fail", "926,2,927,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-fail", "926,2,927,7")
      ; fail

  dr-rm-fail(|scpid, tbl, key) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rm-fail", "929,2,930,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "930,4,930,7")
    ; fail
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rm-fail", "929,2,930,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-rm-fail", "929,2,930,7")
      ; fail

  dr-add-to-rule-set(add : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "932,2,940,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "934,4,940,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "934,4,934,51")
       ; ?[RuleScope(labelset, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "935,6,940,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "936,8,939,57")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "936,8,936,39")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "936,9,936,29")
                   ; iset-contains(|label))> labelset
               < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "937,11,938,53")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "937,11,937,37")
                    ; add(|hptr, tbl, key, value)
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "938,14,938,53")
                       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "938,20,938,52")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "938,21,938,47")
                                   ; hashtable-push(|key, value))> tbl))
               + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "939,10,939,57")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "939,11,939,53")
                     ; dr-add-to-rule-set(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "939,30,939,32") ; add
                       | label
                       , key
                       , value
                       ))> rs))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "932,2,940,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "932,2,940,6")
      ; fail

  dr-add-to-rule-set(add1 : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "942,2,971,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "944,4,971,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "944,4,944,43")
       ; ?[ChangeSet(labelset, rmset, tbl1)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "945,6,971,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "946,8,970,10")
            ; let add2(|scpid, tbl2, key, value) =
                    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "add2", "946,12,962,85")
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "947,14,962,85")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "947,14,947,43")
                       ; add1(|scpid, tbl2, key, value)
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "948,17,962,85")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "948,17,958,17")
                             ; {values:
                                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "950,18,957,22")
                                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "950,18,950,73")
                                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "950,18,950,63")
                                       ; ![value|<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "950,29,950,56")
                                                  ; hashtable-get(|(scpid, key))> tbl1]) => values)
                                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "951,20,957,22")
                                 ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "951,23,951,73")
                                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "951,23,951,63")
                                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "951,24,951,59")
                                             ; dr-lookup-rule-in-scope(|key, scpid))> rs) => values then
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "952,22,953,57")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "952,22,952,59")
                                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "952,23,952,53")
                                            ; hashtable-remove(|(scpid, key)))> tbl1)
                                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "953,24,953,57")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "953,25,953,50")
                                         ; iset-remove(|(scpid, key)))> rmset
                                   else
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "955,22,956,57")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "955,22,955,64")
                                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "955,23,955,58")
                                            ; hashtable-put(|(scpid, key), values))> tbl1)
                                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "956,24,956,57")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "956,25,956,50")
                                         ; iset-remove(|(scpid, key)))> rmset
                                   end
                               }
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "961,17,962,85")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "961,18,961,65")
                                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "961,18,961,58")
                                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "961,19,961,54")
                                          ; dr-lookup-rule-in-scope(|key, scpid))> rs
                                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "961,63,961,65")
                                         ; ![]))
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "962,19,962,85")
                                ; \ values -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "962,32,962,77")
                                               ; hashtable-put(
                                                 | (scpid, key)
                                                 , [value|values]
                                                 )> tbl1 \))
                    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "add2", "946,12,962,85")
                    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "add2", "946,12,962,85")
                      ; fail
              in
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "964,12,969,14")
                ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "964,15,964,46")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "964,16,964,36")
                         ; iset-contains(|label))> labelset then
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "965,15,966,44")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "965,15,965,65")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "965,16,965,61")
                           ; fetch-elem(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "965,27,965,60")
                               ; ?RuleScope(_, tbl@Hashtable(hptr))
                             ))> rs)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "966,17,966,44")
                    ; add2(|hptr, tbl, key, value)
                  else
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "968,15,968,63")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "968,16,968,59")
                        ; dr-add-to-rule-set(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "968,35,968,38") ; add2
                          | label
                          , key
                          , value
                          ))> rs
                  end
              end)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "942,2,971,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set", "942,2,971,6")
      ; fail

  dr-add-to-rule-set-vis(|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "979,2,980,70")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "980,4,980,70")
    ; dr-add-to-rule-set-vis(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "980,27,980,37") ; dr-add-fail
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "980,40,980,49") ; dr-rm-fail
      | label
      , key
      , value
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "979,2,980,70")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "979,2,980,70")
      ; fail

  dr-add-to-rule-set-vis(add : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm, rm : ATerm * Hashtable * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "982,2,995,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "986,4,995,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "986,4,986,51")
       ; ?[RuleScope(labelset, tbl@Hashtable(hptr))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "987,6,995,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "988,8,994,10")
            ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "988,11,988,42")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "988,12,988,32")
                     ; iset-contains(|label))> labelset then
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "989,11,990,46")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "989,11,989,37")
                   ; add(|hptr, tbl, key, value)
                   <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "990,14,990,46")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "990,15,990,41")
                          ; hashtable-push(|key, value))> tbl)
              else
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "992,10,993,66")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "992,11,992,61")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "992,11,992,29")
                      ; rm(|hptr, tbl, key)
                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "992,34,992,61")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "992,35,992,56")
                             ; hashtable-remove(|key))> tbl))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "993,12,993,66")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "993,13,993,62")
                    ; dr-add-to-rule-set-vis(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "993,36,993,38") ; add
                      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "993,41,993,42") ; rm
                      | label
                      , key
                      , value
                      ))> rs
              end)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "982,2,995,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "982,2,995,6")
      ; fail

  dr-add-to-rule-set-vis(add1 : ATerm * Hashtable * ATerm * ATerm * ATerm -> ATerm, rm1 : ATerm * Hashtable * ATerm * ATerm -> ATerm|label, key, value) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "997,2,1035,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1001,4,1035,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1001,4,1001,43")
       ; ?[ChangeSet(labelset, rmset, tbl1)|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1002,6,1035,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1003,8,1034,10")
            ; let add2(|scpid, tbl2, key, value) =
                    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "add2", "1003,12,1019,85")
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1004,14,1019,85")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1004,14,1004,43")
                       ; add1(|scpid, tbl2, key, value)
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1005,17,1019,85")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1005,17,1015,17")
                             ; {values:
                                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1007,18,1014,22")
                                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1007,18,1007,73")
                                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1007,18,1007,63")
                                       ; ![value|<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1007,29,1007,56")
                                                  ; hashtable-get(|(scpid, key))> tbl1]) => values)
                                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1008,20,1014,22")
                                 ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1008,23,1008,73")
                                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1008,23,1008,63")
                                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1008,24,1008,59")
                                             ; dr-lookup-rule-in-scope(|key, scpid))> rs) => values then
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1009,22,1010,57")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1009,22,1009,59")
                                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1009,23,1009,53")
                                            ; hashtable-remove(|(scpid, key)))> tbl1)
                                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1010,24,1010,57")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1010,25,1010,50")
                                         ; iset-remove(|(scpid, key)))> rmset
                                   else
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1012,22,1013,57")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1012,22,1012,64")
                                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1012,23,1012,58")
                                            ; hashtable-put(|(scpid, key), values))> tbl1)
                                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1013,24,1013,57")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1013,25,1013,50")
                                         ; iset-remove(|(scpid, key)))> rmset
                                   end
                               }
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1018,17,1019,85")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1018,18,1018,65")
                                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1018,18,1018,58")
                                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1018,19,1018,54")
                                          ; dr-lookup-rule-in-scope(|key, scpid))> rs
                                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1018,63,1018,65")
                                         ; ![]))
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1019,19,1019,85")
                                ; \ values -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1019,32,1019,77")
                                               ; hashtable-put(
                                                 | (scpid, key)
                                                 , [value|values]
                                                 )> tbl1 \))
                    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "add2", "1003,12,1019,85")
                    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "add2", "1003,12,1019,85")
                      ; fail
                  rm2(|scpid, tbl2, key) =
                    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rm2", "1021,12,1026,19")
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1022,14,1026,19")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1022,14,1022,35")
                       ; rm1(|scpid, tbl2, key)
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1023,17,1026,19")
                          ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1023,20,1023,60")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1023,21,1023,56")
                                   ; dr-lookup-rule-in-scope(|key, scpid))> rs then
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1024,19,1025,51")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1024,19,1024,56")
                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1024,20,1024,50")
                                     ; hashtable-remove(|(scpid, key)))> tbl1)
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1025,21,1025,51")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1025,22,1025,44")
                                  ; iset-add(|(scpid, key)))> rmset
                            end)
                    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rm2", "1021,12,1026,19")
                    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rm2", "1021,12,1026,19")
                      ; fail
              in
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1028,12,1033,14")
                ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1028,15,1028,46")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1028,16,1028,36")
                         ; iset-contains(|label))> labelset then
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1029,14,1030,43")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1029,14,1029,64")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1029,15,1029,60")
                           ; fetch-elem(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1029,26,1029,59")
                               ; ?RuleScope(_, tbl@Hashtable(hptr))
                             ))> rs)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1030,16,1030,43")
                    ; add2(|hptr, tbl, key, value)
                  else
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1032,14,1032,71")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1032,15,1032,67")
                        ; dr-add-to-rule-set-vis(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1032,38,1032,41") ; add2
                          , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1032,44,1032,46") ; rm2
                          | label
                          , key
                          , value
                          ))> rs
                  end
              end)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "997,2,1035,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-add-to-rule-set-vis", "997,2,1035,6")
      ; fail


strategies
  dr-merge-rule-sets(merge-rs, merge-cs) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets", "1046,2,1051,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1047,4,1051,4")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1048,6,1050,44")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1048,6,1048,7") ; eq
           < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1048,11,1048,14") ; fail
           + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1049,9,1050,43")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1049,9,1049,40")
                ; dr-merge-rule-sets1(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1049,29,1049,36") ; merge-rs
                  , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1049,39,1049,39") ; x
                  )
                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1050,12,1050,43")
                   ; dr-merge-rule-sets2(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1050,32,1050,39") ; merge-cs
                     , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1050,42,1050,42") ; x
                     )))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets", "1046,2,1051,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets", "1046,2,1051,4")
      ; fail

  dr-merge-rule-sets1(merge-rs, merge-rec) :
    ( rs1@[RuleScope(labels1, tbl1)|rs1a]
    , rs2@[RuleScope(labels2, tbl2)|rs2a]
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets1", "1053,2,1057,69")> rs1
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets1", "1053,2,1057,69")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets1", "1053,2,1057,69")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1057,6,1057,69")
          ; ior(
              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1057,10,1057,42")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1057,11,1057,18") ; merge-rs)> (rs1, tbl1, rs2, tbl2)
            , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1057,45,1057,68")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1057,46,1057,54") ; merge-rec)> (rs1a, rs2a)
            )
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets1", "1053,2,1057,69")
             ; fail

  dr-merge-rule-sets2(merge-cs, merge-rec) :
    ( rs1@[cs1@ChangeSet(
                 labels1
               , rmset1
               , tbl1@Hashtable(csid1)
               )|rs1a]
    , rs2@[cs2@ChangeSet(
                 labels2
               , rmset2
               , tbl2@Hashtable(csid2)
               )|rs2a]
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets2", "1059,2,1109,8")> [cs|rs1a]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets2", "1059,2,1109,8")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets2", "1059,2,1109,8")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,6,1109,8")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,6,1064,122")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,7,1064,110")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,8,1064,91")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,8,1064,31")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,9,1064,16") ; DR_BREAK)> IgnoreB(csid1)
                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,36,1064,91")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,36,1064,59")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,37,1064,44") ; DR_BREAK)> IgnoreC(csid1)
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,64,1064,91")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,65,1064,76") ; DR_EXCEPTION)> IgnoreT(csid1)))
                   < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,96,1064,104")
                     ; !"ignore"
                   + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1064,108,1064,110")
                     ; !"")) => slabel1)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,8,1109,8")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,8,1065,124")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,9,1065,112")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,10,1065,93")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,10,1065,33")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,11,1065,18") ; DR_BREAK)> IgnoreB(csid2)
                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,38,1065,93")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,38,1065,61")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,39,1065,46") ; DR_BREAK)> IgnoreC(csid2)
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,66,1065,93")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,67,1065,78") ; DR_EXCEPTION)> IgnoreT(csid2)))
                   < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,98,1065,106")
                     ; !"ignore"
                   + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1065,110,1065,112")
                     ; !"")) => slabel2)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1071,8,1109,8")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1071,8,1076,8")
             ; try(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1072,10,1075,41")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1072,10,1072,40")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1072,10,1072,33")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1072,11,1072,18") ; DR_BREAK)> IgnoreB(csid1)) => lb1)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1073,12,1075,41")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1073,12,1073,42")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1073,12,1073,35")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1073,13,1073,20") ; DR_BREAK)> IgnoreC(csid2)) => lc2)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1074,12,1075,41")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1074,12,1074,48")
                    ; rules ( DR_BREAK.lb1 :-
                                IgnoreB(csid1) ))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1075,12,1075,41")
                 ; dr-define-ignoreC(|csid1, lc2)
               ))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1077,8,1109,8")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1077,8,1082,8")
             ; try(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1078,10,1081,41")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1078,10,1078,40")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1078,10,1078,33")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1078,11,1078,18") ; DR_BREAK)> IgnoreB(csid2)) => lb2)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1079,12,1081,41")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1079,12,1079,42")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1079,12,1079,35")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1079,13,1079,20") ; DR_BREAK)> IgnoreC(csid1)) => lc1)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1080,12,1081,41")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1080,12,1080,48")
                    ; rules ( DR_BREAK.lb2 :-
                                IgnoreB(csid2) ))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1081,12,1081,41")
                 ; dr-define-ignoreC(|csid2, lc1)
               ))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1086,9,1108,160")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1086,9,1086,30")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1086,10,1086,11") ; eq)> (slabel1, slabel2)
             < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1087,12,1100,14")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1087,12,1087,91")
                  ; ior(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1087,16,1087,64")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1087,17,1087,24") ; merge-cs)> (rs1, rmset1, tbl1, rs2, rmset2, tbl2)
                    , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1087,67,1087,90")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1087,68,1087,76") ; merge-rec)> (rs1a, rs2a)
                    ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1088,14,1100,14")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1088,14,1088,23")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1088,14,1088,17") ; !cs1) => cs)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1089,14,1100,14")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1089,14,1092,14")
                  ; try(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1090,16,1091,42")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1090,16,1090,43")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1090,17,1090,28") ; DR_EXCEPTION)> IgnoreT(csid2))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1091,18,1091,42")
                      ; dr-define-ignoreT(|csid1)
                    ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1093,14,1100,14")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1093,14,1096,14")
                  ; try(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1094,16,1095,46")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1094,16,1094,45")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1094,16,1094,39")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1094,17,1094,24") ; DR_BREAK)> IgnoreB(csid2)) => lb)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1095,18,1095,46")
                      ; dr-define-ignoreB(|csid1, lb)
                    ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1097,14,1100,14")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1098,16,1099,46")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1098,16,1098,45")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1098,16,1098,39")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1098,17,1098,24") ; DR_BREAK)> IgnoreC(csid2)) => lc)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1099,18,1099,46")
                   ; dr-define-ignoreC(|csid1, lc)
                 )
             + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1102,12,1108,159")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1102,12,1102,27")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1102,13,1102,14") ; eq)> (rs1a, rs2a)
                  < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1103,14,1107,18")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1103,15,1106,23")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1103,15,1104,20")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1103,15,1103,37")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1103,16,1103,17") ; eq)> (slabel1, "ignore"))
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1104,17,1104,20")
                          ; !cs2
                          <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1105,18,1106,23")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1105,18,1105,40")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1105,19,1105,20") ; eq)> (slabel2, "ignore"))
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1106,20,1106,23")
                             ; !cs1)) => cs
                  + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1108,14,1108,159")
                    ; fatal-err(|"Merging of rulesets cannot continue because the non-ingnored change set is based on a different ruleset than the ignored change set.")))
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-rule-sets2", "1059,2,1109,8")
             ; fail

  dr-fix-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-change-set", "1119,2,1156,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1120,4,1156,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1120,4,1120,48")
       ; ?( cs@ChangeSet(_, rmset, tbl)
          , rsgood
          , rsbad
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1121,6,1156,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1121,6,1121,66")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1121,6,1121,51")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1121,7,1121,44")
              ; filter(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1121,14,1121,43")
                  ; ?RuleScope(
                       _
                     , Hashtable(
                         <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1121,39,1121,40") ; id>
                       )
                     )
                ))> rsgood) => scpidsgood_)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1122,6,1156,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1122,6,1122,65")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1122,6,1122,51")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1122,7,1122,44")
              ; filter(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1122,14,1122,43")
                  ; ?RuleScope(
                       _
                     , Hashtable(
                         <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1122,39,1122,40") ; id>
                       )
                     )
                ))> rsgood) => scpidsbad_)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1123,6,1156,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1123,6,1155,6")
       ; try(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1125,8,1154,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1125,8,1125,41")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1125,9,1125,15")
                  ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1125,13,1125,14") ; eq))> (scpidsgood_, scpidsbad_))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1126,10,1154,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1126,10,1130,10")
              ; try(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1128,12,1129,68")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1128,12,1128,61")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1128,13,1128,19")
                         ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1128,17,1128,18") ; eq))> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1128,23,1128,28") ; length> scpidsgood_
                                                                                                                                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1128,44,1128,49") ; length> scpidsbad_
                                                                                                                                   ))
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1129,14,1129,68")
                  ; fatal-err(|"Expected structurally matching rule sets!")
                ))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1134,10,1154,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1134,10,1134,86")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1134,10,1134,59")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1134,11,1134,33") ; eliminate-common-suffix)> (scpidsgood_, scpidsbad_)) => (scpidsgood, scpidsbad))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1136,10,1154,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1136,10,1136,29")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1136,11,1136,23") ; iset-elements)> rmset)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1137,10,1154,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1137,10,1144,11")
              ; map(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1137,14,1144,10")
                  ; {key, scpid, k, idx:
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1138,12,1143,14")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1138,12,1138,26")
                         ; ?key@(scpid, k))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1139,14,1143,14")
                      ; try(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1140,16,1142,64")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1140,16,1140,51")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1140,16,1140,44")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1140,17,1140,25") ; get-index)> (scpid, scpidsbad)) => idx)
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1141,18,1142,64")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1141,18,1141,41")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1141,19,1141,35")
                                 ; iset-remove(|key))> rmset)
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1142,18,1142,64")
                          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1142,19,1142,58")
                              ; iset-add(
                                | ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1142,31,1142,35") ; index> (idx, scpidsgood)
                                  , k
                                  )
                                ))> rmset
                        )
                    }
                ))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1145,10,1154,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1145,10,1145,28")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1145,11,1145,24") ; hashtable-keys)> tbl)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1146,10,1154,11")
           ; map(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1146,14,1154,10")
               ; {key, scpid, k, idx, val:
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1147,12,1153,14")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1147,12,1147,26")
                      ; ?key@(scpid, k))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1148,14,1153,14")
                   ; try(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1149,16,1152,72")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1149,16,1149,51")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1149,16,1149,44")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1149,17,1149,25") ; get-index)> (scpid, scpidsbad)) => idx)
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1150,18,1152,72")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1150,18,1150,48")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1150,18,1150,41")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1150,19,1150,37")
                                 ; hashtable-get(|key))> tbl) => val)
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1151,18,1152,72")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1151,18,1151,44")
                          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1151,19,1151,40")
                              ; hashtable-remove(|key))> tbl)
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1152,18,1152,72")
                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1152,19,1152,68")
                           ; hashtable-put(
                             | ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1152,36,1152,40") ; index> (idx, scpidsgood)
                               , k
                               )
                             , val
                             ))> tbl
                     )
                 }
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1156,6,1156,8")
    ; !cs
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-change-set", "1119,2,1156,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-change-set", "1119,2,1156,8")
      ; fail

  dr-intersect-rule-sets =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-rule-sets", "1168,2,1176,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1169,4,1176,4")
    ; dr-merge-rule-sets(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1170,8,1171,55")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1170,9,1171,54")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1170,9,1170,31")
              ; ?(rs1, tbl1, rs2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1171,11,1171,54")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1171,12,1171,48")
               ; hashtable-intersect-wempty(|tbl2, []))> tbl1}
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1172,8,1175,55")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1172,9,1175,54")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1172,9,1172,47")
              ; ?(rs1, rmset1, tbl1, rs2, rmset2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1173,11,1175,54")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1173,11,1173,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1173,12,1173,32")
                  ; apply-rm-set(|rmset2))> tbl1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1174,11,1175,54")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1174,11,1174,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1174,12,1174,30")
                  ; iset-union(|rmset2))> rmset1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1175,11,1175,54")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1175,12,1175,48")
               ; hashtable-intersect-wempty(|tbl2, []))> tbl1}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-rule-sets", "1168,2,1176,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-rule-sets", "1168,2,1176,4")
      ; fail

  apply-rm-set(|rmset) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "apply-rm-set", "1178,2,1182,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1178,25,1182,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1178,25,1178,28") ; ?tbl)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1179,6,1182,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1180,8,1181,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1180,8,1180,28")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1180,9,1180,21") ; iset-elements)> rmset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1181,10,1181,49")
            ; map(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1181,14,1181,48")
                ; {x:
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1181,18,1181,47")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1181,18,1181,19") ; ?x)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1181,22,1181,47")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1181,23,1181,42")
                        ; hashtable-remove(|x))> tbl
                  }
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "apply-rm-set", "1178,2,1182,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "apply-rm-set", "1178,2,1182,6")
      ; fail

  dr-intersect-rule-sets-symm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-rule-sets-symm", "1194,2,1204,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1195,4,1204,4")
    ; dr-merge-rule-sets(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1196,8,1197,62")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1196,9,1197,61")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1196,9,1196,31")
              ; ?(rs1, tbl1, rs2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1197,11,1197,61")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1197,12,1197,47")
               ; hashtable-intersect-symm-wempty(|[]))> (tbl1, tbl2)}
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1198,8,1203,74")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1198,9,1203,73")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1198,9,1198,47")
              ; ?(rs1, rmset1, tbl1, rs2, rmset2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1199,11,1203,73")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1199,11,1199,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1199,12,1199,32")
                  ; apply-rm-set(|rmset2))> tbl1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1200,11,1203,73")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1200,11,1200,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1200,12,1200,32")
                  ; apply-rm-set(|rmset1))> tbl2)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1201,11,1203,73")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1201,11,1201,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1201,12,1201,30")
                  ; iset-union(|rmset2))> rmset1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1202,11,1203,73")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1202,11,1202,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1202,12,1202,30")
                  ; iset-union(|rmset1))> rmset2)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1203,11,1203,73")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1203,12,1203,59")
               ; hashtable-intersect-symm-wempty-ignore-left(|[]))> (tbl1, tbl2)}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-rule-sets-symm", "1194,2,1204,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-intersect-rule-sets-symm", "1194,2,1204,4")
      ; fail

  dr-union-rule-sets =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-rule-sets", "1214,2,1232,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1215,4,1232,4")
    ; dr-merge-rule-sets(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1216,8,1217,40")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1216,9,1217,39")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1216,9,1216,31")
              ; ?(rs1, tbl1, rs2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1217,11,1217,39")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1217,12,1217,33")
               ; hashtable-union(|tbl2))> tbl1}
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1219,8,1231,26")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1219,9,1231,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1219,9,1219,47")
              ; ?(rs1, rmset1, tbl1, rs2, rmset2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1220,11,1231,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1220,11,1220,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1220,12,1220,32")
                  ; apply-rm-set(|rmset2))> tbl1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1221,11,1231,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1221,11,1221,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1221,12,1221,30")
                  ; iset-union(|rmset2))> rmset1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1222,11,1231,25")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1222,12,1231,11")
               ; hashtable-merge(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1223,13,1223,24") ; symmetric-no
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1224,13,1224,24") ; iterate1-yes
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1225,13,1225,24") ; iterate2-yes
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1226,13,1226,21") ; remove-no
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1227,13,1227,17") ; union
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1228,13,1228,15")
                   ; ![]
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1229,13,1229,72")
                   ; \ (scpid, key) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1229,31,1229,66")
                                        ; dr-lookup-rule-in-scope(|key, scpid)> rs1 \
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1230,13,1230,72")
                   ; \ (scpid, key) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1230,31,1230,66")
                                        ; dr-lookup-rule-in-scope(|key, scpid)> rs2 \
                 ))> (tbl1, tbl2)}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-rule-sets", "1214,2,1232,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-rule-sets", "1214,2,1232,4")
      ; fail

  dr-union-rule-sets-symm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-rule-sets-symm", "1234,2,1257,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1235,4,1257,4")
    ; dr-merge-rule-sets(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1236,8,1237,58")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1236,9,1237,57")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1236,9,1236,31")
              ; ?(rs1, tbl1, rs2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1237,11,1237,57")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1237,12,1237,43")
               ; hashtable-union-symm-wempty(|[]))> (tbl1, tbl2)}
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1239,8,1256,26")
        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1239,9,1256,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1239,9,1239,47")
              ; ?(rs1, rmset1, tbl1, rs2, rmset2, tbl2))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1240,11,1256,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1240,11,1240,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1240,12,1240,32")
                  ; apply-rm-set(|rmset2))> tbl1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1241,11,1256,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1241,11,1241,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1241,12,1241,32")
                  ; apply-rm-set(|rmset1))> tbl2)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1242,11,1256,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1242,11,1242,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1242,12,1242,30")
                  ; iset-union(|rmset2))> rmset1)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1243,11,1256,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1243,11,1243,38")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1243,12,1243,30")
                  ; iset-union(|rmset1))> rmset2)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1245,11,1256,25")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1245,12,1256,11")
               ; hashtable-merge(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1246,13,1246,25") ; symmetric-yes
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1247,13,1247,24") ; iterate1-yes
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1248,13,1248,24") ; iterate2-yes
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1249,13,1249,21") ; remove-no
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1250,13,1250,17") ; union
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1251,13,1251,15")
                   ; ![]
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1252,13,1252,22") ; change1-no
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1253,13,1253,23") ; change2-yes
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1254,13,1254,73")
                   ; \ (scpid, key) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1254,31,1254,66")
                                        ; dr-lookup-rule-in-scope(|key, scpid)> rs1 \
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1255,13,1255,73")
                   ; \ (scpid, key) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1255,31,1255,66")
                                        ; dr-lookup-rule-in-scope(|key, scpid)> rs2 \
                 ))> (tbl1, tbl2)}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-rule-sets-symm", "1234,2,1257,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-union-rule-sets-symm", "1234,2,1257,4")
      ; fail


strategies
  fork-rule-sets :
    rulename -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "fork-rule-sets", "1261,2,1265,39")> (rulename, rs)
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "fork-rule-sets", "1261,2,1265,39")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "fork-rule-sets", "1261,2,1265,39")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1263,10,1265,39")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1263,10,1263,35")
             ; dr-get-rule-set(|rulename))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1264,10,1265,39")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1264,10,1264,34")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1264,10,1264,28") ; dr-start-change-set) => rs)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1265,10,1265,39")
          ; dr-start-change-set(|rulename)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "fork-rule-sets", "1261,2,1265,39")
             ; fail

  merge-rule-sets(merge) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "merge-rule-sets", "1267,2,1270,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1268,4,1270,36")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1268,4,1268,20")
       ; ?( rulename
          , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1268,17,1268,18") ; id>
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1269,6,1270,36")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1269,6,1269,33")
       ; try(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1269,10,1269,32")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1269,11,1269,15") ; merge)> ( rulename
                                                                                                                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1269,29,1269,30") ; id>
                                                                                                                     )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1270,6,1270,36")
    ; dr-commit-change-set(|rulename)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "merge-rule-sets", "1267,2,1270,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "merge-rule-sets", "1267,2,1270,36")
      ; fail

  dr-fork-and-merge(merge, s1, s2|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-merge", "1278,2,1283,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1279,4,1283,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1279,4,1279,48")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1279,10,1279,47")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1279,10,1279,40")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1279,11,1279,29")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1279,15,1279,28") ; fork-rule-sets
                        ))> rulenames) => rs1))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,6,1283,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,6,1280,70")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,14,1280,15") ; s1
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,18,1280,69")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,24,1280,68")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,25,1280,57")
                       ; map(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,29,1280,56")
                           ; dr-discard-change-set(
                             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1280,53,1280,54") ; id>
                             )
                         ))> rulenames)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,6,1283,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,6,1281,73")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,12,1281,72")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,12,1281,65")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,13,1281,60")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,17,1281,59")
                          ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,18,1281,58")
                             ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,19,1281,27") ; ?rulename
                               , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1281,29,1281,57")
                                 ; dr-switch-rule-set(|rulename)
                               )}
                        ))> rs1) => rs2))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,6,1283,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,6,1282,70")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,14,1282,15") ; s2
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,18,1282,69")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,24,1282,68")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,25,1282,57")
                       ; map(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,29,1282,56")
                           ; dr-discard-change-set(
                             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1282,53,1282,54") ; id>
                             )
                         ))> rulenames)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1283,6,1283,45")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1283,12,1283,44")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1283,13,1283,39")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1283,17,1283,38")
                    ; merge-rule-sets(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1283,33,1283,37") ; merge
                      )
                  ))> rs2)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-merge", "1278,2,1283,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-merge", "1278,2,1283,45")
      ; fail

  dr-fork-and-merge(merge1, merge2, s1, s2|rulenames1, rulenames2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-merge", "1285,2,1311,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1286,4,1311,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1286,4,1289,4")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1287,6,1288,45")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1287,6,1287,45")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1287,6,1287,37")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1287,7,1287,25")
                         ; map(
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1287,11,1287,24") ; fork-rule-sets
                           ))> rulenames1) => rs1a)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1288,6,1288,45")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1288,6,1288,37")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1288,7,1288,25")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1288,11,1288,24") ; fork-rule-sets
                        ))> rulenames2) => rs1b))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1290,6,1311,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1290,6,1296,6")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1291,8,1291,9") ; s1
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1292,8,1295,8")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1293,10,1294,55")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1293,10,1293,55")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1293,11,1293,43")
                          ; map(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1293,15,1293,42")
                              ; dr-discard-change-set(
                                | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1293,39,1293,40") ; id>
                                )
                            ))> rulenames1)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1294,10,1294,55")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1294,11,1294,43")
                       ; map(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1294,15,1294,42")
                           ; dr-discard-change-set(
                             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1294,39,1294,40") ; id>
                             )
                         ))> rulenames2)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1297,6,1311,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1297,6,1300,6")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,8,1299,70")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,8,1298,70")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,8,1298,62")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,9,1298,56")
                         ; map(
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,13,1298,55")
                             ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,14,1298,54")
                                ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,15,1298,23") ; ?rulename
                                  , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1298,25,1298,53")
                                    ; dr-switch-rule-set(|rulename)
                                  )}
                           ))> rs1a) => rs2a)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,8,1299,70")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,8,1299,62")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,9,1299,56")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,13,1299,55")
                          ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,14,1299,54")
                             ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,15,1299,23") ; ?rulename
                               , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1299,25,1299,53")
                                 ; dr-switch-rule-set(|rulename)
                               )}
                        ))> rs1b) => rs2b))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1301,6,1311,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1301,6,1307,6")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1302,8,1302,9") ; s2
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1303,8,1306,8")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1304,10,1305,55")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1304,10,1304,55")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1304,11,1304,43")
                          ; map(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1304,15,1304,42")
                              ; dr-discard-change-set(
                                | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1304,39,1304,40") ; id>
                                )
                            ))> rulenames1)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1305,10,1305,55")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1305,11,1305,43")
                       ; map(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1305,15,1305,42")
                           ; dr-discard-change-set(
                             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1305,39,1305,40") ; id>
                             )
                         ))> rulenames2)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1308,6,1311,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1309,8,1310,42")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1309,8,1309,42")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1309,9,1309,36")
                   ; map(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1309,13,1309,35")
                       ; merge-rule-sets(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1309,29,1309,34") ; merge1
                         )
                     ))> rs2a)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1310,8,1310,42")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1310,9,1310,36")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1310,13,1310,35")
                    ; merge-rule-sets(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1310,29,1310,34") ; merge2
                      )
                  ))> rs2b)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-merge", "1285,2,1311,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-merge", "1285,2,1311,6")
      ; fail


strategies
  dr-fix-and-merge(merge, s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1342,2,1343,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1343,4,1343,45")
    ; dr-fix-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1343,21,1343,25") ; merge
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1343,28,1343,28") ; s
      | rulenames
      , ""
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1342,2,1343,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1342,2,1343,45")
      ; fail

  dr-fix-and-merge(merge, s|rulenames, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1345,2,1346,86")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1346,4,1346,86")
    ; dr-label(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1346,13,1346,17") ; merge
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1346,20,1346,66")
        ; dr-fix-and-merge-internal(
            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1346,46,1346,50") ; merge
          , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1346,53,1346,53") ; s
          | rulenames
          )
      | rulenames
      , label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1345,2,1346,86")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1345,2,1346,86")
      ; fail

  dr-fix-and-merge-internal(merge, s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge-internal", "1350,2,1418,56")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1351,4,1418,56")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1351,4,1351,47")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1351,10,1351,46")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1351,10,1351,40")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1351,11,1351,29")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1351,15,1351,28") ; fork-rule-sets
                        ))> rulenames) => rs))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1352,6,1418,56")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1352,6,1357,6")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1353,8,1356,20")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1353,8,1355,20")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1353,8,1353,74")
                     ; prim(
                         "SSL_hashtable_get"
                       , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1353,35,1353,56") ; dr-rule-sets-hashtable>
                       , "DR_EXCEPTION"
                       ))
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1354,10,1355,20")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1354,10,1354,82")
                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1354,10,1354,54")
                        ; [ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1354,11,1354,53")
                            ; RuleScope(
                                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1354,21,1354,33") ; iset-elements
                              , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1354,36,1354,52") ; hashtable-getlist
                              )
                          ]) => [RuleScope(labels, tbl)])
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1355,10,1355,20")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1355,10,1355,11")
                     ; !0) => exRS
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1356,11,1356,20")
                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1356,11,1356,12")
                        ; !1) => exRS)))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1358,6,1418,56")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1358,6,1399,6")
       ; repeat(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1359,8,1398,8")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,10,1397,14")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,10,1360,73")
                      ; restore(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,18,1360,18") ; s
                        , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,21,1360,72")
                          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,27,1360,71")
                                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,28,1360,60")
                                      ; map(
                                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,32,1360,59")
                                          ; dr-discard-change-set(
                                            | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1360,56,1360,57") ; id>
                                            )
                                        ))> rulenames)
                        ))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1361,12,1397,14")
                   ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1361,15,1375,24")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1361,15,1375,20")
                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1361,16,1375,16")
                               ; filter(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1361,23,1375,15")
                                   ; {rulename, ruleset, csid:
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1362,17,1374,21")
                                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1362,17,1362,36")
                                          ; ?(rulename, ruleset))
                                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1366,19,1374,21")
                                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1366,19,1366,93")
                                          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1366,25,1366,92")
                                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1366,25,1366,50")
                                                     ; dr-get-rule-set(|rulename)) => [ChangeSet(_, _, Hashtable(csid))|_]))
                                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1367,19,1374,21")
                                       ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1367,22,1367,44")
                                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1367,23,1367,30") ; DR_BREAK)> IgnoreB(csid) then
                                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1369,21,1370,26")
                                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1369,21,1369,46")
                                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1369,22,1369,26") ; merge)> (rulename, ruleset))
                                           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1370,23,1370,26")
                                           ; fail
                                         else
                                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1372,21,1373,48")
                                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1372,21,1372,94")
                                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1372,22,1372,85")
                                                  ; dr-merge-continue-change-sets(
                                                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1372,52,1372,56") ; merge
                                                    | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1372,61,1372,68") ; DR_BREAK> Label(rulename)
                                                    ))> rulename)
                                           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1373,23,1373,48")
                                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1373,24,1373,28") ; merge)> (rulename, ruleset)
                                         end
                                     }
                                 ))> rs)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1375,23,1375,24")
                        ; [] then
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1377,14,1377,21")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1377,14,1377,15") ; ?e)
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1377,18,1377,21")
                       ; fail
                     else
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1385,14,1396,17")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1385,14,1389,32")
                          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1385,20,1389,31")
                                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1385,21,1389,21")
                                      ; map(
                                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1385,25,1389,20")
                                          ; {rulename, label:
                                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1386,22,1388,72")
                                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1386,22,1386,30") ; ?rulename)
                                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1387,24,1388,72")
                                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1387,24,1387,57")
                                                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1387,24,1387,48")
                                                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1387,25,1387,32") ; DR_BREAK)> Label(rulename)) => label)
                                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1388,24,1388,72")
                                              ; rules (
                                                  DR_BREAK :+
                                                    BreakCS(rulename, label) -> ()
                                                )
                                            }
                                        ))> rulenames))
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1390,16,1396,17")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1390,16,1395,17")
                          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1390,22,1395,16")
                                  ; try(
                                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1391,18,1394,51")
                                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1391,18,1391,30")
                                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1391,19,1391,20") ; eq)> (exRS, 0))
                                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1392,20,1394,51")
                                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1392,20,1392,34") ; dr-new-rule-set)
                                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1393,20,1394,51")
                                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1393,20,1393,78")
                                         ; [ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1393,21,1393,77")
                                             ; RuleScope(
                                                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1393,31,1393,51")
                                                 ; iset-addlist(|labels)
                                               , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1393,54,1393,76")
                                                 ; hashtable-putlist(|tbl)
                                               )
                                           ])
                                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1394,20,1394,51")
                                      ; dr-set-rule-set(|"DR_EXCEPTION")
                                    )))
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1396,16,1396,17")
                       ; id
                     end)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1406,6,1418,56")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1406,6,1415,17")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1406,7,1415,7")
           ; map(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1406,11,1415,6")
               ; {rulename, label:
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1407,8,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1407,8,1407,16") ; ?rulename)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1408,10,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1408,10,1408,43")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1408,10,1408,34")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1408,11,1408,18") ; DR_BREAK)> Label(rulename)) => label)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1409,10,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1409,11,1409,57")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1409,11,1409,50")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1409,12,1409,25") ; bagof-DR_BREAK)> BreakCS(rulename, label)
                         <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1409,55,1409,57")
                            ; ![]))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1410,10,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1410,10,1410,29")
                      ; list-tokenize(|[()]))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1411,10,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1411,10,1411,19") ; first-last)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1412,10,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1412,10,1412,15") ; concat)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1413,10,1414,85")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1413,10,1413,59")
                      ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1413,16,1413,58")
                              ; rules ( DR_BREAK :-
                                          BreakCS(rulename, label) )))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1414,10,1414,85")
                   ; reverse-map(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1414,22,1414,84")
                       ; {val:
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1414,28,1414,83")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1414,28,1414,31") ; ?val)
                           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1414,34,1414,83")
                           ; rules (
                               DR_BREAK :+
                                 BreakCS(rulename, label) -> val
                             )
                         }
                     )
                 }
             ))> rulenames)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1417,6,1418,56")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1417,6,1417,7") ; !e)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1418,6,1418,56")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1418,12,1418,55")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1418,13,1418,44")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1418,17,1418,43")
                    ; dr-commit-change-set(
                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1418,40,1418,41") ; id>
                      )
                  ))> rulenames)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge-internal", "1350,2,1418,56")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge-internal", "1350,2,1418,56")
      ; fail

  dr-fix-and-merge(merge1, merge2, s|rulenames1, rulenames2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1420,2,1441,57")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,4,1441,57")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,4,1422,49")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,10,1422,48")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,10,1421,48")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,10,1421,41")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,11,1421,29")
                         ; map(
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1421,15,1421,28") ; fork-rule-sets
                           ))> rulenames1) => rs1)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1422,10,1422,48")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1422,10,1422,41")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1422,11,1422,29")
                      ; map(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1422,15,1422,28") ; fork-rule-sets
                        ))> rulenames2) => rs2))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1423,6,1441,57")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1423,6,1438,6")
       ; repeat(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1424,8,1437,8")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1425,10,1436,14")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1425,10,1431,10")
                      ; restore(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1426,12,1426,12") ; s
                        , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1427,12,1430,12")
                          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1428,14,1429,59")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1428,14,1428,59")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1428,15,1428,47")
                                         ; map(
                                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1428,19,1428,46")
                                             ; dr-discard-change-set(
                                               | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1428,43,1428,44") ; id>
                                               )
                                           ))> rulenames1)
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1429,14,1429,59")
                                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1429,15,1429,47")
                                      ; map(
                                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1429,19,1429,46")
                                          ; dr-discard-change-set(
                                            | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1429,43,1429,44") ; id>
                                            )
                                        ))> rulenames2)
                        ))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,12,1436,14")
                   ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,15,1433,81")
                        ; and(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,19,1432,80")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,19,1432,76")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,20,1432,71")
                                   ; filter(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,27,1432,70")
                                       ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,28,1432,69")
                                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,28,1432,43")
                                             ; ?( rulename
                                                , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,40,1432,41") ; id>
                                                ))
                                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,46,1432,69")
                                          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,47,1432,52") ; merge1)> ( rulename
                                                                                                                                                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,66,1432,67") ; id>
                                                                                                                                                     )}
                                     ))> rs1)
                            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1432,79,1432,80")
                            ; []
                          , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,19,1433,80")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,19,1433,76")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,20,1433,71")
                                   ; filter(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,27,1433,70")
                                       ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,28,1433,69")
                                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,28,1433,43")
                                             ; ?( rulename
                                                , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,40,1433,41") ; id>
                                                ))
                                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,46,1433,69")
                                          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,47,1433,52") ; merge2)> ( rulename
                                                                                                                                                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,66,1433,67") ; id>
                                                                                                                                                     )}
                                     ))> rs2)
                            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1433,79,1433,80")
                            ; []
                          ) then
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1435,14,1435,21")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1435,14,1435,15") ; ?e)
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1435,18,1435,21")
                       ; fail
                     end)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1439,6,1441,57")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1439,6,1439,7") ; !e)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1440,6,1441,57")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1440,12,1441,56")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1440,12,1440,56")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1440,13,1440,44")
                   ; map(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1440,17,1440,43")
                       ; dr-commit-change-set(
                         | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1440,40,1440,41") ; id>
                         )
                     ))> rulenames1)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1441,12,1441,56")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1441,13,1441,44")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1441,17,1441,43")
                    ; dr-commit-change-set(
                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1441,40,1441,41") ; id>
                      )
                  ))> rulenames2)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1420,2,1441,57")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-merge", "1420,2,1441,57")
      ; fail

  dr-merge-continue-change-sets(merge|label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-continue-change-sets", "1443,2,1459,52")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1444,4,1459,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1444,4,1444,12") ; ?rulename)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1445,6,1459,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1445,6,1445,74")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1445,6,1445,31")
          ; dr-get-rule-set(|rulename)) => [ChangeSet(_, _, Hashtable(csid))|rs])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1446,6,1459,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1446,7,1446,56")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1446,7,1446,49")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1446,8,1446,21") ; bagof-DR_BREAK)> ContinueCS(rulename, label)
          <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1446,54,1446,56")
             ; ![]))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1447,6,1459,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1447,6,1447,58")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1447,12,1447,57")
               ; rules ( DR_BREAK :-
                           ContinueCS(rulename, label) )))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,6,1459,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,6,1456,8")
       ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,9,1448,41")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,9,1448,16")
               ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,13,1448,15")
                     ; ?[]))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,19,1448,41")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1448,20,1448,27") ; DR_BREAK)> IgnoreC(csid) then
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1453,8,1454,60")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1453,8,1453,46")
              ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1453,14,1453,45")
                      ; dr-discard-change-set(|rulename)))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,10,1454,60")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,10,1454,56")
              ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,11,1454,50")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,11,1454,22")
                    ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,14,1454,15") ; id>|rs])
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,25,1454,50")
                 ; dr-set-rule-set(|rulename)|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,54,1454,55") ; id])
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1454,59,1454,60")
           ; Tl
         else
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1455,11,1455,12") ; id
         end)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,6,1459,52")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,10,1459,51")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,10,1459,21")
           ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,13,1459,14") ; id>|rs])
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,24,1459,51")
        ; try(
            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,28,1459,50")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,29,1459,33") ; merge)> ( rulename
                                                                                                                      , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1459,47,1459,48") ; id>
                                                                                                                      )
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-continue-change-sets", "1443,2,1459,52")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-merge-continue-change-sets", "1443,2,1459,52")
      ; fail


strategies
  dr-label(merge, s|rulenames, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label", "1466,2,1523,5")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1467,4,1523,5")
    ; {|DR_BREAK:
         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1470,6,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1470,6,1470,26")
            ; rules ( DR_BREAK+label ))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1471,8,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1471,8,1474,26")
            ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1471,14,1474,25")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1471,15,1474,15")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1471,19,1474,14")
                            ; {rulename:
                                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1472,16,1473,59")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1472,16,1472,24") ; ?rulename)
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1473,18,1473,59")
                                ; rules ( DR_BREAK :
                                            Label(rulename) -> label )
                              }
                          ))> rulenames))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1479,8,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1479,8,1486,8")
            ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1480,10,1485,25")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1480,11,1485,15")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1480,15,1485,14")
                            ; {rulename, pos:
                                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1481,16,1484,67")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1481,16,1481,24") ; ?rulename)
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1482,18,1484,67")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1482,18,1482,43")
                                   ; dr-get-rule-set(|rulename))
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1483,18,1484,67")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1483,18,1483,30")
                                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1483,18,1483,23") ; length) => pos)
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1484,18,1484,67")
                                ; rules (
                                    DR_BREAK :
                                      SplitPos(rulename, label) -> pos
                                  )
                              }
                          ))> rulenames))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1492,8,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1492,8,1492,56")
            ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1492,14,1492,55")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1492,15,1492,45")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1492,19,1492,44")
                            ; dr-start-change-set(
                              | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1492,41,1492,42") ; id>
                              )
                          ))> rulenames))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,8,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,8,1495,70")
            ; restore(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,16,1495,16") ; s
              , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,19,1495,69")
                ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,25,1495,68")
                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,26,1495,58")
                            ; map(
                                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,30,1495,57")
                                ; dr-discard-change-set(
                                  | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1495,54,1495,55") ; id>
                                  )
                              ))> rulenames)
              ))
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1496,8,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1496,8,1496,9") ; ?e)
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1501,8,1522,9")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1501,8,1520,19")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1501,9,1520,9")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1501,13,1520,8")
                    ; {rulename, rs, csid, csidnew, cslbl:
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1502,10,1519,42")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1502,10,1502,18") ; ?rulename)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1503,12,1519,42")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1503,12,1503,80")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1503,12,1503,37")
                              ; dr-get-rule-set(|rulename)) => [ChangeSet(_, _, Hashtable(csid))|rs])
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1504,12,1519,42")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1504,13,1504,59")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1504,13,1504,52")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1504,14,1504,27") ; bagof-DR_BREAK)> BreakCS(rulename, label)
                              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1504,57,1504,59")
                                 ; ![]))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,12,1519,42")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,12,1513,14")
                           ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,15,1505,47")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,15,1505,22")
                                   ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,19,1505,21")
                                         ; ?[]))
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,25,1505,47")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1505,26,1505,33") ; DR_BREAK)> IgnoreB(csid) then
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1510,14,1511,66")
                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1510,14,1510,52")
                                  ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1510,20,1510,51")
                                          ; dr-discard-change-set(|rulename)))
                               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,16,1511,66")
                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,16,1511,62")
                                  ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,17,1511,56")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,17,1511,28")
                                        ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,20,1511,21") ; id>|rs])
                                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,31,1511,56")
                                     ; dr-set-rule-set(|rulename)|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,60,1511,61") ; id])
                               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1511,65,1511,66")
                               ; Tl
                             else
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1512,17,1512,18") ; id
                             end)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,12,1519,42")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,12,1516,58")
                           ; map(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,16,1516,57")
                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,16,1516,27")
                                  ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,19,1516,20") ; id>|rs])
                               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,30,1516,57")
                               ; try(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,34,1516,56")
                                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,35,1516,39") ; merge)> ( rulename
                                                                                                                                             , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1516,53,1516,54") ; id>
                                                                                                                                             )
                                 )
                             ))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1519,12,1519,42")
                        ; dr-commit-change-set(|rulename)
                      }
                  ))> rulenames)
         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1522,8,1522,9")
         ; !e
      |}
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label", "1466,2,1523,5")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label", "1466,2,1523,5")
      ; fail

  dr-break(|rulename) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break", "1525,2,1526,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1526,4,1526,49")
    ; dr-break(
      | rulename
      , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1526,25,1526,32") ; DR_BREAK> Label(rulename)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break", "1525,2,1526,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break", "1525,2,1526,49")
      ; fail

  dr-break(|rulename, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break", "1528,2,1550,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1529,4,1550,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1530,6,1549,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1530,6,1530,37")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1530,6,1530,31")
                  ; dr-get-rule-set(|rulename)) => rs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1534,8,1549,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1534,8,1534,58")
               ; back-split-at(
                 | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1534,24,1534,31") ; DR_BREAK> SplitPos(rulename, label)
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1538,8,1549,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1538,8,1538,44")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1538,8,1538,37") ; dr-build-aggregated-change-set) => bcs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1543,8,1549,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1543,8,1543,63")
               ; rules (
                   DR_BREAK.label :+
                     BreakCS(rulename, label) -> bcs
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1546,8,1549,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1546,8,1546,10") ; !rs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1547,8,1549,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1547,8,1547,49")
               ; fetch(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1547,14,1547,48")
                   ; ChangeSet(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1547,24,1547,25") ; id
                     , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1547,28,1547,29") ; id
                     , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1547,32,1547,47")
                       ; ?Hashtable(csid)
                     )
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1549,8,1549,38")
            ; dr-define-ignoreB(|csid, label))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break", "1528,2,1550,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break", "1528,2,1550,4")
      ; fail

  dr-break-bp(|rulename) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break-bp", "1586,2,1602,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1587,4,1602,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1588,6,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1588,6,1588,39")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1588,6,1588,30")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1588,7,1588,14") ; DR_BREAK)> Label(rulename)) => label)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1589,8,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1589,8,1589,33")
               ; dr-get-rule-set(|rulename))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1590,8,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1590,8,1590,58")
               ; back-split-at(
                 | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1590,24,1590,31") ; DR_BREAK> SplitPos(rulename, label)
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1597,8,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1597,8,1597,50")
               ; ?( [ChangeSet(_, rmset, tbl)|inRs]
                  , outRs
                  ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1598,8,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1598,8,1598,24")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1598,9,1598,18") ; iset-clear)> rmset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1599,8,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1599,8,1599,27")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1599,9,1599,23") ; hashtable-clear)> tbl)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1600,8,1601,49")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1600,8,1600,20")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1600,9,1600,15") ; reverse)> inRs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1601,8,1601,49")
            ; dr-build-bp-change-set(|rmset, tbl, outRs))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break-bp", "1586,2,1602,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-break-bp", "1586,2,1602,4")
      ; fail

  dr-build-bp-change-set(|rmset, tbl, ruleset) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-bp-change-set", "1604,2,1606,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1605,4,1606,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1605,4,1605,78")
       ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1605,5,1605,23")
          ; ?rs@RuleScope(_, _)|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1605,27,1605,77")
                                ; dr-build-bp-change-set(
                                  | rmset
                                  , tbl
                                  , [rs|ruleset]
                                  )]
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1606,7,1606,8") ; [])
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-bp-change-set", "1604,2,1606,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-bp-change-set", "1604,2,1606,8")
      ; fail

  dr-build-bp-change-set(|rmset, tbl, ruleset) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-bp-change-set", "1608,2,1625,55")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1609,4,1625,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1609,4,1609,39")
       ; ?[ChangeSet(_, rmset1, tbl1)|rest])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1610,6,1625,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1610,6,1610,26")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1610,7,1610,19") ; iset-elements)> rmset1)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1611,6,1625,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1611,6,1617,7")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1611,10,1617,6")
           ; {scpid, key, value:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1612,8,1616,10")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1612,8,1612,20")
                  ; ?(scpid, key))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1613,10,1616,10")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1614,12,1615,53")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1614,12,1614,65")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1614,12,1614,56")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1614,13,1614,48")
                             ; dr-lookup-rule-in-scope(|key, scpid))> ruleset) => value)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1615,14,1615,53")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1615,15,1615,49")
                       ; hashtable-put(|(scpid, key), value))> tbl
                 )
             }
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1618,6,1625,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1618,6,1618,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1618,7,1618,20") ; hashtable-keys)> tbl1)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1619,6,1625,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1619,6,1624,7")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1619,10,1624,6")
           ; {scpid, key, value:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1620,8,1623,43")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1620,8,1620,20")
                  ; ?(scpid, key))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1621,11,1623,42")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1621,11,1621,64")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1621,11,1621,55")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1621,12,1621,47")
                         ; dr-lookup-rule-in-scope(|key, scpid))> ruleset) => value
                  < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1622,13,1622,52")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1622,14,1622,48")
                        ; hashtable-put(|(scpid, key), value))> tbl
                  + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1623,13,1623,42")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1623,14,1623,36")
                        ; iset-add(|(scpid, key)))> rmset)
             }
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1625,6,1625,55")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1625,7,1625,50")
        ; dr-build-bp-change-set(|rmset, tbl, ruleset))> rest
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-bp-change-set", "1608,2,1625,55")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-bp-change-set", "1608,2,1625,55")
      ; fail

  dr-continue(|rulename) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-continue", "1627,2,1628,52")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1628,4,1628,52")
    ; dr-continue(
      | rulename
      , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1628,28,1628,35") ; DR_BREAK> Label(rulename)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-continue", "1627,2,1628,52")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-continue", "1627,2,1628,52")
      ; fail

  dr-continue(|rulename, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-continue", "1630,2,1651,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1631,4,1651,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1632,6,1650,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1632,6,1632,37")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1632,6,1632,31")
                  ; dr-get-rule-set(|rulename)) => rs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1636,8,1650,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1636,8,1636,58")
               ; back-split-at(
                 | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1636,24,1636,31") ; DR_BREAK> SplitPos(rulename, label)
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1640,8,1650,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1640,8,1640,44")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1640,8,1640,37") ; dr-build-aggregated-change-set) => ccs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1645,8,1650,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1645,8,1645,66")
               ; rules (
                   DR_BREAK.label :+
                     ContinueCS(rulename, label) -> ccs
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1648,8,1650,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1648,8,1648,10") ; !rs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1649,8,1650,38")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1649,8,1649,49")
               ; fetch(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1649,14,1649,48")
                   ; ChangeSet(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1649,24,1649,25") ; id
                     , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1649,28,1649,29") ; id
                     , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1649,32,1649,47")
                       ; ?Hashtable(csid)
                     )
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1650,8,1650,38")
            ; dr-define-ignoreC(|csid, label))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-continue", "1630,2,1651,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-continue", "1630,2,1651,4")
      ; fail

  dr-build-aggregated-change-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-aggregated-change-set", "1659,2,1690,11")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1662,4,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1662,4,1662,78")
       ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1662,5,1662,13") ; ?sourceRs
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1662,16,1662,77")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1662,16,1662,34") ; dr-start-change-set) => rs@[aggCs@ChangeSet(_, rmset, tbl)|_]
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1665,6,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1665,6,1668,15")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1665,7,1668,6")
           ; reverse-map(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1666,8,1667,40")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1666,8,1666,19")
                  ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1666,11,1666,12") ; id>|rs])
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1667,10,1667,40")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1667,14,1667,39")
                   ; dr-commit-change-set(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1667,35,1667,38") ; fail
                     )
                 )
             ))> sourceRs)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1671,6,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1671,6,1671,63")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1671,6,1671,53")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1671,7,1671,44")
              ; filter(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1671,14,1671,43")
                  ; ?RuleScope(
                       _
                     , Hashtable(
                         <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1671,39,1671,40") ; id>
                       )
                     )
                ))> sourceRs) => scpids)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1675,6,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1675,6,1675,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1675,7,1675,19") ; iset-elements)> rmset)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1676,6,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1676,6,1679,7")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1676,10,1679,6")
           ; {k, scpid:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1677,8,1678,64")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1677,8,1677,20")
                  ; ?k@(scpid, _))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,10,1678,64")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,14,1678,63")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,14,1678,39")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,15,1678,32")
                          ; fetch-elem(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,26,1678,31") ; ?scpid
                            ))> scpids)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,42,1678,63")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1678,43,1678,57")
                       ; iset-remove(|k))> rmset
                 )
             }
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1683,6,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1683,6,1683,24")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1683,7,1683,20") ; hashtable-keys)> tbl)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1684,6,1690,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1684,6,1687,7")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1684,10,1687,6")
           ; {k, scpid:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1685,8,1686,67")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1685,8,1685,20")
                  ; ?k@(scpid, _))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,10,1686,67")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,14,1686,66")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,14,1686,39")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,15,1686,32")
                          ; fetch-elem(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,26,1686,31") ; ?scpid
                            ))> scpids)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,42,1686,66")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1686,43,1686,62")
                       ; hashtable-remove(|k))> tbl
                 )
             }
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1690,6,1690,11")
    ; !aggCs
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-aggregated-change-set", "1659,2,1690,11")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-build-aggregated-change-set", "1659,2,1690,11")
      ; fail


strategies
  dr-init-exception-block(has-finally|catch-tags, rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-init-exception-block", "1694,2,1704,16")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1695,4,1704,16")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1695,10,1704,15")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1695,11,1704,5")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1695,15,1704,4")
                    ; {rulename, tb:
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1696,6,1703,37")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1696,6,1696,14") ; ?rulename)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1697,8,1703,37")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1697,8,1701,64")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1697,8,1701,58")
                              ; !TryBlock(
                                   <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1698,11,1698,44")
                                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1698,11,1698,36")
                                       ; dr-get-rule-set(|rulename))
                                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1698,39,1698,44")
                                    ; length>
                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1699,13,1699,15") ; new>
                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1700,13,1700,36")
                                    ; map(
                                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1700,17,1700,35")
                                        ; !Catch(
                                             <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1700,25,1700,27") ; new>
                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1700,32,1700,33") ; id>
                                           )
                                      )> catch-tags
                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1701,13,1701,56")
                                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1701,13,1701,23") ; has-finally
                                       < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1701,27,1701,41")
                                         ; !Finally(
                                              <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1701,37,1701,39") ; new>
                                            )
                                       + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1701,45,1701,56")
                                         ; !Finally(""))>
                                 )) => tb)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1702,8,1703,37")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1702,8,1702,55")
                           ; rules ( DR_EXCEPTION :+
                                       Structure(rulename) -> tb ))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1703,8,1703,37")
                        ; dr-start-change-set(|rulename)
                      }
                  ))> rulenames)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-init-exception-block", "1694,2,1704,16")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-init-exception-block", "1694,2,1704,16")
      ; fail

  dr-throw(eq-test|tag, rulename) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-throw", "1706,2,1715,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1707,4,1715,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1708,6,1714,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1708,6,1708,67")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1708,6,1708,45")
                  ; get-matching-id(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1708,22,1708,28") ; eq-test
                    | tag
                    , rulename
                    )) => (pos, ID, catchID))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1709,8,1714,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1709,8,1709,39")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1709,8,1709,33")
                  ; dr-get-rule-set(|rulename)) => rs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1710,8,1714,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1710,8,1710,26")
               ; back-split-at(|pos))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1711,8,1714,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1711,8,1711,44")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1711,8,1711,37") ; dr-build-aggregated-change-set) => tcs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1712,8,1714,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1712,8,1712,69")
               ; rules (
                   DR_EXCEPTION :+
                     ThrowCS(rulename, ID) -> (tcs, catchID)
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,8,1714,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,8,1713,53")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,9,1713,50")
                   ; fetch(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,15,1713,49")
                       ; ChangeSet(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,25,1713,26") ; id
                         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,29,1713,30") ; id
                         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1713,33,1713,48")
                           ; ?Hashtable(csid)
                         )
                     ))> rs)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1714,8,1714,31")
            ; dr-define-ignoreT(|csid))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-throw", "1706,2,1715,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-throw", "1706,2,1715,4")
      ; fail

  get-matching-id(eq-test|tag, rulename) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "get-matching-id", "1717,2,1731,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1718,4,1731,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1718,5,1718,50")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1718,5,1718,43")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1718,6,1718,23") ; bagof-DR_EXCEPTION)> Structure(rulename)
          <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1718,48,1718,50")
             ; ![]))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1719,6,1731,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1719,6,1725,6")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1720,8,1724,82")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1720,8,1723,20")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1720,8,1723,9")
                     ; fetch-elem(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1720,19,1723,8")
                         ; {pos, catches:
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1721,10,1722,91")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1721,10,1721,38")
                                ; ?TryBlock(pos, _, catches, _))
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,12,1722,91")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,13,1722,83")
                                 ; fetch-elem(
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,24,1722,82")
                                     ; {cID, ctag:
                                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,37,1722,81")
                                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,37,1722,53")
                                            ; ?Catch(cID, ctag))
                                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,56,1722,81")
                                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,56,1722,75")
                                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,57,1722,63") ; eq-test)> (tag, ctag))
                                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1722,78,1722,81")
                                         ; !cID
                                       }
                                   ))> catches
                           }
                       )) => catchID
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1724,11,1724,82")
                     ; fatal-err(|"dr-throw: Thrown exception does not match any catch clause"))))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1726,6,1731,7")
    ; fetch-elem(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1726,17,1731,6")
        ; {pos, catches, fID:
            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1727,8,1730,30")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1727,8,1727,47")
               ; ?TryBlock(pos, _, catches, Finally(fID)))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,10,1730,30")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,11,1729,37")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,11,1728,90")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,12,1728,82")
                      ; fetch-elem(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,23,1728,81")
                          ; {cID, ctag:
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,36,1728,80")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,36,1728,52")
                                 ; ?Catch(cID, ctag))
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,55,1728,80")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,55,1728,74")
                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,56,1728,62") ; eq-test)> (tag, ctag))
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1728,77,1728,80")
                              ; !cID
                            }
                        ))> catches
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1729,14,1729,37")
                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1729,14,1729,31")
                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1729,15,1729,21")
                            ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1729,19,1729,20") ; eq))> (fID, ""))
                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1729,34,1729,37")
                     ; !fID))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1730,10,1730,30")
            ; !( pos
               , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1730,18,1730,19") ; id>
               , catchID
               )
          }
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "get-matching-id", "1717,2,1731,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "get-matching-id", "1717,2,1731,7")
      ; fail

  get-matching-id(|catchID, rulename) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "get-matching-id", "1733,2,1741,98")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1734,4,1741,98")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1734,4,1740,7")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1734,5,1734,50")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1734,5,1734,43")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1734,6,1734,23") ; bagof-DR_EXCEPTION)> Structure(rulename)
             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1734,48,1734,50")
                ; ![]))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1735,6,1740,7")
       ; fetch-elem(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1735,17,1740,6")
           ; {pos, catches, fID:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1736,8,1739,21")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1736,8,1736,47")
                  ; ?TryBlock(pos, _, catches, Finally(fID)))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,10,1739,21")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,11,1738,37")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,11,1737,59")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,12,1737,51")
                         ; fetch-elem(
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,23,1737,50")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,23,1737,40")
                                ; ?Catch(catchID, _))
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1737,43,1737,50")
                             ; !catchID
                           ))> catches
                     <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1738,14,1738,37")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1738,14,1738,31")
                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1738,15,1738,21")
                               ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1738,19,1738,20") ; eq))> (fID, ""))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1738,34,1738,37")
                        ; !fID))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1739,10,1739,21")
               ; !( pos
                  , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1739,18,1739,19") ; id>
                  )
             }
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1741,9,1741,98")
          ; fatal-err(|"dr-complete-finally: Could not forward exception due to missing catch clause"))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "get-matching-id", "1733,2,1741,98")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "get-matching-id", "1733,2,1741,98")
      ; fail

  dr-complete-catch(merge, s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch", "1743,2,1789,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1744,4,1789,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1744,4,1744,8") ; ?term)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1746,6,1789,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1746,6,1760,24")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1746,6,1760,17")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1746,7,1760,7")
              ; map(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1746,11,1760,6")
                  ; {rulename, cID, cs, rs, hd, tl:
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1747,8,1759,12")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1747,8,1747,16") ; ?rulename)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1748,10,1759,12")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1748,11,1749,140")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1748,11,1748,85")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1748,11,1748,43")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1748,12,1748,23") ; DR_EXCEPTION)> Structure(rulename)) => TryBlock(
                                                                                                                                                                          _
                                                                                                                                                                        , _
                                                                                                                                                                        , [Catch(cID, _)|_]
                                                                                                                                                                        , _
                                                                                                                                                                        )
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1749,14,1749,140")
                               ; fatal-err(|"dr-complete-catch was called when no catch clause was active or when a finished exception block was not completed")))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1750,10,1759,12")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1750,11,1751,98")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1750,11,1750,68")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1750,11,1750,36")
                               ; dr-get-rule-set(|rulename)) => [cs@ChangeSet(_, _, _)|rs]
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1751,14,1751,98")
                               ; fatal-err(|"dr-complete-catch was not called in a proper exception handling context")))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1752,10,1759,12")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1752,10,1752,51")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1752,11,1752,28") ; bagof-DR_EXCEPTION)> ThrowCS(rulename, cID))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1753,10,1759,12")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1753,10,1758,12")
                         ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1753,13,1753,27")
                              ; ?[(hd, _)|tl] then
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1754,12,1755,72")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1754,12,1754,69")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1754,13,1754,38")
                                    ; dr-set-rule-set(|rulename))> [<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1754,42,1754,60") ; dr-clone-change-set> hd|rs])
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,14,1755,72")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,15,1755,69")
                                 ; map(
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,19,1755,68")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,19,1755,38")
                                        ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,22,1755,31")
                                             ; ?( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,25,1755,26") ; id>
                                                , _
                                                )>|rs])
                                     ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,41,1755,68")
                                     ; try(
                                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,45,1755,67")
                                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,46,1755,50") ; merge)> ( rulename
                                                                                                                                                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1755,64,1755,65") ; id>
                                                                                                                                                   )
                                       )
                                   ))> tl
                           else
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1757,12,1757,69")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1757,13,1757,38")
                                 ; dr-set-rule-set(|rulename))> [<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1757,42,1757,60") ; dr-clone-change-set> cs|rs]
                           end)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1759,10,1759,12")
                      ; !cs
                    }
                ))> rulenames) => css)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1762,6,1789,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1762,6,1771,6")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1762,14,1762,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1762,14,1762,20")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1762,15,1762,15") ; s)> term) => e
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1763,8,1770,11")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1763,8,1763,28")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1763,9,1763,11") ; zip)> (css, rulenames))
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1764,10,1770,11")
           ; map(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1764,14,1770,10")
               ; {cs, rulename, rs:
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1765,12,1769,39")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1765,12,1765,26")
                      ; ?(cs, rulename))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1766,14,1769,39")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1766,14,1766,39")
                      ; dr-get-rule-set(|rulename))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1767,14,1769,39")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1767,14,1767,42")
                      ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1767,15,1767,35") ; dr-destroy-change-set|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1767,39,1767,41") ; ?rs])
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1768,14,1769,39")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1768,14,1768,23")
                      ; ![cs|rs])
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1769,14,1769,39")
                   ; dr-set-rule-set(|rulename)
                 }
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1773,6,1789,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1773,6,1773,26")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1773,7,1773,9") ; zip)> (css, rulenames))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1774,6,1789,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1774,6,1787,7")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1774,10,1787,6")
           ; {cs, rulename, pos, ID, cID, catches, fin, fID, cs', rs:
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1775,8,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1775,8,1775,22")
                  ; ?(cs, rulename))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1776,10,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1776,11,1777,70")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1776,11,1776,114")
                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1776,11,1776,48")
                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1776,12,1776,28") ; once-DR_EXCEPTION)> Structure(rulename)) => TryBlock(
                                                                                                                                                                        pos
                                                                                                                                                                      , ID
                                                                                                                                                                      , [Catch(cID, _)|catches]
                                                                                                                                                                      , fin@Finally(fID)
                                                                                                                                                                      )
                     <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1777,14,1777,70")
                        ; fatal-err(|"dr-complete-catch: Unexpected failure here!")))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1778,10,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1778,10,1778,86")
                  ; rules (
                      DR_EXCEPTION :+
                        Structure(rulename) -> TryBlock(pos, ID, catches, fin)
                    ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1779,10,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1779,10,1779,54")
                  ; rules ( DR_EXCEPTION :-
                              ThrowCS(rulename, cID) ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1780,10,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1780,11,1781,77")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1780,11,1780,69")
                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1780,11,1780,36")
                        ; dr-get-rule-set(|rulename)) => [cs'@ChangeSet(_, _, _)|rs]
                     <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1781,14,1781,77")
                        ; fatal-err(|"dr-complete-catch: A change set was expected here!")))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1782,10,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1782,11,1784,68")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1782,11,1782,23")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1782,12,1782,13") ; eq)> (fID, "")
                     < s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1783,13,1783,67")
                       ; rules (
                           DR_EXCEPTION :+
                             ExceptionCS(rulename, ID) -> cs'
                         )
                     + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1784,13,1784,68")
                       ; rules (
                           DR_EXCEPTION :+
                             ExceptionCS(rulename, fID) -> cs'
                         )))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1785,10,1786,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1785,10,1785,19")
                  ; ![cs|rs])
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1786,10,1786,35")
               ; dr-set-rule-set(|rulename)
             }
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1789,6,1789,7")
    ; !e
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch", "1743,2,1789,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch", "1743,2,1789,7")
      ; fail

  dr-complete-finally(merge, s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally", "1791,2,1848,7")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1792,4,1848,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1792,4,1792,8") ; ?term)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1794,6,1848,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1794,6,1813,25")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1794,6,1813,17")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1794,7,1813,7")
              ; map(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1794,11,1813,6")
                  ; {rulename, tb, fID, cs, csid, rs, tcss, hd, tl:
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1795,8,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1795,8,1795,16") ; ?rulename)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1796,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1796,11,1797,94")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1796,11,1796,87")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1796,11,1796,48")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1796,12,1796,28") ; once-DR_EXCEPTION)> Structure(rulename)) => tb@TryBlock(_, _, [], Finally(fID))
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1797,14,1797,94")
                               ; fatal-err(|"dr-complete-finally was called when a catch clause was still active")))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1798,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1798,10,1798,110")
                         ; try(
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1798,14,1798,109")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1798,14,1798,26")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1798,15,1798,16") ; eq)> (fID, ""))
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1798,29,1798,109")
                             ; fatal-err(|"dr-complete-finally was called when a finally clause was not active")
                           ))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1799,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1799,11,1800,100")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1799,11,1799,82")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1799,11,1799,36")
                               ; dr-get-rule-set(|rulename)) => [cs@ChangeSet(_, _, Hashtable(csid))|rs]
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1800,14,1800,100")
                               ; fatal-err(|"dr-complete-finally was not called in a proper exception handling context")))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1801,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1801,10,1801,68")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1801,11,1801,59")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1801,11,1801,52")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1801,12,1801,29") ; bagof-DR_EXCEPTION)> ThrowCS(rulename, fID)
                               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1801,57,1801,59")
                                  ; ![])) => tcss)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1802,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1802,11,1802,63")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1802,11,1802,56")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1802,12,1802,29") ; bagof-DR_EXCEPTION)> ExceptionCS(rulename, fID)
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1802,61,1802,63")
                               ; ![]))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,10,1803,44")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,11,1803,14") ; conc)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,18,1803,19") ; id>
                                                                                                                                  , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,24,1803,38")
                                                                                                                                     ; map(
                                                                                                                                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,28,1803,37")
                                                                                                                                         ; ?( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1803,31,1803,32") ; id>
                                                                                                                                            , _
                                                                                                                                            )
                                                                                                                                       )> tcss
                                                                                                                                  ))
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1804,10,1812,28")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1804,10,1811,12")
                         ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1804,13,1804,51")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1804,13,1804,22")
                                 ; ?[hd|tl])
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1804,25,1804,51")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1804,26,1804,37") ; DR_EXCEPTION)> IgnoreT(csid) then
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1805,12,1807,60")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1805,12,1805,43")
                                ; dr-discard-change-set(|rulename))
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1806,14,1807,60")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1806,14,1806,71")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1806,15,1806,40")
                                    ; dr-set-rule-set(|rulename))> [<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1806,44,1806,62") ; dr-clone-change-set> hd|rs])
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,14,1807,60")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,15,1807,57")
                                 ; map(
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,19,1807,56")
                                     ; try(
                                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,23,1807,55")
                                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,24,1807,28") ; merge)> ( rulename
                                                                                                                                                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,42,1807,53")
                                                                                                                                                      ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1807,45,1807,46") ; id>|rs]>
                                                                                                                                                   )
                                       )
                                   ))> tl
                           else
                             s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1809,12,1810,56")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1809,12,1809,76")
                                ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1809,18,1809,75")
                                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1809,19,1809,44")
                                            ; dr-set-rule-set(|rulename))> [<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1809,48,1809,66") ; dr-clone-change-set> cs|rs]))
                             ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1810,14,1810,56")
                             ; map(
                                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1810,18,1810,55")
                                 ; try(
                                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1810,22,1810,54")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1810,23,1810,27") ; merge)> ( rulename
                                                                                                                                               , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1810,41,1810,52")
                                                                                                                                                  ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1810,44,1810,45") ; id>|rs]>
                                                                                                                                               )
                                   )
                               )
                           end)
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1812,10,1812,28")
                      ; !(tb, cs, rulename)
                    }
                ))> rulenames) => temp)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1815,6,1848,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1815,6,1824,6")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1815,14,1815,25")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1815,14,1815,20")
              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1815,15,1815,15") ; s)> term) => e
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1816,8,1823,14")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1816,9,1823,9")
               ; map(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1816,13,1823,8")
                   ; {tb, cs, rulename, rs:
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1817,10,1822,59")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1817,10,1817,28")
                          ; ?(tb, cs, rulename))
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1818,12,1822,59")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1818,12,1818,37")
                          ; dr-get-rule-set(|rulename))
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1819,12,1822,59")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1819,12,1819,40")
                          ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1819,13,1819,33") ; dr-destroy-change-set|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1819,37,1819,39") ; ?rs])
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1820,12,1822,59")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1820,12,1820,21")
                          ; ![cs|rs])
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1821,12,1822,59")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1821,12,1821,37")
                          ; dr-set-rule-set(|rulename))
                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1822,12,1822,59")
                       ; rules ( DR_EXCEPTION :+
                                   Structure(rulename) -> tb )
                     }
                 ))> temp
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1826,6,1848,7")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1826,6,1846,12")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1826,7,1846,7")
           ; map(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1826,11,1846,6")
               ; {rulename, pos, ID, fID, csid, rs:
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1827,8,1845,54")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1827,8,1827,58")
                      ; ?( TryBlock(
                             pos
                           , ID
                           , []
                           , Finally(fID)
                           )
                         , _
                         , rulename
                         ))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1828,10,1845,54")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1828,10,1828,89")
                      ; rules (
                          DR_EXCEPTION :+
                            Structure(rulename) -> TryBlock(
                                                     pos
                                                   , ID
                                                   , []
                                                   , Finally("")
                                                   )
                        ))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1829,10,1845,54")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1829,10,1829,58")
                      ; rules ( DR_EXCEPTION :-
                                  ExceptionCS(rulename, fID) ))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1830,10,1845,54")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1830,11,1831,79")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1830,11,1830,81")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1830,11,1830,36")
                            ; dr-get-rule-set(|rulename)) => rs@[ChangeSet(_, _, Hashtable(csid))|_]
                         <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1831,14,1831,79")
                            ; fatal-err(|"dr-complete-finally: A change set was expected here!")))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1832,10,1845,54")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1832,10,1844,10")
                      ; try(
                          s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1833,12,1843,15")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1833,12,1833,43")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1833,13,1833,29")
                                 ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1833,17,1833,28") ; DR_EXCEPTION))> IgnoreT(csid))
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1834,14,1843,15")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1834,15,1834,63")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1834,15,1834,56")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1834,16,1834,33") ; bagof-DR_EXCEPTION)> ThrowCS(rulename, fID)
                                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1834,61,1834,63")
                                   ; ![]))
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1835,14,1843,15")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1835,14,1835,28")
                             ; map(
                                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1835,18,1835,27")
                                 ; ?( _
                                    , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1835,24,1835,25") ; id>
                                    )
                               ))
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1836,14,1843,15")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1836,14,1836,21") ; make-set)
                          ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1837,14,1843,15")
                          ; map(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1837,18,1843,14")
                              ; {catchID, pos, nextID, tcs:
                                  s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1838,16,1842,83")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1838,16,1838,23") ; ?catchID)
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1839,18,1842,83")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1839,18,1839,69")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1839,18,1839,52")
                                        ; get-matching-id(|catchID, rulename)) => (pos, nextID))
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1840,18,1842,83")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1840,18,1840,40")
                                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1840,19,1840,37")
                                         ; back-split-at(|pos))> rs)
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1841,18,1842,83")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1841,18,1841,54")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1841,18,1841,47") ; dr-build-aggregated-change-set) => tcs)
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1842,18,1842,83")
                                  ; rules (
                                      DR_EXCEPTION :+
                                        ThrowCS(rulename, nextID) -> (tcs, catchID)
                                    )
                                }
                            )
                        ))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1845,10,1845,54")
                   ; rules ( DR_EXCEPTION :-
                               ThrowCS(rulename, fID) )
                 }
             ))> temp)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1848,6,1848,7")
    ; !e
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally", "1791,2,1848,7")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally", "1791,2,1848,7")
      ; fail

  dr-complete-exception-block(merge|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block", "1850,2,1869,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1851,4,1869,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1852,6,1868,17")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1852,7,1868,7")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1852,11,1868,6")
                    ; {rulename, ID, csid, rs, hd, tl:
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1853,8,1867,40")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1853,8,1853,16") ; ?rulename)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1854,10,1867,40")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1854,11,1855,172")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1854,11,1854,84")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1854,11,1854,48")
                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1854,12,1854,28") ; once-DR_EXCEPTION)> Structure(rulename)) => TryBlock(
                                                                                                                                                                                 _
                                                                                                                                                                               , ID
                                                                                                                                                                               , []
                                                                                                                                                                               , Finally("")
                                                                                                                                                                               )
                              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1855,14,1855,172")
                                 ; fatal-err(|"dr-complete-exception-block was called before completing all catch clauses (and the finally clause) or in a non-proper exception handling context")))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1856,10,1867,40")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1856,11,1857,108")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1856,11,1856,79")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1856,11,1856,36")
                                 ; dr-get-rule-set(|rulename)) => [ChangeSet(_, _, Hashtable(csid))|rs]
                              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1857,14,1857,108")
                                 ; fatal-err(|"dr-complete-exception-block was not called in a proper exception handling context")))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1858,10,1867,40")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1858,11,1858,62")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1858,11,1858,55")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1858,12,1858,29") ; bagof-DR_EXCEPTION)> ExceptionCS(rulename, ID)
                              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1858,60,1858,62")
                                 ; ![]))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1859,10,1867,40")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1859,10,1865,12")
                           ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1859,13,1859,51")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1859,13,1859,22")
                                   ; ?[hd|tl])
                                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1859,25,1859,51")
                                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1859,26,1859,37") ; DR_EXCEPTION)> IgnoreT(csid) then
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1860,12,1862,64")
                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1860,12,1860,43")
                                  ; dr-discard-change-set(|rulename))
                               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1861,14,1862,64")
                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1861,14,1861,71")
                                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1861,15,1861,40")
                                      ; dr-set-rule-set(|rulename))> [<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1861,44,1861,62") ; dr-clone-change-set> hd|rs])
                               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,14,1862,64")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,15,1862,61")
                                   ; map(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,19,1862,60")
                                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,19,1862,30")
                                          ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,22,1862,23") ; id>|rs])
                                       ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,33,1862,60")
                                       ; try(
                                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,37,1862,59")
                                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,38,1862,42") ; merge)> ( rulename
                                                                                                                                                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1862,56,1862,57") ; id>
                                                                                                                                                     )
                                         )
                                     ))> tl
                             else
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,12,1864,58")
                               ; map(
                                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,16,1864,57")
                                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,16,1864,27")
                                      ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,19,1864,20") ; id>|rs])
                                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,30,1864,57")
                                   ; try(
                                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,34,1864,56")
                                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,35,1864,39") ; merge)> ( rulename
                                                                                                                                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1864,53,1864,54") ; id>
                                                                                                                                                 )
                                     )
                                 )
                             end)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1866,10,1867,40")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1866,10,1866,57")
                           ; rules ( DR_EXCEPTION :-
                                       ExceptionCS(rulename, ID) ))
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1867,10,1867,40")
                        ; dr-commit-change-set(|rulename)
                      }
                  ))> rulenames)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block", "1850,2,1869,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block", "1850,2,1869,4")
      ; fail


strategies
  dr-transaction(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-transaction", "1873,2,1876,55")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1874,4,1876,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1874,4,1874,52")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1874,10,1874,51")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1874,11,1874,41")
                   ; map(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1874,15,1874,40")
                       ; dr-start-change-set(
                         | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1874,37,1874,38") ; id>
                         )
                     ))> rulenames))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,6,1876,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,6,1875,68")
       ; restore(
           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,14,1875,14") ; s
         , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,17,1875,67")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,23,1875,66")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,24,1875,56")
                       ; map(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,28,1875,55")
                           ; dr-discard-change-set(
                             | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1875,52,1875,53") ; id>
                             )
                         ))> rulenames)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1876,6,1876,55")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1876,12,1876,54")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1876,13,1876,44")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1876,17,1876,43")
                    ; dr-commit-change-set(
                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1876,40,1876,41") ; id>
                      )
                  ))> rulenames)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-transaction", "1873,2,1876,55")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-transaction", "1873,2,1876,55")
      ; fail


strategies
  dr-fork-and-intersect(s1, s2|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-intersect", "1887,2,1889,41")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1888,4,1889,41")
    ; dr-fork-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1888,22,1888,76")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1888,43,1888,70")
                               ; dr-intersect-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1889,23,1889,24") ; s1
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1889,27,1889,28") ; s2
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-intersect", "1887,2,1889,41")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-intersect", "1887,2,1889,41")
      ; fail

  dr-fork-and-union(s1, s2|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-union", "1894,2,1896,41")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1895,4,1896,41")
    ; dr-fork-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1895,22,1895,72")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1895,43,1895,66")
                               ; dr-union-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1896,23,1896,24") ; s1
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1896,27,1896,28") ; s2
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-union", "1894,2,1896,41")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-union", "1894,2,1896,41")
      ; fail

  dr-fork-and-intersect-union(s1, s2|rulenames1, rulenames2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-intersect-union", "1901,2,1904,54")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1902,4,1904,54")
    ; dr-fork-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1902,22,1902,76")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1902,43,1902,70")
                               ; dr-intersect-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1903,22,1903,72")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1903,43,1903,66")
                               ; dr-union-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1904,23,1904,24") ; s1
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1904,27,1904,28") ; s2
      | rulenames1
      , rulenames2
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-intersect-union", "1901,2,1904,54")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fork-and-intersect-union", "1901,2,1904,54")
      ; fail


strategies
  dr-fix-and-intersect(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect", "1915,2,1917,35")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1916,4,1917,35")
    ; dr-fix-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1916,21,1916,75")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1916,42,1916,69")
                               ; dr-intersect-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1917,22,1917,22") ; s
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect", "1915,2,1917,35")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect", "1915,2,1917,35")
      ; fail

  dr-fix-and-intersect(s|rulenames, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect", "1919,2,1921,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1920,4,1921,42")
    ; dr-fix-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1920,21,1920,75")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1920,42,1920,69")
                               ; dr-intersect-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1921,22,1921,22") ; s
      | rulenames
      , label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect", "1919,2,1921,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect", "1919,2,1921,42")
      ; fail

  dr-fix-and-union(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-union", "1926,2,1928,35")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1927,4,1928,35")
    ; dr-fix-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1927,21,1927,71")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1927,42,1927,65")
                               ; dr-union-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1928,22,1928,22") ; s
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-union", "1926,2,1928,35")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-union", "1926,2,1928,35")
      ; fail

  dr-fix-and-union(s|rulenames, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-union", "1930,2,1932,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1931,4,1932,42")
    ; dr-fix-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1931,21,1931,71")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1931,42,1931,65")
                               ; dr-union-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1932,22,1932,22") ; s
      | rulenames
      , label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-union", "1930,2,1932,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-union", "1930,2,1932,42")
      ; fail

  dr-fix-and-intersect-union(s|rulenames1, rulenames2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect-union", "1937,2,1940,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1938,4,1940,48")
    ; dr-fix-and-merge(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1938,22,1938,76")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1938,43,1938,70")
                               ; dr-intersect-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1939,22,1939,72")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1939,43,1939,66")
                               ; dr-union-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1940,22,1940,22") ; s
      | rulenames1
      , rulenames2
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect-union", "1937,2,1940,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fix-and-intersect-union", "1937,2,1940,48")
      ; fail


strategies
  dr-label-intersect(s|rulenames, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-intersect", "1959,2,1961,34")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1960,4,1961,34")
    ; dr-label(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1960,13,1960,67")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1960,34,1960,61")
                               ; dr-intersect-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1961,14,1961,14") ; s
      | rulenames
      , label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-intersect", "1959,2,1961,34")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-intersect", "1959,2,1961,34")
      ; fail

  dr-label-union(s|rulenames, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-union", "1974,2,1976,34")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1975,4,1976,34")
    ; dr-label(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1975,13,1975,63")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1975,34,1975,57")
                               ; dr-union-symm(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1976,14,1976,14") ; s
      | rulenames
      , label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-union", "1974,2,1976,34")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-label-union", "1974,2,1976,34")
      ; fail


strategies
  dr-complete-catch-intersect(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch-intersect", "1980,2,1982,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1981,4,1982,36")
    ; dr-complete-catch(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1981,22,1981,76")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1981,43,1981,70")
                               ; dr-intersect-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1982,23,1982,23") ; s
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch-intersect", "1980,2,1982,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch-intersect", "1980,2,1982,36")
      ; fail

  dr-complete-finally-intersect(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally-intersect", "1984,2,1986,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1985,4,1986,38")
    ; dr-complete-finally(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1985,24,1985,78")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1985,45,1985,72")
                               ; dr-intersect-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1986,25,1986,25") ; s
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally-intersect", "1984,2,1986,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally-intersect", "1984,2,1986,38")
      ; fail

  dr-complete-exception-block-intersect(|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block-intersect", "1988,2,1990,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1989,4,1990,42")
    ; dr-complete-exception-block(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1989,32,1989,86")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1989,53,1989,80")
                               ; dr-intersect-with(|rulename)> rs \
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block-intersect", "1988,2,1990,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block-intersect", "1988,2,1990,42")
      ; fail

  dr-complete-catch-union(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch-union", "1994,2,1996,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1995,4,1996,36")
    ; dr-complete-catch(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1995,22,1995,72")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1995,43,1995,66")
                               ; dr-union-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1996,23,1996,23") ; s
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch-union", "1994,2,1996,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-catch-union", "1994,2,1996,36")
      ; fail

  dr-complete-finally-union(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally-union", "1998,2,2000,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1999,4,2000,38")
    ; dr-complete-finally(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1999,24,1999,74")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "1999,45,1999,68")
                               ; dr-union-with(|rulename)> rs \
      , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2000,25,2000,25") ; s
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally-union", "1998,2,2000,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-finally-union", "1998,2,2000,38")
      ; fail

  dr-complete-exception-block-union(|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block-union", "2002,2,2004,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2003,4,2004,42")
    ; dr-complete-exception-block(
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2003,32,2003,82")
        ; \ (rulename, rs) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2003,53,2003,76")
                               ; dr-union-with(|rulename)> rs \
      | rulenames
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block-union", "2002,2,2004,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-complete-exception-block-union", "2002,2,2004,42")
      ; fail


strategies
  dr-fold-and-intersect(empty, hd, tl : ( a -> a ) * a -> a|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fold-and-intersect", "2014,2,2020,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2015,4,2020,6")
    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2015,7,2015,11") ; empty then
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2015,18,2015,19") ; id
      else
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,6,2019,58")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,6,2017,69")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,12,2017,68")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,12,2017,61")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,13,2017,50")
                          ; map(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,17,2017,49")
                              ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,20,2017,21") ; id>
                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,26,2017,47")
                                    ; dr-get-rule-set(
                                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2017,44,2017,45") ; id>
                                      )>
                                 )
                            ))> rulenames) => rs0))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2018,8,2019,58")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2018,8,2018,60")
           ; dr-fold-and-intersect(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2018,30,2018,34") ; empty
             , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2018,37,2018,38") ; hd
             , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2018,41,2018,42") ; tl
             | rulenames
             , rs0
             ))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2019,8,2019,58")
        ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2019,14,2019,57")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2019,15,2019,46")
                    ; map(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2019,19,2019,45")
                        ; dr-commit-change-set(
                          | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2019,42,2019,43") ; id>
                          )
                      ))> rulenames)
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fold-and-intersect", "2014,2,2020,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fold-and-intersect", "2014,2,2020,6")
      ; fail

  dr-fold-and-intersect(empty, hd, tl : ( a -> a ) * a -> a|rulenames, rs0) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fold-and-intersect", "2022,2,2038,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2023,4,2038,6")
    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2023,7,2023,11") ; empty then
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2023,18,2023,19") ; id
      else
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2025,6,2037,8")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2025,6,2029,6")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2026,8,2028,48")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2026,9,2028,43")
                       ; map(
                           s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2026,13,2028,42")
                           ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2026,14,2028,41")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2026,14,2026,29")
                                 ; ?( rulename
                                    , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2026,26,2026,27") ; id>
                                    ))
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2027,16,2028,41")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2027,16,2027,34") ; dr-start-change-set)
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2028,16,2028,41")
                              ; dr-set-rule-set(|rulename)}
                         ))> rs0))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2030,8,2037,8")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2030,8,2030,9") ; hd)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2031,8,2037,8")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2031,8,2033,8")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,10,2032,66")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,10,2032,59")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,11,2032,48")
                          ; map(
                              s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,15,2032,47")
                              ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,18,2032,19") ; id>
                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,24,2032,45")
                                    ; dr-get-rule-set(
                                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2032,42,2032,43") ; id>
                                      )>
                                 )
                            ))> rulenames) => rs1))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2034,8,2037,8")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2034,8,2034,64")
           ; tl(
               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2034,11,2034,63")
               ; dr-fold-and-intersect(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2034,33,2034,37") ; empty
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2034,40,2034,41") ; hd
                 , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2034,44,2034,45") ; tl
                 | rulenames
                 , rs0
                 )
             ))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2035,8,2037,8")
        ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,10,2036,69")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,11,2036,64")
                    ; map(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,15,2036,63")
                        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,16,2036,62")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,16,2036,32")
                              ; ?( rulename
                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,29,2036,30") ; id>
                                 ))
                           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2036,35,2036,62")
                           ; dr-intersect-with(|rulename)}
                      ))> rs1)
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fold-and-intersect", "2022,2,2038,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-fold-and-intersect", "2022,2,2038,6")
      ; fail

  dr-map-and-intersect(s|rulenames) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-map-and-intersect", "2046,2,2049,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2047,4,2049,6")
    ; let tl(s') =
            s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "tl", "2047,8,2047,25")
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2047,17,2047,25")
            ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2047,18,2047,19") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2047,23,2047,24") ; s']
            < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "tl", "2047,8,2047,25")
            + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "tl", "2047,8,2047,25")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2048,8,2048,56")
        ; dr-fold-and-intersect(
            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2048,30,2048,31") ; []
          , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2048,34,2048,39")
            ; [s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2048,35,2048,35") ; s|s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2048,37,2048,38") ; id]
          , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2048,42,2048,43") ; tl
          | rulenames
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-map-and-intersect", "2046,2,2049,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-map-and-intersect", "2046,2,2049,6")
      ; fail


strategies
  dr-define-ignoreB(|csid, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreB", "2053,2,2054,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2054,4,2054,49")
    ; rules (
        DR_BREAK.label :
          IgnoreB(csid) -> label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreB", "2053,2,2054,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreB", "2053,2,2054,49")
      ; fail

  dr-define-ignoreC(|csid, label) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreC", "2056,2,2057,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2057,4,2057,49")
    ; rules (
        DR_BREAK.label :
          IgnoreC(csid) -> label
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreC", "2056,2,2057,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreC", "2056,2,2057,49")
      ; fail

  dr-define-ignoreT(|csid) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreT", "2059,2,2060,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2060,4,2060,38")
    ; rules ( DR_EXCEPTION :
                IgnoreT(csid) )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreT", "2059,2,2060,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-define-ignoreT", "2059,2,2060,38")
      ; fail


strategies
  dr-eq-rule-sets =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-eq-rule-sets", "2064,2,2074,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2065,2,2074,4")
    ; let rseq =
            s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rseq", "2065,6,2072,34")
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2066,8,2072,34")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2066,8,2068,34")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2066,8,2066,54")
                  ; ?( RuleScope(lbl1, tbl1)
                     , RuleScope(lbl2, tbl2)
                     ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2067,8,2068,34")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2067,8,2067,28")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2067,9,2067,22")
                      ; iset-eq(|lbl2))> lbl1)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2068,8,2068,34")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2068,9,2068,20") ; hashtable-eq)> (tbl1, tbl2)
               + s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2069,8,2072,34")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2069,8,2069,70")
                    ; ?( ChangeSet(lbl1, rmset1, tbl1)
                       , ChangeSet(lbl2, rmset2, tbl2)
                       ))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2070,8,2072,34")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2070,8,2070,28")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2070,9,2070,22")
                        ; iset-eq(|lbl2))> lbl1)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2071,8,2072,34")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2071,8,2071,32")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2071,9,2071,24")
                        ; iset-eq(|rmset2))> rmset1)
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2072,8,2072,34")
                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2072,9,2072,20") ; hashtable-eq)> (tbl1, tbl2))
            < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rseq", "2065,6,2072,34")
            + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "rseq", "2065,6,2072,34")
              ; fail
      in
        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2073,6,2073,21")
        ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2073,12,2073,20")
                ; zip(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2073,16,2073,19") ; rseq
                  ))
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-eq-rule-sets", "2064,2,2074,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-eq-rule-sets", "2064,2,2074,4")
      ; fail


strategies
  dr-debug-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-debug-rule-set", "2078,2,2078,56")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2078,29,2078,56")
    ; dr-debug-rule-set(|name, "")
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-debug-rule-set", "2078,2,2078,56")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-debug-rule-set", "2078,2,2078,56")
      ; fail

  dr-debug-rule-set(|name, msg) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-debug-rule-set", "2080,2,2085,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2081,4,2085,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2082,8,2084,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2082,9,2082,31")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2082,9,2082,18")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2082,9,2082,12") ; !msg) => ""
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2082,23,2082,31")
                     ; say(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2082,27,2082,30") ; !msg
                       )))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2083,8,2084,31")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2083,8,2083,37")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2083,9,2083,31")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2083,15,2083,30")
                       ; !"Ruleset for: "
                     ))> name)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2084,8,2084,31")
            ; dr-print-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-debug-rule-set", "2080,2,2085,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-debug-rule-set", "2080,2,2085,4")
      ; fail

  dr-print-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set", "2087,2,2091,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2088,4,2091,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2089,6,2090,24")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2089,6,2089,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2090,8,2090,24")
            ; dr-print-rule-set)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set", "2087,2,2091,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set", "2087,2,2091,4")
      ; fail

  dr-print-rule-sets(|names) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-sets", "2093,2,2096,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2094,4,2096,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2095,6,2095,49")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2095,7,2095,42")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2095,11,2095,41")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2095,11,2095,15") ; debug)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2095,18,2095,41")
                    ; dr-print-rule-set(
                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2095,38,2095,39") ; id>
                      )
                  ))> names)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-sets", "2093,2,2096,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-sets", "2093,2,2096,4")
      ; fail

  dr-print-rule-set-msg(|msg) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set-msg", "2098,2,2101,78")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,4,2101,78")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,4,2099,76")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,10,2099,75")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,10,2099,19")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,10,2099,13") ; !msg) => ""
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,24,2099,75")
                     ; say(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,28,2099,74")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2099,29,2099,42") ; concat-strings)> ["\n--- BEGIN(", msg, ") ---"]
                       ))))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2100,6,2101,78")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2100,6,2100,22") ; dr-print-rule-set)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,6,2101,78")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,12,2101,77")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,12,2101,21")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,12,2101,15") ; !msg) => ""
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,26,2101,77")
                  ; say(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,30,2101,76")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2101,31,2101,44") ; concat-strings)> ["--- END  (", msg, ") ---\n"]
                    )))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set-msg", "2098,2,2101,78")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set-msg", "2098,2,2101,78")
      ; fail

  dr-print-rule-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set", "2103,2,2104,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2104,4,2104,29")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2104,10,2104,28")
            ; map(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2104,14,2104,27") ; dr-print-scope
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set", "2103,2,2104,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-rule-set", "2103,2,2104,29")
      ; fail

  dr-print-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-scope", "2106,2,2117,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2107,4,2117,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2107,4,2107,28")
       ; ?RuleScope(labelset, tbl))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2108,4,2117,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2109,6,2116,9")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2109,6,2109,10") ; debug)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2110,6,2116,9")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2110,6,2110,49")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2110,7,2110,39")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2110,7,2110,19") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2110,22,2110,39")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2110,28,2110,38")
                       ; !"labels: "
                     ))> labelset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2111,6,2116,9")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2111,6,2111,25")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2111,7,2111,20") ; hashtable-keys)> tbl)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2112,12,2116,9")
            ; map(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2112,16,2115,17")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2112,16,2112,65")
                   ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2112,22,2112,64")
                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2112,23,2112,30") ; fprintnl)> ( stderr()
                                                                                                                                        , [ "  "
                                                                                                                                          , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2112,51,2112,52") ; id>
                                                                                                                                          , " -> "
                                                                                                                                          ]
                                                                                                                                        )))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2113,12,2115,17")
                ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2113,18,2114,60")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2113,18,2113,53")
                           ; \ key -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2113,28,2113,46")
                                       ; hashtable-get(|key)> tbl \)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2114,20,2114,60")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2114,24,2114,59")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2114,25,2114,32") ; fprintnl)> ( stderr()
                                                                                                                                         , [ "    "
                                                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2114,55,2114,56") ; id>
                                                                                                                                           ]
                                                                                                                                         )
                          ))
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-scope", "2106,2,2117,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-scope", "2106,2,2117,4")
      ; fail

  dr-print-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-scope", "2119,2,2139,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2120,4,2139,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2120,4,2120,51")
       ; ?ChangeSet(
            labelset
          , rmset
          , tbl@Hashtable(csid)
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2121,4,2139,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2122,6,2138,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2122,6,2122,10") ; debug)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2123,6,2138,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2123,6,2123,49")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2123,7,2123,39")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2123,7,2123,19") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2123,22,2123,39")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2123,28,2123,38")
                       ; !"labels: "
                     ))> labelset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2124,6,2138,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2124,6,2124,47")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2124,7,2124,40")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2124,7,2124,19") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2124,22,2124,40")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2124,28,2124,39")
                       ; !"removed: "
                     ))> rmset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2125,6,2138,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2125,6,2125,25")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2125,7,2125,20") ; hashtable-keys)> tbl)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,6,2138,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,6,2130,9")
               ; map(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,10,2129,17")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,10,2126,58")
                      ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,16,2126,57")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,17,2126,24") ; fprintnl)> ( stderr()
                                                                                                                                           , [ "  "
                                                                                                                                             , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2126,45,2126,46") ; id>
                                                                                                                                             , " -> "
                                                                                                                                             ]
                                                                                                                                           )))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2127,12,2129,17")
                   ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2127,18,2128,60")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2127,18,2127,53")
                              ; \ key -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2127,28,2127,46")
                                          ; hashtable-get(|key)> tbl \)
                           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2128,20,2128,60")
                           ; map(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2128,24,2128,59")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2128,25,2128,32") ; fprintnl)> ( stderr()
                                                                                                                                            , [ "    "
                                                                                                                                              , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2128,55,2128,56") ; id>
                                                                                                                                              ]
                                                                                                                                            )
                             ))
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2131,6,2138,6")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2131,6,2134,6")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2132,8,2133,107")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2132,8,2132,40")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2132,8,2132,30")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2132,9,2132,16") ; DR_BREAK)> IgnoreB(csid)) => blabel)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2133,10,2133,107")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2133,11,2133,18") ; fprintnl)> ( stderr()
                                                                                                                                , ["Change set is marked as ignored (due to break) up to label ", blabel, "."]
                                                                                                                                )
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2135,6,2138,6")
            ; try(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2136,8,2137,110")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2136,8,2136,40")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2136,8,2136,30")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2136,9,2136,16") ; DR_BREAK)> IgnoreC(csid)) => clabel)
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2137,10,2137,110")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2137,11,2137,18") ; fprintnl)> ( stderr()
                                                                                                                             , ["Change set is marked as ignored (due to continue) up to label ", clabel, "."]
                                                                                                                             )
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-scope", "2119,2,2139,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-print-scope", "2119,2,2139,4")
      ; fail


strategies
  dr-friendly-debug-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-debug-rule-set", "2143,2,2143,74")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2143,38,2143,74")
    ; dr-friendly-debug-rule-set(|name, "")
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-debug-rule-set", "2143,2,2143,74")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-debug-rule-set", "2143,2,2143,74")
      ; fail

  dr-friendly-debug-rule-set(|name, msg) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-debug-rule-set", "2145,2,2150,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2146,4,2150,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2147,8,2149,40")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2147,9,2147,31")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2147,9,2147,18")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2147,9,2147,12") ; !msg) => ""
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2147,23,2147,31")
                     ; say(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2147,27,2147,30") ; !msg
                       )))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2148,8,2149,40")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2148,8,2148,37")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2148,9,2148,31")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2148,15,2148,30")
                       ; !"Ruleset for: "
                     ))> name)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2149,8,2149,40")
            ; dr-friendly-print-rule-set(|name))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-debug-rule-set", "2145,2,2150,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-debug-rule-set", "2145,2,2150,4")
      ; fail

  dr-friendly-print-rule-set(|name) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set", "2152,2,2156,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2153,4,2156,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2154,6,2155,33")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2154,6,2154,27")
               ; dr-get-rule-set(|name))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2155,8,2155,33")
            ; dr-friendly-print-rule-set)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set", "2152,2,2156,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set", "2152,2,2156,4")
      ; fail

  dr-friendly-print-rule-sets(|names) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-sets", "2158,2,2161,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2159,4,2161,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2160,6,2160,58")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2160,7,2160,51")
                ; map(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2160,11,2160,50")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2160,11,2160,15") ; debug)
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2160,18,2160,50")
                    ; dr-friendly-print-rule-set(
                      | <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2160,47,2160,48") ; id>
                      )
                  ))> names)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-sets", "2158,2,2161,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-sets", "2158,2,2161,4")
      ; fail

  dr-friendly-print-rule-set-msg(|msg) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set-msg", "2163,2,2166,78")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,4,2166,78")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,4,2164,76")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,10,2164,75")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,10,2164,19")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,10,2164,13") ; !msg) => ""
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,24,2164,75")
                     ; say(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,28,2164,74")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2164,29,2164,42") ; concat-strings)> ["\n--- BEGIN(", msg, ") ---"]
                       ))))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2165,6,2166,78")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2165,6,2165,31") ; dr-friendly-print-rule-set)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,6,2166,78")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,12,2166,77")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,12,2166,21")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,12,2166,15") ; !msg) => ""
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,26,2166,77")
                  ; say(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,30,2166,76")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2166,31,2166,44") ; concat-strings)> ["--- END  (", msg, ") ---\n"]
                    )))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set-msg", "2163,2,2166,78")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set-msg", "2163,2,2166,78")
      ; fail

  dr-friendly-print-rule-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set", "2168,2,2195,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2169,4,2195,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2169,10,2195,5")
            ; {|DRFriendlyName, DR_Count:
                 s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2170,6,2194,37")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2170,6,2173,6")
                    ; rules (
                        DRCount :
                          "rs" -> 0
                        DRCount :
                          "cs" -> 0
                      ))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2174,8,2194,37")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2174,8,2193,9")
                    ; reverse-map(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2174,20,2193,8")
                        ; {s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2175,13,2192,15")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2175,13,2183,15")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2175,13,2175,42")
                                 ; ?RuleScope(_, Hashtable(rsid)))
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2176,15,2183,15")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2176,15,2179,15")
                                 ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,17,2178,83")
                                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,17,2177,38")
                                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,17,2177,29")
                                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,18,2177,24") ; DRCount)> "rs") => idxrs)
                                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,41,2178,83")
                                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,41,2177,60")
                                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,41,2177,50")
                                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2177,42,2177,44") ; inc)> idxrs) => idxrs')
                                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2178,19,2178,83")
                                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2178,19,2178,75")
                                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2178,20,2178,33") ; concat-strings)> [ "RuleScope("
                                                                                                                                                               , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2178,51,2178,63") ; int-to-string> idxrs
                                                                                                                                                               , ")"
                                                                                                                                                               ]) => name))
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2180,15,2183,15")
                              ; rules (
                                  DRFriendlyName :
                                    rsid -> name
                                  DRCount :
                                    "rs" -> idxrs'
                                )
                              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2184,13,2192,15")
                                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2184,13,2184,45")
                                    ; ?ChangeSet(_, _, Hashtable(csid)))
                                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2185,15,2192,15")
                                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2185,15,2188,15")
                                    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,17,2187,83")
                                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,17,2186,38")
                                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,17,2186,29")
                                                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,18,2186,24") ; DRCount)> "cs") => idxcs)
                                            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,41,2187,83")
                                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,41,2186,60")
                                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,41,2186,50")
                                                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2186,42,2186,44") ; inc)> idxcs) => idxcs')
                                            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2187,19,2187,83")
                                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2187,19,2187,75")
                                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2187,20,2187,33") ; concat-strings)> [ "ChangeSet("
                                                                                                                                                                  , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2187,51,2187,63") ; int-to-string> idxcs
                                                                                                                                                                  , ")"
                                                                                                                                                                  ]) => name))
                                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2189,15,2192,15")
                                 ; rules (
                                     DRFriendlyName :
                                       csid -> name
                                     DRCount :
                                       "cs" -> idxcs'
                                   ))}
                      ))
                 ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2194,10,2194,37")
                 ; map(
                     s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2194,14,2194,36") ; dr-friendly-print-scope
                   )
              |})
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set", "2168,2,2195,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set", "2168,2,2195,6")
      ; fail

  dr-friendly-print-rule-set-msg(|msg) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set-msg", "2197,2,2200,78")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,4,2200,78")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,4,2198,76")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,10,2198,75")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,10,2198,19")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,10,2198,13") ; !msg) => ""
                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,24,2198,75")
                     ; say(
                         s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,28,2198,74")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2198,29,2198,42") ; concat-strings)> ["\n--- BEGIN(", msg, ") ---"]
                       ))))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2199,6,2200,78")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2199,6,2199,31") ; dr-friendly-print-rule-set)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,6,2200,78")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,12,2200,77")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,12,2200,21")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,12,2200,15") ; !msg) => ""
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,26,2200,77")
                  ; say(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,30,2200,76")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2200,31,2200,44") ; concat-strings)> ["--- END  (", msg, ") ---\n"]
                    )))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set-msg", "2197,2,2200,78")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-rule-set-msg", "2197,2,2200,78")
      ; fail

  dr-friendly-print-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-scope", "2202,2,2216,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2203,4,2216,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2203,4,2203,44")
       ; ?RuleScope(labelset, tbl@Hashtable(rsid)))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2204,6,2216,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2204,6,2204,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2204,7,2204,20") ; DRFriendlyName)> rsid)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2205,6,2216,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2206,8,2215,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2206,8,2206,12") ; debug)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2207,10,2215,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2207,10,2207,53")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2207,11,2207,43")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2207,11,2207,23") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2207,26,2207,43")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2207,32,2207,42")
                       ; !"labels: "
                     ))> labelset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2208,10,2215,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2208,10,2208,29")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2208,11,2208,24") ; hashtable-keys)> tbl)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2209,10,2215,10")
            ; map(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2210,12,2214,14")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2210,12,2210,61")
                   ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2210,18,2210,60")
                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2210,19,2210,26") ; fprintnl)> ( stderr()
                                                                                                                                        , [ "  "
                                                                                                                                          , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2210,47,2210,48") ; id>
                                                                                                                                          , " -> "
                                                                                                                                          ]
                                                                                                                                        )))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2211,14,2214,14")
                ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2212,16,2213,58")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2212,16,2212,51")
                           ; \ key -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2212,26,2212,44")
                                       ; hashtable-get(|key)> tbl \)
                        ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2213,18,2213,58")
                        ; map(
                            s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2213,22,2213,57")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2213,23,2213,30") ; fprintnl)> ( stderr()
                                                                                                                                         , [ "    "
                                                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2213,53,2213,54") ; id>
                                                                                                                                           ]
                                                                                                                                         )
                          ))
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-scope", "2202,2,2216,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-scope", "2202,2,2216,6")
      ; fail

  dr-friendly-print-scope =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-scope", "2218,2,2241,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2219,4,2241,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2219,4,2219,51")
       ; ?ChangeSet(
            labelset
          , rmset
          , tbl@Hashtable(csid)
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2220,6,2241,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2220,6,2220,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2220,7,2220,20") ; DRFriendlyName)> csid)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2221,6,2241,6")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2222,8,2240,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2222,8,2222,12") ; debug)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2223,10,2240,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2223,10,2223,53")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2223,11,2223,43")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2223,11,2223,23") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2223,26,2223,43")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2223,32,2223,42")
                       ; !"labels: "
                     ))> labelset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2224,10,2240,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2224,10,2224,51")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2224,11,2224,44")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2224,11,2224,23") ; iset-elements)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2224,26,2224,44")
                   ; debug(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2224,32,2224,43")
                       ; !"removed: "
                     ))> rmset)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2225,10,2240,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2225,10,2225,29")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2225,11,2225,24") ; hashtable-keys)> tbl)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2226,10,2240,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2226,10,2232,10")
               ; map(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,12,2231,14")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,12,2227,88")
                      ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,18,2227,87")
                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,18,2227,43")
                                 ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,19,2227,38")
                                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,19,2227,32") ; DRFriendlyName
                                        <+ s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,37,2227,38") ; id)
                                   , s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,41,2227,42") ; id
                                   ))
                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,46,2227,87")
                              ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,47,2227,54") ; fprintnl)> ( stderr()
                                                                                                                                           , [ "  "
                                                                                                                                             , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2227,75,2227,76") ; id>
                                                                                                                                             , " -> "
                                                                                                                                             ]
                                                                                                                                           )))
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2228,14,2231,14")
                   ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2229,16,2230,58")
                           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2229,16,2229,51")
                              ; \ key -> <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2229,26,2229,44")
                                          ; hashtable-get(|key)> tbl \)
                           ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2230,18,2230,58")
                           ; map(
                               s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2230,22,2230,57")
                               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2230,23,2230,30") ; fprintnl)> ( stderr()
                                                                                                                                            , [ "    "
                                                                                                                                              , <s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2230,53,2230,54") ; id>
                                                                                                                                              ]
                                                                                                                                            )
                             ))
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2233,10,2240,10")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2233,10,2236,10")
               ; try(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2234,12,2235,111")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2234,12,2234,44")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2234,12,2234,34")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2234,13,2234,20") ; DR_BREAK)> IgnoreB(csid)) => blabel)
                   ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2235,14,2235,111")
                   ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2235,15,2235,22") ; fprintnl)> ( stderr()
                                                                                                                                , ["Change set is marked as ignored (due to break) up to label ", blabel, "."]
                                                                                                                                )
                 ))
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2237,10,2240,10")
            ; try(
                s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2238,12,2239,114")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2238,12,2238,44")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2238,12,2238,34")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2238,13,2238,20") ; DR_BREAK)> IgnoreC(csid)) => clabel)
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2239,14,2239,114")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "2239,15,2239,22") ; fprintnl)> ( stderr()
                                                                                                                             , ["Change set is marked as ignored (due to continue) up to label ", clabel, "."]
                                                                                                                             )
              ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-scope", "2218,2,2241,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/lang/dynamic-rules.str", "dr-friendly-print-scope", "2218,2,2241,6")
      ; fail