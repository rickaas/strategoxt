module term/properties

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  strategy/traversal/simple


strategies
  is-subterm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-subterm", "23,2,24,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "24,4,24,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "24,4,24,10")
       ; ?(x, y))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "24,13,24,33")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "24,19,24,32")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "24,20,24,29")
                ; oncetd(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "24,27,24,28") ; ?x
                  ))> y)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-subterm", "23,2,24,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-subterm", "23,2,24,33")
      ; fail

  is-proper-subterm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-subterm", "31,2,32,31")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "32,4,32,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "32,4,32,10")
       ; ?(x, y))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "32,13,32,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "32,13,32,19")
       ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "32,17,32,18") ; eq))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "32,22,32,31")
    ; is-subterm
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-subterm", "31,2,32,31")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-subterm", "31,2,32,31")
      ; fail


strategies
  is-superterm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-superterm", "41,2,42,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "42,4,42,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "42,4,42,10")
       ; ?(x, y))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "42,13,42,33")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "42,19,42,32")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "42,20,42,29")
                ; oncetd(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "42,27,42,28") ; ?y
                  ))> x)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-superterm", "41,2,42,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-superterm", "41,2,42,33")
      ; fail

  is-proper-superterm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-superterm", "49,2,50,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "50,4,50,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "50,4,50,10")
       ; ?(x, y))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "50,13,50,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "50,13,50,19")
       ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "50,17,50,18") ; eq))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "50,22,50,33")
    ; is-superterm
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-superterm", "49,2,50,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-superterm", "49,2,50,33")
      ; fail


strategies
  is-proper-subterm-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-subterm-set", "54,2,55,55")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,4,55,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,4,55,15")
       ; ?([y|_], xs))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,18,55,55")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,24,55,54")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,25,55,50")
                ; fetch(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,31,55,49")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,31,55,37")
                       ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,35,55,36") ; ?y))
                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,40,55,49")
                    ; oncetd(
                        s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "55,47,55,48") ; ?y
                      )
                  ))> xs)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-subterm-set", "54,2,55,55")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-subterm-set", "54,2,55,55")
      ; fail

  is-proper-superterm-set =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-superterm-set", "57,2,58,65")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,4,58,65")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,4,58,15")
       ; ?([x|_], ys))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,18,58,65")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,24,58,64")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,25,58,60")
                ; fetch(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,31,58,59")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,32,58,50") ; is-proper-superterm)> ( x
                                                                                                                                     , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "58,56,58,57") ; id>
                                                                                                                                     )
                  ))> ys)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-superterm-set", "57,2,58,65")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-proper-superterm-set", "57,2,58,65")
      ; fail


strategies
  is-leaf =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-leaf", "68,2,69,12")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "69,4,69,12")
    ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "69,8,69,11") ; fail)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-leaf", "68,2,69,12")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-leaf", "68,2,69,12")
      ; fail

  is-inner-node =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-inner-node", "76,2,77,10")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "77,4,77,10")
    ; one(s-step(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "77,8,77,9") ; id)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-inner-node", "76,2,77,10")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/properties.str", "is-inner-node", "76,2,77,10")
      ; fail