module term/common

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  strategy/traversal/simple
  collection/list/common
  collection/list/set


strategies
  mkterm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "mkterm", "24,2,24,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "24,17,24,48")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "24,17,24,23")
       ; ?(c, ts))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "24,26,24,48")
    ; prim("SSL_mkterm", c, ts)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "mkterm", "24,2,24,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "mkterm", "24,2,24,48")
      ; fail

  explode-term =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "explode-term", "40,2,40,46")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "40,17,40,46")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "40,17,40,18") ; ?t)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "40,21,40,46")
    ; prim("SSL_explode_term", t)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "explode-term", "40,2,40,46")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "explode-term", "40,2,40,46")
      ; fail

  get-constructor =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-constructor", "47,2,47,53")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "47,20,47,53")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "47,20,47,21") ; ?t)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "47,24,47,53")
    ; prim("SSL_get_constructor", t)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-constructor", "47,2,47,53")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-constructor", "47,2,47,53")
      ; fail

  get-arguments =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-arguments", "54,2,54,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "54,18,54,49")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "54,18,54,19") ; ?t)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "54,22,54,49")
    ; prim("SSL_get_arguments", t)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-arguments", "54,2,54,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-arguments", "54,2,54,49")
      ; fail

  get-appl-arguments =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-appl-arguments", "59,2,60,25")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "60,4,60,25")
    ; get-appl-arguments(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "60,23,60,24") ; id
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-appl-arguments", "59,2,60,25")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-appl-arguments", "59,2,60,25")
      ; fail

  get-appl-arguments(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-appl-arguments", "68,2,69,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "69,4,69,48")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "69,4,69,5") ; ?t)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "69,8,69,48")
    ; prim(
        "SSL_get_appl_arguments_map"
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "69,43,69,43") ; s
      | t
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-appl-arguments", "68,2,69,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "get-appl-arguments", "68,2,69,48")
      ; fail

  address-lt =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "address-lt", "79,2,80,41")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "80,4,80,41")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "80,4,80,11")
       ; ?(t1, t2))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "80,14,80,41")
    ; prim("SSL_address_lt", t1, t2)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "address-lt", "79,2,80,41")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "address-lt", "79,2,80,41")
      ; fail

  term-address-lt(|t2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "term-address-lt", "86,2,87,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "87,4,87,36")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "87,4,87,6") ; ?t1)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "87,9,87,36")
    ; prim("SSL_address_lt", t1, t2)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "term-address-lt", "86,2,87,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "term-address-lt", "86,2,87,36")
      ; fail

  address =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "address", "97,2,98,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "98,4,98,28")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "98,4,98,5") ; ?t)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "98,8,98,28")
    ; prim("SSL_address", t)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "address", "97,2,98,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "address", "97,2,98,28")
      ; fail

  checksum =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "checksum", "103,2,103,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "103,13,103,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "103,13,103,14") ; ?t)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "103,18,103,39")
    ; prim("SSL_checksum", t)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "checksum", "103,2,103,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "checksum", "103,2,103,39")
      ; fail


strategies
  crush(nul, sum) :
    _#(xs) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "crush", "107,2,108,32")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "108,15,108,28")
                                                                                                            ; foldr(
                                                                                                                s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "108,21,108,23") ; nul
                                                                                                              , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "108,25,108,27") ; sum
                                                                                                              )> xs
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "crush", "107,2,108,32")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "crush", "107,2,108,32")
             ; fail

  crush(nul, sum, s) :
    _#(xs) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "crush", "110,2,111,35")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "111,15,111,31")
                                                                                                            ; foldr(
                                                                                                                s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "111,21,111,23") ; nul
                                                                                                              , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "111,25,111,27") ; sum
                                                                                                              , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "111,30,111,30") ; s
                                                                                                              )> xs
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "crush", "110,2,111,35")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "crush", "110,2,111,35")
             ; fail


strategies
  node-size =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "node-size", "115,2,116,21")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "116,4,116,21")
    ; crush(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "116,10,116,11")
        ; !0
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "116,14,116,16") ; add
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "116,19,116,20")
        ; !1
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "node-size", "115,2,116,21")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "node-size", "115,2,116,21")
      ; fail

  term-size =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "term-size", "118,2,119,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "119,4,119,28")
    ; crush(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "119,10,119,11")
        ; !1
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "119,14,119,16") ; add
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "119,19,119,27") ; term-size
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "term-size", "118,2,119,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "term-size", "118,2,119,28")
      ; fail


strategies
  at-depth(depth, s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "at-depth", "123,2,130,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "124,6,130,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "124,6,124,24")
       ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "124,9,124,13") ; depth> ()
          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "124,21,124,22") ; id>
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "125,6,130,6")
    ; topdown(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "126,8,129,8")
        ; {d:
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "127,11,128,43")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "127,11,127,20")
               ; ?( 0
                  , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "127,17,127,17") ; s>
                  )
               <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,11,128,43")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,11,128,20")
                     ; ?( d
                        , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,17,128,18") ; id>
                        ))
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,23,128,43")
                  ; all(s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,27,128,42")
                        ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,30,128,32") ; dec> d
                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "128,39,128,40") ; id>
                           )))
          }
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "at-depth", "123,2,130,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "at-depth", "123,2,130,6")
      ; fail


strategies
  om-occurrences(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "om-occurrences", "137,2,138,58")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,4,138,58")
    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,7,138,7") ; s then
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,14,138,15")
        ; !1
      else
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,22,138,54")
        ; crush(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,28,138,29")
            ; !0
          , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,32,138,34") ; add
          , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,37,138,53")
            ; om-occurrences(
                s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "138,52,138,52") ; s
              )
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "om-occurrences", "137,2,138,58")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "om-occurrences", "137,2,138,58")
      ; fail

  occurrences(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "occurrences", "140,2,141,71")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,4,141,71")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,5,141,7") ; add)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,12,141,35")
                                                                                                    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,15,141,15") ; s then
                                                                                                        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,22,141,23")
                                                                                                        ; !1
                                                                                                      else
                                                                                                        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,30,141,31")
                                                                                                        ; !0
                                                                                                      end>
                                                                                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,40,141,69")
                                                                                                    ; crush(
                                                                                                        s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,46,141,47")
                                                                                                        ; !0
                                                                                                      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,50,141,52") ; add
                                                                                                      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,55,141,68")
                                                                                                        ; occurrences(
                                                                                                            s-step(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "141,67,141,67") ; s
                                                                                                          )
                                                                                                      )>
                                                                                                 )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "occurrences", "140,2,141,71")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/common.str", "occurrences", "140,2,141,71")
      ; fail