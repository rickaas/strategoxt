module term/string

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  collection/list/common
  strategy/conditional
  strategy/iteration
  system/io/file


strategies
  new =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "new", "28,2,28,22")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "28,8,28,22")
    ; prim("SSL_new")
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "new", "28,2,28,22")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "new", "28,2,28,22")
      ; fail

  newname =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "newname", "51,2,51,47")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "51,12,51,47")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "51,12,51,18") ; ?prefix)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "51,21,51,47")
    ; prim("SSL_newname", prefix)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "newname", "51,2,51,47")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "newname", "51,2,51,47")
      ; fail

  newterm =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "newterm", "60,2,62,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "61,4,62,36")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "61,4,61,33")
       ; if-c-platform(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "61,18,61,32") ; prim("SSL_new")
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "62,4,62,36")
    ; if-java-platform(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "62,21,62,35") ; SRTS-EXT-newint
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "newterm", "60,2,62,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "newterm", "60,2,62,36")
      ; fail

  external SRTS-EXT-newint(|)

  is-string =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-string", "71,2,71,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "71,15,71,42")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "71,15,71,16") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "71,19,71,42")
    ; prim("SSL_is_string", x)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-string", "71,2,71,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-string", "71,2,71,42")
      ; fail

  is-char =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-char", "78,2,78,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "78,12,78,28")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "78,12,78,17") ; is-int)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "78,21,78,28")
    ; is-ascii
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-char", "78,2,78,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-char", "78,2,78,28")
      ; fail

  implode-string =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "implode-string", "85,2,85,51")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "85,19,85,51")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "85,19,85,20") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "85,23,85,51")
    ; prim("SSL_implode_string", x)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "implode-string", "85,2,85,51")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "implode-string", "85,2,85,51")
      ; fail

  explode-string =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "explode-string", "92,2,92,51")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "92,19,92,51")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "92,19,92,20") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "92,23,92,51")
    ; prim("SSL_explode_string", x)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "explode-string", "92,2,92,51")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "explode-string", "92,2,92,51")
      ; fail

  string-as-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-as-chars", "100,2,103,19")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "101,6,103,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "101,6,101,19") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "102,6,103,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "102,6,102,6") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "103,6,103,19")
    ; implode-string
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-as-chars", "100,2,103,19")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-as-chars", "100,2,103,19")
      ; fail


strategies
  conc-strings =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "conc-strings", "112,2,114,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "113,5,114,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "113,5,113,21")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "113,5,113,10")
          ; ?(_, _))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "113,16,113,21")
       ; strcat
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "114,5,114,33")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "114,5,114,12")
             ; ?""#(xs))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "114,16,114,33")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "114,17,114,30") ; concat-strings)> xs)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "conc-strings", "112,2,114,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "conc-strings", "112,2,114,33")
      ; fail

  strcat =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcat", "126,2,127,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "127,4,127,48")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "127,4,127,16")
       ; ?(str1, str2))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "127,19,127,48")
    ; prim("SSL_strcat", str1, str2)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcat", "126,2,127,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcat", "126,2,127,48")
      ; fail

  concat-strings =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "concat-strings", "138,2,139,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "139,4,139,48")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "139,4,139,11") ; ?strings)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "139,14,139,48")
    ; prim("SSL_concat_strings", strings)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "concat-strings", "138,2,139,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "concat-strings", "138,2,139,48")
      ; fail


strategies
  string-length =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-length", "148,2,149,9")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "149,4,149,9")
    ; strlen
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-length", "148,2,149,9")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-length", "148,2,149,9")
      ; fail

  strlen =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strlen", "159,2,160,32")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "160,4,160,32")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "160,4,160,7") ; ?str)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "160,10,160,32")
    ; prim("SSL_strlen", str)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strlen", "159,2,160,32")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strlen", "159,2,160,32")
      ; fail


strategies
  escape =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape", "170,2,170,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "170,11,170,39")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "170,27,170,38") ; escape-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape", "170,2,170,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape", "170,2,170,39")
      ; fail

  escape-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape-chars", "177,2,178,23")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "178,4,178,23")
    ; escape-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "178,17,178,22") ; Escape
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape-chars", "177,2,178,23")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape-chars", "177,2,178,23")
      ; fail

  escape-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape-chars", "181,2,186,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "182,4,186,4")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,7,185,8")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,8,183,22")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,8,183,8") ; s)
           ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,11,183,22")
           ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,12,183,13") ; id, s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,16,183,17") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "183,21,183,21") ; x]
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "184,7,185,8")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "184,7,184,14")
                 ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "184,8,184,9") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "184,13,184,13") ; x]
                 <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "185,7,185,8") ; []))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape-chars", "181,2,186,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape-chars", "181,2,186,4")
      ; fail

  unescape =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape", "197,2,197,43")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "197,13,197,43")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "197,29,197,42") ; unescape-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape", "197,2,197,43")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape", "197,2,197,43")
      ; fail

  unescape-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape-chars", "205,2,209,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "206,4,209,4")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "207,6,208,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "207,6,207,11")
           ; try(
               s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "207,10,207,10") ; s
             ))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "208,7,208,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "208,7,208,14")
           ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "208,8,208,9") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "208,13,208,13") ; x]
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "208,19,208,20") ; [])
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape-chars", "205,2,209,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape-chars", "205,2,209,4")
      ; fail

  unescape-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape-chars", "216,2,217,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "217,4,217,27")
    ; unescape-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "217,19,217,26") ; UnEscape
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape-chars", "216,2,217,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unescape-chars", "216,2,217,27")
      ; fail

  Escape =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape", "222,2,226,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "223,6,226,27")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "223,6,223,24") ; Escape-double-quote
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "224,6,226,27")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "224,6,224,21") ; Escape-backslash
            + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "225,6,226,27")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "225,6,225,20") ; Escape-linefeed
                 + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "226,6,226,27") ; Escape-carriage-return)))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape", "222,2,226,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape", "222,2,226,27")
      ; fail

  Escape-double-quote :
    ['"'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-double-quote", "229,2,229,59")> ['\', '"'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-double-quote", "229,2,229,59")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-double-quote", "229,2,229,59")
             ; fail

  Escape-single-quote :
    ['\''|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-single-quote", "232,2,232,59")> ['\', '\''|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-single-quote", "232,2,232,59")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-single-quote", "232,2,232,59")
             ; fail

  Escape-backslash :
    ['\'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-backslash", "235,2,235,59")> ['\', '\'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-backslash", "235,2,235,59")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-backslash", "235,2,235,59")
             ; fail

  Escape-linefeed :
    ['\n'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-linefeed", "238,2,238,59")> ['\', 'n'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-linefeed", "238,2,238,59")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-linefeed", "238,2,238,59")
             ; fail

  Escape-carriage-return :
    ['\r'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-carriage-return", "241,2,241,59")> ['\', 'r'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-carriage-return", "241,2,241,59")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Escape-carriage-return", "241,2,241,59")
             ; fail

  UnEscape =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape", "246,2,251,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "247,6,251,29")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "247,6,247,26") ; UnEscape-double-quote
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "248,6,251,29")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "248,6,248,23") ; UnEscape-backslash
            + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "249,6,251,29")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "249,6,249,22") ; UnEscape-linefeed
                 + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "250,6,251,29")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "250,6,250,17") ; UnEscape-tab
                      + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "251,6,251,29") ; UnEscape-carriage-return))))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape", "246,2,251,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape", "246,2,251,29")
      ; fail

  UnEscape-double-quote :
    ['\', '"'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-double-quote", "254,2,254,61")> ['"'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-double-quote", "254,2,254,61")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-double-quote", "254,2,254,61")
             ; fail

  UnEscape-single-quote :
    ['\', '\''|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-single-quote", "257,2,257,61")> ['\''|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-single-quote", "257,2,257,61")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-single-quote", "257,2,257,61")
             ; fail

  UnEscape-backslash :
    ['\', '\'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-backslash", "260,2,260,61")> ['\'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-backslash", "260,2,260,61")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-backslash", "260,2,260,61")
             ; fail

  UnEscape-carriage-return :
    ['\', 'r'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-carriage-return", "263,2,263,61")> ['\r'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-carriage-return", "263,2,263,61")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-carriage-return", "263,2,263,61")
             ; fail

  UnEscape-linefeed :
    ['\', 'n'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-linefeed", "266,2,266,61")> ['\n'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-linefeed", "266,2,266,61")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-linefeed", "266,2,266,61")
             ; fail

  UnEscape-tab :
    ['\', 't'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-tab", "269,2,269,61")> ['\t'|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-tab", "269,2,269,61")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape-tab", "269,2,269,61")
             ; fail

  UnEscape(|c):
    ['\', c|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape", "272,2,273,31")> [c|cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape", "272,2,273,31")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnEscape", "272,2,273,31")
             ; fail


strategies
  escape(esc : ( List(String) -> List(String) ) * List(String) -> List(String)) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape", "278,2,281,17")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "279,4,281,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "279,4,279,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,4,281,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,4,280,34")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,10,280,33")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,10,280,15")
              ; esc(
                  s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,14,280,14") ; x
                )
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,20,280,33")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,20,280,27")
                    ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,21,280,22") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,26,280,26") ; x]
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "280,32,280,33") ; []))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "281,4,281,17")
    ; implode-string
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape", "278,2,281,17")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "escape", "278,2,281,17")
      ; fail

  cify =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "cify", "286,2,286,20")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "286,9,286,20")
    ; escape(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "286,16,286,19") ; Cify
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "cify", "286,2,286,20")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "cify", "286,2,286,20")
      ; fail

  uncify =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "uncify", "289,2,289,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "289,11,289,24")
    ; escape(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "289,18,289,23") ; UnCify
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "uncify", "289,2,289,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "uncify", "289,2,289,24")
      ; fail

  UnCify(x) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify", "292,2,292,51")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,14,292,51")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,14,292,23")
       ; UnCify1(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,22,292,22") ; x
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,28,292,51")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,28,292,37")
             ; UnCify2(
                 s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,36,292,36") ; x
               )
             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,42,292,51")
                ; UnCify3(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "292,50,292,50") ; x
                  )))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify", "292,2,292,51")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify", "292,2,292,51")
      ; fail


rules

  Cify(x) :
    ['\''|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "297,2,297,49")> ['_', 'p', '_'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "297,45,297,45") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "297,2,297,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "297,2,297,49")
             ; fail

  Cify(x) :
    ['-'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "300,2,300,49")> ['_'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "300,45,300,45") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "300,2,300,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "300,2,300,49")
             ; fail

  Cify(x) :
    ['_'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "303,2,303,49")> ['_', '_'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "303,45,303,45") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "303,2,303,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "303,2,303,49")
             ; fail

  Cify(x) :
    ['"'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "306,2,306,49")> ['_', 'q', '_'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "306,45,306,45") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "306,2,306,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "306,2,306,49")
             ; fail

  Cify(x) :
    ['\'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "309,2,309,49")> ['_', 'b', '_'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "309,45,309,45") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "309,2,309,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "Cify", "309,2,309,49")
             ; fail

  UnCify1(x) :
    ['_', 'b', '_'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "312,2,312,52")> ['\'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "312,48,312,48") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "312,2,312,52")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "312,2,312,52")
             ; fail

  UnCify1(x) :
    ['_', 'q', '_'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "315,2,315,52")> ['"'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "315,48,315,48") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "315,2,315,52")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "315,2,315,52")
             ; fail

  UnCify1(x) :
    ['_', 'p', '_'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "318,2,318,52")> ['\''|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "318,48,318,48") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "318,2,318,52")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify1", "318,2,318,52")
             ; fail

  UnCify2(x) :
    ['_', '_'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify2", "321,2,321,52")> ['_'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "321,48,321,48") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify2", "321,2,321,52")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify2", "321,2,321,52")
             ; fail

  UnCify3(x) :
    ['_'|cs] -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify3", "324,2,324,52")> ['-'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "324,48,324,48") ; x> cs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify3", "324,2,324,52")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "UnCify3", "324,2,324,52")
             ; fail


strategies
  quote(c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote", "335,2,335,43")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "335,13,335,43")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "335,29,335,42")
        ; quote-chars(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "335,41,335,41") ; c
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote", "335,2,335,43")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote", "335,2,335,43")
      ; fail

  quote-chars(c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote-chars", "341,2,341,46")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "341,19,341,46")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "341,20,341,30") ; quote-chars)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "341,35,341,35") ; c> ()
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "341,43,341,44") ; id>
                                                                                                           )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote-chars", "341,2,341,46")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote-chars", "341,2,341,46")
      ; fail

  quote-chars :
    (c, chars) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote-chars", "346,2,347,42")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "347,19,347,22") ; conc> ([c|chars], [c])
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote-chars", "346,2,347,42")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "quote-chars", "346,2,347,42")
             ; fail

  single-quote-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "single-quote-chars", "355,2,355,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "355,23,355,48")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "355,24,355,34") ; quote-chars)> ( '\''
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "355,45,355,46") ; id>
                                                                                                           )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "single-quote-chars", "355,2,355,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "single-quote-chars", "355,2,355,48")
      ; fail

  double-quote-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "double-quote-chars", "363,2,363,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "363,23,363,48")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "363,24,363,34") ; quote-chars)> ( '"'
                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "363,45,363,46") ; id>
                                                                                                           )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "double-quote-chars", "363,2,363,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "double-quote-chars", "363,2,363,48")
      ; fail

  single-quote =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "single-quote", "368,2,368,51")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "368,17,368,51")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "368,33,368,50") ; single-quote-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "single-quote", "368,2,368,51")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "single-quote", "368,2,368,51")
      ; fail

  double-quote =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "double-quote", "376,2,376,51")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "376,17,376,51")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "376,33,376,50") ; double-quote-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "double-quote", "376,2,376,51")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "double-quote", "376,2,376,51")
      ; fail


strategies
  unquote(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote", "390,2,391,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "391,4,391,36")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "391,20,391,35")
        ; unquote-chars(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "391,34,391,34") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote", "390,2,391,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote", "390,2,391,36")
      ; fail

  unquote(s1, s2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote", "402,2,403,41")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "403,4,403,41")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "403,20,403,40")
        ; unquote-chars(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "403,34,403,35") ; s1
          , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "403,38,403,39") ; s2
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote", "402,2,403,41")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote", "402,2,403,41")
      ; fail

  unquote-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote-chars", "412,2,413,22")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "413,4,413,22")
    ; unquote-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "413,18,413,18") ; s
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "413,21,413,21") ; s
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote-chars", "412,2,413,22")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote-chars", "412,2,413,22")
      ; fail

  unquote-chars(s1, s2) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote-chars", "424,2,428,9")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "425,6,428,9")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "425,6,425,20")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "425,12,425,19")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "425,12,425,13") ; Hd)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "425,18,425,19")
               ; s1))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "426,6,428,9")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "426,6,426,20")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "426,12,426,19")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "426,12,426,15") ; last)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "426,18,426,19")
               ; s2))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "427,6,428,9")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "427,6,427,7") ; Tl)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "428,6,428,9")
    ; init
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote-chars", "424,2,428,9")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "unquote-chars", "424,2,428,9")
      ; fail

  un-single-quote-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-single-quote-chars", "437,2,437,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "437,26,437,45")
    ; unquote-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "437,40,437,44")
        ; ?'\''
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-single-quote-chars", "437,2,437,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-single-quote-chars", "437,2,437,45")
      ; fail

  un-double-quote-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-double-quote-chars", "446,2,446,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "446,26,446,45")
    ; unquote-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "446,40,446,43")
        ; ?'"'
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-double-quote-chars", "446,2,446,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-double-quote-chars", "446,2,446,45")
      ; fail

  un-single-quote =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-single-quote", "454,2,454,57")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "454,20,454,57")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "454,36,454,56") ; un-single-quote-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-single-quote", "454,2,454,57")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-single-quote", "454,2,454,57")
      ; fail

  un-double-quote =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-double-quote", "462,2,462,57")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "462,20,462,57")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "462,36,462,56") ; un-double-quote-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-double-quote", "462,2,462,57")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "un-double-quote", "462,2,462,57")
      ; fail


strategies
  is-double-quoted =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-double-quoted", "478,2,479,18")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "479,4,479,18")
    ; is-quoted(|'"')
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-double-quoted", "478,2,479,18")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-double-quoted", "478,2,479,18")
      ; fail

  is-single-quoted =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-single-quoted", "486,2,487,19")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "487,4,487,19")
    ; is-quoted(|'\'')
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-single-quoted", "486,2,487,19")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-single-quoted", "486,2,487,19")
      ; fail

  is-double-quoted-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-double-quoted-chars", "495,2,496,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "496,4,496,24")
    ; is-quoted-chars(|'"')
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-double-quoted-chars", "495,2,496,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-double-quoted-chars", "495,2,496,24")
      ; fail

  is-single-quoted-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-single-quoted-chars", "504,2,505,25")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "505,4,505,25")
    ; is-quoted-chars(|'\'')
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-single-quoted-chars", "504,2,505,25")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-single-quoted-chars", "504,2,505,25")
      ; fail

  is-quoted(|c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-quoted", "515,2,519,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "516,4,519,4")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "517,6,518,26")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "517,6,517,19") ; explode-string)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "518,8,518,26")
            ; is-quoted-chars(|c))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-quoted", "515,2,519,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-quoted", "515,2,519,4")
      ; fail

  is-quoted-chars(|c) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-quoted-chars", "529,2,530,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "530,4,530,27")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "530,10,530,26")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "530,10,530,22")
               ; ?[c|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "530,17,530,20") ; last>])
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "530,25,530,26")
            ; ?c)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-quoted-chars", "529,2,530,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-quoted-chars", "529,2,530,27")
      ; fail


strategies
  string-to-num =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-to-num", "537,2,539,18")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "538,4,539,18")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "538,4,538,48")
       ; obsolete(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "538,13,538,47")
           ; !"string-to-num; use string-to-int"
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "539,6,539,18")
    ; string-to-int
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-to-num", "537,2,539,18")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-to-num", "537,2,539,18")
      ; fail


strategies
  lower-case =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lower-case", "548,2,548,47")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "548,15,548,47")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "548,31,548,46") ; lower-case-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lower-case", "548,2,548,47")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lower-case", "548,2,548,47")
      ; fail

  upper-case =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "upper-case", "555,2,555,47")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "555,15,555,47")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "555,31,555,46") ; upper-case-chars
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "upper-case", "555,2,555,47")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "upper-case", "555,2,555,47")
      ; fail

  lower-case-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lower-case-chars", "564,2,564,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "564,21,564,33")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "564,25,564,32") ; to-lower
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lower-case-chars", "564,2,564,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lower-case-chars", "564,2,564,33")
      ; fail

  upper-case-chars =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "upper-case-chars", "573,2,573,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "573,21,573,33")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "573,25,573,32") ; to-upper
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "upper-case-chars", "573,2,573,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "upper-case-chars", "573,2,573,33")
      ; fail


strategies
  string-tokenize(|sepchars) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "587,2,588,49")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,4,588,49")
    ; string-tokenize(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,20,588,48")
        ; {c:
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,24,588,47")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,24,588,25") ; ?c)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,28,588,47")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,29,588,37")
                ; fetch(
                    s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "588,35,588,36") ; ?c
                  ))> sepchars
          }
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "587,2,588,49")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "587,2,588,49")
      ; fail

  string-tokenize(sep) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "591,2,594,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "592,6,594,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "592,6,592,19") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "593,6,594,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "593,6,593,23")
       ; list-tokenize(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "593,20,593,22") ; sep
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "594,6,594,24")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "594,10,594,23") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "591,2,594,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "591,2,594,24")
      ; fail

  string-tokenize =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "605,2,607,31")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "606,6,607,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "606,6,606,22")
       ; ?( sepchars
          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "606,19,606,20") ; id>
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "607,6,607,31")
    ; string-tokenize(|sepchars)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "605,2,607,31")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize", "605,2,607,31")
      ; fail


strategies
  padd-with(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "padd-with", "616,2,617,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "617,4,617,39")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "617,5,617,15") ; align-right)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "617,20,617,20") ; s> ()
                                                                                                          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "617,28,617,30") ; Fst>
                                                                                                          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "617,35,617,37") ; Snd>
                                                                                                          )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "padd-with", "616,2,617,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "padd-with", "616,2,617,39")
      ; fail

  remove-padding =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "remove-padding", "625,2,633,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "626,4,633,4")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "627,6,632,11")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "627,6,627,22") ; split-at-newlines)
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "628,6,632,11")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "628,6,628,36")
           ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "628,12,628,35")
                   ; padding := <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "628,24,628,29") ; length> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "628,33,628,34") ; Hd>))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "629,6,632,11")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "629,6,629,38")
           ; remove-padding(|padding, padding))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "630,6,632,11")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "630,6,630,31")
           ; at-last(
               s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "630,14,630,30")
               ; rtrim(
                   s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "630,20,630,29")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "630,20,630,22") ; ' '
                      + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "630,26,630,29") ; '\t')
                 )
             ))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "631,6,632,11")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "631,6,631,25")
           ; separate-by(|['\n']))
        ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "632,6,632,11")
        ; concat
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "remove-padding", "625,2,633,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "remove-padding", "625,2,633,4")
      ; fail

  internal remove-padding(|max, n) =
             s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "remove-padding", "635,11,648,5")
             ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "636,4,648,5")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "636,4,637,35")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "636,4,636,22")
                   ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "636,10,636,21")
                           ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "636,11,636,13") ; leq)> (n, 0)))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "637,4,637,35")
                ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "637,5,637,6") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "637,10,637,34")
                                                                                                         ; remove-padding(|max, max)]
                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "639,4,648,5")
                   ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "639,4,640,32")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "639,4,639,24")
                         ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "639,5,639,18")
                            ; ?[' '|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "639,15,639,16") ; id>]|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "639,22,639,23") ; id])
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "640,4,640,32")
                      ; remove-padding(
                        | max
                        , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "640,26,640,28") ; dec> n
                        )
                      <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "642,4,648,5")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "642,4,643,38")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "642,4,642,24")
                               ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "642,5,642,18")
                                  ; ?['\t'|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "642,15,642,16") ; id>]|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "642,22,642,23") ; id])
                            ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "643,4,643,38")
                            ; remove-padding(
                              | max
                              , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "643,26,643,29") ; subt> (n, 4)
                              )
                            <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "645,4,648,5")
                               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "645,4,646,37")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "645,4,645,33")
                                     ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "645,10,645,32")
                                             ; max' := <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "645,19,645,22") ; subt> (max, n)))
                                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "646,4,646,37")
                                  ; [s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "646,5,646,6") ; id|s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "646,10,646,36")
                                                                                                                           ; remove-padding(|max', max')]
                                  <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "648,4,648,5") ; []))))
             < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "remove-padding", "635,11,648,5")
             + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "remove-padding", "635,11,648,5")
               ; fail

  align-right :
    (c, s, n) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-right", "653,2,655,41")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "654,18,654,29") ; conc-strings> (add, s)
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-right", "653,2,655,41")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-right", "653,2,655,41")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "655,12,655,41")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "655,12,655,34")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "655,13,655,31")
                 ; align-helper(|c, n))> s) => add
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-right", "653,2,655,41")
             ; fail

  align-left :
    (c, s, n) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-left", "660,2,662,41")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "661,18,661,29") ; conc-strings> (s, add)
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-left", "660,2,662,41")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-left", "660,2,662,41")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "662,12,662,41")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "662,12,662,34")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "662,13,662,31")
                 ; align-helper(|c, n))> s) => add
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-left", "660,2,662,41")
             ; fail

  align-center :
    (c, s, n) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-center", "667,2,676,63")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "668,18,668,31") ; concat-strings> [add-before, s, add-after]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-center", "667,2,676,63")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-center", "667,2,676,63")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "669,12,676,63")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "669,12,669,33")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "669,12,669,28")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "669,13,669,25") ; string-length)> s) => l)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "670,12,676,63")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "670,12,670,38")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "670,12,670,24")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "670,13,670,16") ; subt)> (n, l)) => whitespace)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "671,12,676,63")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "671,12,674,42")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "671,12,674,23")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "671,16,673,41")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "671,16,671,19") ; even
                       < s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "672,16,672,25")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "672,16,672,19") ; div2)
                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "672,22,672,25")
                         ; Dupl
                       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,16,673,41")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,16,673,18") ; dec)
                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,21,673,41")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,21,673,24") ; div2)
                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,27,673,41")
                         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,27,673,30") ; Dupl)
                         ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,33,673,41")
                         ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,34,673,36") ; inc
                           , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "673,39,673,40") ; id
                           )))> whitespace) => (before, after))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "675,12,676,63")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "675,12,675,64")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "675,12,675,50")
                ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "675,13,675,47")
                    ; align-helper(
                      | c
                      , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "675,31,675,33") ; add> (l, before)
                      ))> s) => add-before)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "676,12,676,63")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "676,12,676,50")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "676,13,676,47")
                 ; align-helper(
                   | c
                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "676,31,676,33") ; add> (l, after)
                   ))> s) => add-after
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-center", "667,2,676,63")
             ; fail

  align-helper(|c, n) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-helper", "683,6,690,12")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "684,8,690,12")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "684,8,684,20") ; string-length)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "685,10,690,12")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "685,10,685,25")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "685,11,685,14") ; subt)> ( n
                                                                                                       , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "685,22,685,23") ; id>
                                                                                                       ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "686,10,690,12")
    ; if s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "686,13,686,15") ; pos then
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "687,12,687,32")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "687,13,687,21") ; copy-char)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "687,26,687,27") ; id>
                                                                                                             , c
                                                                                                             )
      else
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "689,12,689,14")
        ; !""
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-helper", "683,6,690,12")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "align-helper", "683,6,690,12")
      ; fail

  div2 =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "div2", "692,6,692,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "692,13,692,27")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "692,14,692,16") ; div)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "692,21,692,22") ; id>
                                                                                                   , 2
                                                                                                   )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "div2", "692,6,692,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "div2", "692,6,692,27")
      ; fail


rules

  SplitInit :
    x -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitInit", "697,2,697,29")> ([], [], x)
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitInit", "697,2,697,29")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitInit", "697,2,697,29")
             ; fail

  SplitExit :
    (xs, cs, []) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitExit", "700,2,702,43")> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "702,2,702,8") ; reverse> [<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "702,13,702,35")
                                                                                                                                                                                                                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "702,13,702,19") ; reverse)
                                                                                                                                                                                                                    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "702,22,702,35")
                                                                                                                                                                                                                    ; implode-string> cs|xs]
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitExit", "700,2,702,43")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitExit", "700,2,702,43")
             ; fail

  SplitNext :
    (xs, cs, [32|ys]) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "705,2,707,45")> ( [<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "707,4,707,26")
                                                                                                                              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "707,4,707,10") ; reverse)
                                                                                                                              ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "707,13,707,26")
                                                                                                                              ; implode-string> cs|xs]
                                                                                                                          , []
                                                                                                                          , ys
                                                                                                                          )
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "705,2,707,45")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "705,2,707,45")
             ; fail

  SplitNext :
    (xs, cs, [y|ys]) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "710,2,712,23")> (xs, [y|cs], ys)
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "710,2,712,23")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "710,2,712,23")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "712,7,712,23")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "712,8,712,14")
              ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "712,12,712,13") ; eq))> (y, 32)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "SplitNext", "710,2,712,23")
             ; fail


strategies
  split-at-space =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-space", "726,2,729,35")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "727,4,729,35")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "727,4,727,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "728,4,729,35")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "728,4,728,12") ; SplitInit)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "729,4,729,35")
    ; rec x (
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "729,10,729,34")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "729,10,729,18") ; SplitExit
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "729,23,729,34")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "729,23,729,31") ; SplitNext)
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "729,34,729,34")
              ; x)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-space", "726,2,729,35")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-space", "726,2,729,35")
      ; fail

  split-at-dot =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-dot", "734,2,739,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "735,3,739,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "735,3,735,27")
       ; split(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "735,9,735,11")
           ; ![]
         , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "735,13,735,26") ; explode-string
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "736,3,739,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "736,3,738,13")
       ; rec r (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "736,12,738,12")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "736,12,736,42")
              ; \ (int, [46|frac]) -> (int, frac) \
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "737,5,738,12")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "737,5,737,52")
                    ; \ (int, [i|rest]) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "737,26,737,26") ; r> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "737,30,737,41")
                                                                                                                                       ; at-end(
                                                                                                                                           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "737,37,737,40")
                                                                                                                                           ; ![i]
                                                                                                                                         )> int
                                                                                                                                    , rest
                                                                                                                                    ) \
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "738,5,738,12")
                       ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "738,6,738,7") ; id
                         , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "738,9,738,11") ; Nil
                         )))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "739,3,739,33")
    ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "739,4,739,17") ; implode-string
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "739,19,739,32") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-dot", "734,2,739,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-dot", "734,2,739,33")
      ; fail

  split-before =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-before", "745,2,751,31")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "745,17,751,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "745,17,745,24")
       ; ?(l, sub))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "746,8,751,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "746,8,746,34")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "746,8,746,26")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "746,9,746,22") ; explode-string)> sub) => sub')
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "747,8,751,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "747,8,747,24")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "747,9,747,22") ; explode-string)> l)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "748,8,751,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "748,8,748,22")
       ; \ x -> ([], x) \)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "749,8,751,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "749,8,750,59")
       ; rec r (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "749,15,750,57")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "749,15,749,59")
              ; \ x@(_, x') -> x
                  where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "749,37,749,57")
                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "749,38,749,47") ; left-match)> (x', sub') \
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "750,15,750,57")
                 ; \ (x', [x|xs]) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "750,33,750,33") ; r> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "750,37,750,48")
                                                                                                                                 ; at-end(
                                                                                                                                     s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "750,44,750,47")
                                                                                                                                     ; ![x]
                                                                                                                                   )> x'
                                                                                                                              , xs
                                                                                                                              ) \)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "751,1,751,31")
    ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "751,2,751,15") ; implode-string
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "751,17,751,30") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-before", "745,2,751,31")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-before", "745,2,751,31")
      ; fail

  split-after =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-after", "757,2,764,31")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "757,16,764,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "757,16,757,23")
       ; ?(l, sub))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "758,8,764,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "758,8,758,34")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "758,8,758,26")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "758,9,758,22") ; explode-string)> sub) => sub')
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "759,8,764,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "759,8,759,24")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "759,9,759,22") ; explode-string)> l)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "760,8,764,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "760,8,760,22")
       ; \ x -> ([], x) \)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "761,8,764,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "761,8,763,59")
       ; rec r (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "761,15,763,57")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "761,15,761,21")
              ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "761,16,761,17") ; id
                , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "761,19,761,20") ; []
                )
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "762,15,763,57")
                 ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "762,15,762,66")
                    ; \ (x, x') -> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "762,29,762,32") ; conc> (x, sub')
                                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "762,44,762,53") ; left-match> (x', sub')
                                   ) \
                    <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "763,15,763,57")
                       ; \ (x', [x|xs]) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "763,33,763,33") ; r> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "763,37,763,48")
                                                                                                                                       ; at-end(
                                                                                                                                           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "763,44,763,47")
                                                                                                                                           ; ![x]
                                                                                                                                         )> x'
                                                                                                                                    , xs
                                                                                                                                    ) \))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "764,1,764,31")
    ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "764,2,764,15") ; implode-string
      , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "764,17,764,30") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-after", "757,2,764,31")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-after", "757,2,764,31")
      ; fail

  is-substring(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-substring", "774,2,782,11")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "775,4,782,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "775,4,775,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "775,19,782,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "775,19,775,23") ; ?long)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "776,4,782,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "776,4,776,4") ; s)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "776,6,782,11")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "776,6,776,26")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "776,6,776,19") ; explode-string) => sub)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "778,5,782,10")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "778,5,778,18")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "778,6,778,7") ; eq)> (sub, long)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "780,4,782,10")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "780,5,782,5")
              ; rec r (
                  s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "780,11,782,4")
                  ; {a, xs:
                      s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,6,781,46")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,6,781,14")
                         ; ?a@[_|xs])
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,18,781,45")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,18,781,36")
                         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,19,781,28") ; left-match)> (a, sub)
                         <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,41,781,45")
                            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "781,42,781,42") ; r)> xs)
                    }
                ))> long)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-substring", "774,2,782,11")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-substring", "774,2,782,11")
      ; fail

  copy-char =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "copy-char", "788,2,789,23")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "789,4,789,23")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "789,4,789,7") ; copy)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "789,10,789,23")
    ; implode-string
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "copy-char", "788,2,789,23")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "copy-char", "788,2,789,23")
      ; fail

  string-sort =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-sort", "800,2,803,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "801,6,803,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "801,6,801,24")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "801,10,801,23") ; explode-string
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "802,6,803,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "802,6,802,21")
       ; qsort(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "802,12,802,20") ; string-lt
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "803,6,803,24")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "803,10,803,23") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-sort", "800,2,803,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-sort", "800,2,803,24")
      ; fail

  string-sort-desc =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-sort-desc", "810,2,813,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "811,6,813,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "811,6,811,24")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "811,10,811,23") ; explode-string
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "812,6,813,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "812,6,812,21")
       ; qsort(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "812,12,812,20") ; string-gt
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "813,6,813,24")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "813,10,813,23") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-sort-desc", "810,2,813,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-sort-desc", "810,2,813,24")
      ; fail


strategies
  string-gt =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-gt", "824,2,826,17")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "825,4,826,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "825,4,825,40")
       ; try(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "825,8,825,39")
           ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "825,9,825,22") ; explode-string
             , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "825,25,825,38") ; explode-string
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "826,4,826,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "826,4,826,13") ; strcasecmp)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "826,16,826,17")
    ; ?1
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-gt", "824,2,826,17")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-gt", "824,2,826,17")
      ; fail

  string-lt =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-lt", "835,2,837,18")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "836,4,837,18")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "836,4,836,40")
       ; try(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "836,8,836,39")
           ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "836,9,836,22") ; explode-string
             , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "836,25,836,38") ; explode-string
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "837,4,837,18")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "837,4,837,13") ; strcasecmp)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "837,16,837,18")
    ; ?-1
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-lt", "835,2,837,18")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-lt", "835,2,837,18")
      ; fail

  string-starts-with(|start) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-starts-with", "848,2,849,65")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "849,4,849,65")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "849,10,849,64")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "849,11,849,20") ; left-match)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "849,25,849,38") ; explode-string>
                                                                                                                  , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "849,43,849,56") ; explode-string> start
                                                                                                                  ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-starts-with", "848,2,849,65")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-starts-with", "848,2,849,65")
      ; fail

  string-ends-with(|end) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-ends-with", "860,2,861,64")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "861,4,861,64")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "861,10,861,63")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "861,11,861,21") ; right-match)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "861,26,861,39") ; explode-string>
                                                                                                                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "861,44,861,57") ; explode-string> end
                                                                                                                   ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-ends-with", "860,2,861,64")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-ends-with", "860,2,861,64")
      ; fail

  left-match =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "left-match", "871,2,876,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "872,6,876,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "872,6,875,6")
       ; rec r (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "873,9,874,15")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "873,9,873,42")
              ; \ ([l|ls], [l|rs]) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "873,31,873,31") ; r> (ls, rs) \
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "874,9,874,15")
                 ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "874,10,874,11") ; id
                   , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "874,13,874,14") ; []
                   ))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "876,6,876,8")
    ; Fst
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "left-match", "871,2,876,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "left-match", "871,2,876,8")
      ; fail

  right-match =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "right-match", "885,2,888,12")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "886,6,888,12")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "886,6,886,23")
       ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "886,7,886,13") ; reverse
         , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "886,16,886,22") ; reverse
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "887,6,888,12")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "887,6,887,15") ; left-match)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "888,6,888,12")
    ; reverse
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "right-match", "885,2,888,12")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "right-match", "885,2,888,12")
      ; fail

  strcmp =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcmp", "893,2,902,3")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "893,11,902,3")
    ; rec r (
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "894,7,901,7")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "894,7,894,37")
           ; \ ([x|xs], [x|ys]) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "894,28,894,28") ; r> (xs, ys) \
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "895,6,901,7")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "895,6,895,19")
                 ; \ ([], []) -> 0 \
                 <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "896,6,901,7")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "896,6,896,42")
                       ; \ ([x|_], [y|_]) -> -1
                           where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "896,33,896,41")
                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "896,34,896,35") ; lt)> (x, y) \
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "897,6,901,7")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "897,6,897,23")
                             ; \ ([], [_|_]) -> -1 \
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "901,6,901,7")
                                ; !1))))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcmp", "893,2,902,3")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcmp", "893,2,902,3")
      ; fail

  strncmp =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strncmp", "911,2,918,1")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "911,12,918,1")
    ; rec r (
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "912,4,917,5")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "912,4,912,17")
           ; \ (_, _, 0) -> 0 \
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "913,4,917,5")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "913,4,913,48")
                 ; \ ( [x|xs]
                     , [x|ys]
                     , i
                     ) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "913,27,913,27") ; r> ( xs
                                                                                                                   , ys
                                                                                                                   , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "913,37,913,40") ; subt> (i, 1)
                                                                                                                   ) \
                 <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "914,4,917,5")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "914,4,914,19")
                       ; \ ([], [], _) -> 0 \
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "915,4,917,5")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "915,4,915,42")
                             ; \ ([x|_], [y|_], _) -> -1
                                 where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "915,33,915,41")
                                       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "915,34,915,35") ; lt)> (x, y) \
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "916,4,917,5")
                                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "916,4,916,23")
                                   ; \ ([], [_|_], _) -> -1 \
                                   <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "917,4,917,5")
                                      ; !1)))))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strncmp", "911,2,918,1")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strncmp", "911,2,918,1")
      ; fail

  strcasecmp =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcasecmp", "930,2,936,1")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "930,15,936,1")
    ; rec r (
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "931,4,935,5")
        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "931,4,931,61")
           ; \ ([x|xs], [y|ys]) -> <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "931,25,931,25") ; r> (xs, ys)
               where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "931,41,931,60")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "931,42,931,54")
                         ; case-char(
                             s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "931,52,931,53") ; eq
                           ))> (x, y) \
           <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "932,4,935,5")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "932,4,932,17")
                 ; \ ([], []) -> 0 \
                 <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "933,4,935,5")
                    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "933,4,933,51")
                       ; \ ([x|_], [y|_]) -> -1
                           where s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "933,31,933,50")
                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "933,32,933,44")
                                     ; case-char(
                                         s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "933,42,933,43") ; lt
                                       ))> (x, y) \
                       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "934,4,935,5")
                          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "934,4,934,21")
                             ; \ ([], [_|_]) -> -1 \
                             <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "935,4,935,5")
                                ; !1))))
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcasecmp", "930,2,936,1")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "strcasecmp", "930,2,936,1")
      ; fail


strategies
  string-tokenize-keep-empty(|sepChars) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize-keep-empty", "954,2,959,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "955,4,959,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "955,4,955,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,6,959,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,6,958,20")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,13,958,19")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,15,957,49")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,15,956,50")
                 ; split-fetch(
                     s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,27,956,49")
                     ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,28,956,31") ; elem)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "956,36,956,37") ; id>
                                                                                                                     , sepChars
                                                                                                                     )
                   ))
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "957,15,957,49")
              ; \ (tchars, cs) -> [tchars|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "957,42,957,42") ; x> cs] \
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "958,13,958,19")
                 ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "958,16,958,17") ; id>])
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "959,6,959,24")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "959,10,959,23") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize-keep-empty", "954,2,959,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize-keep-empty", "954,2,959,24")
      ; fail

  string-tokenize-keep-all(|sepChars) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize-keep-all", "975,2,980,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "976,4,980,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "976,4,976,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,6,980,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,6,979,20")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,13,979,19")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,15,978,58")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,15,977,62")
                 ; split-fetch-keep(
                     s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,32,977,61")
                     ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,38,977,60")
                             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,39,977,42") ; elem)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "977,47,977,48") ; id>
                                                                                                                             , sepChars
                                                                                                                             ))
                   ))
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "978,15,978,58")
              ; \ (tchars, s, cs) -> [tchars|[[s]|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "978,50,978,50") ; x> cs]] \
              <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "979,13,979,19")
                 ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "979,16,979,17") ; id>])
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "980,6,980,24")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "980,10,980,23") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize-keep-all", "975,2,980,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-tokenize-keep-all", "975,2,980,24")
      ; fail

  get-lines =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "get-lines", "990,2,993,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "991,4,993,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "991,4,991,17") ; explode-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "992,6,993,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "992,6,992,22") ; split-at-newlines)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "993,6,993,24")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "993,10,993,23") ; implode-string
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "get-lines", "990,2,993,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "get-lines", "990,2,993,24")
      ; fail

  internal split-at-newlines =
             s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-newlines", "995,11,1002,13")
             ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "996,4,1002,13")
             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "996,4,1001,37")
                ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "996,4,1000,4")
                   ; at-suffix(
                       s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "997,7,999,31")
                       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "997,7,997,31")
                          ; ( ['\n'|tl] -> [] )
                          <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "998,7,999,31")
                             ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "998,7,998,31")
                                ; ( ['\r', '\n'|tl] -> [] )
                                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "999,7,999,31")
                                   ; ( ['\r'|tl] -> [] )))
                     ))
                ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1001,6,1001,37")
                ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1001,9,1001,10") ; id>|<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1001,16,1001,32") ; split-at-newlines> tl]
                <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1002,7,1002,13")
                   ; ![<s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1002,10,1002,11") ; id>])
             < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-newlines", "995,11,1002,13")
             + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "split-at-newlines", "995,11,1002,13")
               ; fail

  all-lines(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "all-lines", "1020,2,1029,17")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1021,4,1029,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1021,4,1021,12") ; is-string)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1022,4,1029,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1022,4,1022,38")
       ; string-tokenize-keep-empty(|['\n']))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1023,4,1029,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1023,4,1025,37")
       ; at-last(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1023,13,1025,36")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1023,13,1023,26")
              ; \ [""] -> [] \
              < s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1024,13,1024,40")
                ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1024,19,1024,39")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1024,19,1024,25")
                           ; !["\n"]) => laststring)
              + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1025,13,1025,36")
                ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1025,19,1025,35")
                        ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1025,19,1025,21")
                           ; ![]) => laststring))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1026,4,1029,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1026,4,1026,9")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1026,8,1026,8") ; s
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1027,4,1029,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1027,4,1027,29")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1027,5,1027,15") ; separate-by)> ( "\n"
                                                                                                               , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1027,26,1027,27") ; id>
                                                                                                               ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1028,4,1029,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1028,4,1028,28")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1028,5,1028,8") ; conc)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1028,13,1028,14") ; id>
                                                                                                       , laststring
                                                                                                       ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1029,4,1029,17")
    ; concat-strings
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "all-lines", "1020,2,1029,17")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "all-lines", "1020,2,1029,17")
      ; fail

  lines =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lines", "1037,2,1040,17")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1038,4,1040,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1038,4,1038,21")
       ; separate-by(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1038,16,1038,20")
           ; !"\n"
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1039,4,1040,17")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1039,4,1039,24")
       ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1039,5,1039,8") ; conc)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1039,13,1039,14") ; id>
                                                                                                       , ["\n"]
                                                                                                       ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1040,4,1040,17")
    ; concat-strings
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lines", "1037,2,1040,17")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "lines", "1037,2,1040,17")
      ; fail

  indent-text(|n) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "indent-text", "1050,2,1052,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1051,4,1052,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1051,4,1051,40")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1051,10,1051,39")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1051,10,1051,29")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1051,11,1051,19") ; copy-char)> (n, ' ')) => prefix))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1052,4,1052,24")
    ; prefix-lines(|prefix)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "indent-text", "1050,2,1052,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "indent-text", "1050,2,1052,24")
      ; fail

  prefix-lines(|p) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "prefix-lines", "1062,2,1063,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1063,4,1063,38")
    ; all-lines(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1063,14,1063,37")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1063,15,1063,26") ; conc-strings)> ( p
                                                                                                                  , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1063,34,1063,35") ; id>
                                                                                                                  )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "prefix-lines", "1062,2,1063,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "prefix-lines", "1062,2,1063,38")
      ; fail


strategies
  ltrim-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "ltrim-chars", "1080,2,1080,43")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1080,19,1080,43")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1080,35,1080,42")
        ; ltrim(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1080,41,1080,41") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "ltrim-chars", "1080,2,1080,43")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "ltrim-chars", "1080,2,1080,43")
      ; fail

  rtrim-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "rtrim-chars", "1094,2,1094,43")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1094,19,1094,43")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1094,35,1094,42")
        ; rtrim(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1094,41,1094,41") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "rtrim-chars", "1094,2,1094,43")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "rtrim-chars", "1094,2,1094,43")
      ; fail

  trim-chars(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-chars", "1109,2,1109,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1109,19,1109,42")
    ; string-as-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1109,35,1109,41")
        ; trim(
            s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1109,40,1109,40") ; s
          )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-chars", "1109,2,1109,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-chars", "1109,2,1109,42")
      ; fail

  is-whitespace =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-whitespace", "1119,2,1119,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1119,18,1119,33")
    ; test(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1119,23,1119,32")
           ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1119,23,1119,26") ; '\t'
              + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1119,30,1119,32") ; ' '))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-whitespace", "1119,2,1119,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-whitespace", "1119,2,1119,33")
      ; fail

  trim-trailing-whitespace =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-trailing-whitespace", "1127,2,1128,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1128,4,1128,29")
    ; rtrim-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1128,16,1128,28") ; is-whitespace
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-trailing-whitespace", "1127,2,1128,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-trailing-whitespace", "1127,2,1128,29")
      ; fail

  trim-leading-whitespace =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-leading-whitespace", "1136,2,1137,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1137,4,1137,29")
    ; ltrim-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1137,16,1137,28") ; is-whitespace
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-leading-whitespace", "1136,2,1137,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-leading-whitespace", "1136,2,1137,29")
      ; fail

  trim-whitespace =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-whitespace", "1145,2,1146,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1146,4,1146,28")
    ; trim-chars(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1146,15,1146,27") ; is-whitespace
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-whitespace", "1145,2,1146,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "trim-whitespace", "1145,2,1146,28")
      ; fail


strategies
  shuffle-forced =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-forced", "1154,2,1158,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,6,1158,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,6,1157,71")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,6,1155,34")
          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,12,1155,33")
                  ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,12,1155,17") ; length)
                  ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,20,1155,33")
                  ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,21,1155,22") ; gt)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1155,27,1155,28") ; id>
                                                                                                                  , 1
                                                                                                                  )))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,6,1157,71")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,6,1156,57")
          ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,12,1156,56")
                  ; at-suffix(
                      s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,22,1156,55")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,22,1156,30")
                         ; ?[x, y|xs])
                      ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,33,1156,55")
                      ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,39,1156,54")
                              ; not(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,43,1156,53")
                                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1156,44,1156,45") ; eq)> (x, y)))
                    )))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,6,1157,71")
       ; rec x (
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,12,1157,70")
           ; {orig:
               s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,19,1157,69")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,19,1157,23") ; ?orig)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,26,1157,69")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,26,1157,32") ; shuffle)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,36,1157,68")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,36,1157,59")
                  ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,42,1157,58")
                          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,43,1157,44") ; eq)> ( orig
                                                                                                                          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,55,1157,56") ; id>
                                                                                                                          ))
                  < s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,63,1157,63") ; x
                  + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1157,67,1157,68") ; id)
             }
         )
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1158,7,1158,8") ; id)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-forced", "1154,2,1158,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-forced", "1154,2,1158,8")
      ; fail

  shuffle =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle", "1161,2,1165,13")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1162,6,1165,13")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1162,6,1162,19")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1162,12,1162,18") ; is-list))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1163,6,1165,13")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1163,6,1163,35")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1163,10,1163,34")
           ; !( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1163,13,1163,23") ; next-random> ()
              , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1163,31,1163,32") ; id>
              )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,6,1165,13")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,6,1164,37")
       ; sort-list(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,16,1164,36")
           ; SortL(
               s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,22,1164,35")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,22,1164,31")
                  ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,23,1164,25") ; Fst
                    , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,28,1164,30") ; Fst
                    ))
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1164,34,1164,35")
               ; gt
             )
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1165,6,1165,13")
    ; map(
        s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1165,10,1165,12") ; Snd
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle", "1161,2,1165,13")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle", "1161,2,1165,13")
      ; fail

  shuffle-word-mids =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-word-mids", "1168,2,1171,19")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1169,6,1171,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1169,6,1169,47")
       ; string-tokenize-keep-all(
         | [' ', '.', ',']
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1170,6,1171,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1170,6,1170,26")
       ; map(
           s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1170,10,1170,25") ; shuffle-word-mid
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1171,6,1171,19")
    ; concat-strings
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-word-mids", "1168,2,1171,19")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-word-mids", "1168,2,1171,19")
      ; fail

  shuffle-word-mid =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-word-mid", "1174,2,1182,52")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1175,5,1182,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1175,5,1175,20")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1175,11,1175,19") ; is-string))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,6,1182,51")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,6,1176,34")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,12,1176,33")
               ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,12,1176,17") ; strlen)
               ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,20,1176,33")
               ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,21,1176,22") ; lt)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1176,27,1176,28") ; id>
                                                                                                               , 3
                                                                                                               ))
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1177,6,1182,51")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1177,6,1177,19") ; explode-string)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1178,5,1182,51")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1178,5,1178,11")
             ; ?[i|cs])
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1179,5,1182,51")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1179,5,1179,16")
             ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1179,6,1179,12") ; reverse)> cs)
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1180,5,1182,51")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1180,5,1180,12")
             ; ?[l|mid])
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,5,1182,51")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,5,1181,55")
             ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,11,1181,54")
                     ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,11,1181,39")
                        ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,12,1181,34")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,12,1181,25") ; shuffle-forced)
                            ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1181,28,1181,34")
                            ; reverse)> mid) => shuffledmid))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1182,5,1182,51")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1182,6,1182,27")
              ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1182,6,1182,11") ; concat)
              ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1182,14,1182,27")
              ; implode-string)> [[i], shuffledmid, [l]])
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-word-mid", "1174,2,1182,52")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "shuffle-word-mid", "1174,2,1182,52")
      ; fail


strategies
  is-alphanum =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-alphanum", "1189,2,1189,32")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1189,16,1189,32")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1189,16,1189,21") ; is-num
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1189,25,1189,32") ; is-alpha)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-alphanum", "1189,2,1189,32")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-alphanum", "1189,2,1189,32")
      ; fail

  is-alpha =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-alpha", "1197,2,1197,31")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1197,13,1197,31")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1197,13,1197,20") ; is-upper
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1197,24,1197,31") ; is-lower)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-alpha", "1197,2,1197,31")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-alpha", "1197,2,1197,31")
      ; fail

  is-hexnum =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-hexnum", "1206,2,1212,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1207,6,1212,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1207,6,1207,12") ; is-char)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1209,8,1211,40")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1209,8,1209,13") ; is-num
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1210,8,1211,40")
         ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1210,8,1210,40")
            ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1210,14,1210,39")
                    ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1210,15,1210,21") ; leq-leq)> ( 'a'
                                                                                                                         , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1210,31,1210,32") ; id>
                                                                                                                         , 'f'
                                                                                                                         ))
            + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1211,8,1211,40")
              ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1211,14,1211,39")
                      ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1211,15,1211,21") ; leq-leq)> ( 'A'
                                                                                                                           , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1211,31,1211,32") ; id>
                                                                                                                           , 'F'
                                                                                                                           ))))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-hexnum", "1206,2,1212,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-hexnum", "1206,2,1212,6")
      ; fail

  is-num =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-num", "1218,2,1219,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1219,4,1219,36")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1219,10,1219,35")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1219,11,1219,17") ; leq-leq)> ( '0'
                                                                                                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1219,27,1219,28") ; id>
                                                                                                                 , '9'
                                                                                                                 ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-num", "1218,2,1219,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-num", "1218,2,1219,36")
      ; fail

  is-upper =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-upper", "1226,2,1227,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1227,4,1227,36")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1227,10,1227,35")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1227,11,1227,17") ; leq-leq)> ( 'A'
                                                                                                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1227,27,1227,28") ; id>
                                                                                                                 , 'Z'
                                                                                                                 ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-upper", "1226,2,1227,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-upper", "1226,2,1227,36")
      ; fail

  is-lower =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-lower", "1234,2,1235,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1235,4,1235,36")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1235,10,1235,35")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1235,11,1235,17") ; leq-leq)> ( 'a'
                                                                                                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1235,27,1235,28") ; id>
                                                                                                                 , 'z'
                                                                                                                 ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-lower", "1234,2,1235,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-lower", "1234,2,1235,36")
      ; fail

  is-ascii =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-ascii", "1245,2,1246,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1246,4,1246,36")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1246,10,1246,35")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1246,11,1246,17") ; leq-leq)> ( 32
                                                                                                                 , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1246,27,1246,28") ; id>
                                                                                                                 , 127
                                                                                                                 ))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-ascii", "1245,2,1246,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "is-ascii", "1245,2,1246,36")
      ; fail

  case-char(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "case-char", "1256,2,1256,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1256,17,1256,39")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1256,17,1256,36")
       ; ( s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1256,18,1256,25") ; to-upper
         , s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1256,28,1256,35") ; to-upper
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1256,39,1256,39")
    ; s
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "case-char", "1256,2,1256,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "case-char", "1256,2,1256,39")
      ; fail

  to-upper =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "to-upper", "1266,2,1267,36")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1267,4,1267,36")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1267,4,1267,11") ; is-lower
       < s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1267,15,1267,31")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1267,16,1267,19") ; subt)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1267,24,1267,25") ; id>
                                                                                                           , 32
                                                                                                           )
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1267,35,1267,36") ; id)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "to-upper", "1266,2,1267,36")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "to-upper", "1266,2,1267,36")
      ; fail

  to-lower =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "to-lower", "1277,2,1277,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1277,13,1277,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1277,13,1277,20") ; is-upper
       < s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1277,24,1277,40")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1277,25,1277,27") ; add)> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1277,33,1277,34") ; id>
                                                                                                          , 32
                                                                                                          )
       + s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1277,44,1277,45") ; id)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "to-lower", "1277,2,1277,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "to-lower", "1277,2,1277,45")
      ; fail

  string-replace(|old, new) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-replace", "1290,2,1294,19")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1291,6,1294,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1291,6,1291,50")
       ; !( []
          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1291,13,1291,26") ; explode-string>
          , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1291,31,1291,44") ; explode-string> old
          ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1292,6,1294,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1292,6,1292,83")
       ; internal-string-replace(
         | <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1292,32,1292,45") ; explode-string> old
         , <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1292,54,1292,77")
            ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1292,54,1292,67") ; explode-string)
            ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1292,71,1292,77")
            ; reverse> new
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1293,6,1294,19")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1293,6,1293,12") ; reverse)
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1294,6,1294,19")
    ; implode-string
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-replace", "1290,2,1294,19")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "string-replace", "1290,2,1294,19")
      ; fail


strategies
  internal-string-replace(|old, new) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace", "1299,2,1309,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1300,4,1309,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1300,4,1300,27")
       ; ?(pre, [hd|tl], cur))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1302,8,1308,43")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1302,8,1305,43")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1302,8,1302,25")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1302,8,1302,11") ; !cur) => [hd|ctl])
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1303,10,1305,43")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1303,10,1303,24")
          ; !(pre, tl, ctl))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1304,10,1305,43")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1304,10,1304,49")
          ; internal-string-replace-found(|old, new))
       ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1305,10,1305,43")
       ; internal-string-replace(|old, new)
       <+ s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1307,10,1308,43")
          ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1307,10,1307,33")
             ; !([hd|pre], tl, cur))
          ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1308,10,1308,43")
          ; internal-string-replace(|old, new))
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace", "1299,2,1309,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace", "1299,2,1309,6")
      ; fail

  internal-string-replace(|old, new):
    (pre, [], _) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace", "1312,2,1313,22")> pre
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace", "1312,2,1313,22")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace", "1312,2,1313,22")
             ; fail

  internal-string-replace-found(|old, new) =
    s-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace-found", "1316,2,1320,45")
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1317,4,1320,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1317,4,1317,27")
       ; ?(pre, [hd|tl], cur))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1318,6,1320,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1318,6,1318,25")
       ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1318,6,1318,9") ; !cur) => [hd|ctl])
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1319,6,1320,45")
    ; (s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1319,6,1319,20")
       ; !(pre, tl, ctl))
    ; s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1320,6,1320,45")
    ; internal-string-replace-found(|old, new)
    < s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace-found", "1316,2,1320,45")
    + s-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace-found", "1316,2,1320,45")
      ; fail

  internal-string-replace-found(|old, new):
    (pre, rest, []) -> <r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace-found", "1323,2,1324,52")> ( <s-step(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "1324,25,1324,28") ; conc> (new, pre)
                                                                                                                                              , rest
                                                                                                                                              , old
                                                                                                                                              )
    where r-enter(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace-found", "1323,2,1324,52")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/spec/term/string.str", "internal-string-replace-found", "1323,2,1324,52")
             ; fail