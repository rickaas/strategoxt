module sets-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-sets-test =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "main-sets-test", "8,2,16,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "9,4,16,4")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "9,15,9,42")
        ; !"Testsuite for IndexedSets"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "10,8,15,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "10,8,10,18") ; test-create)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "11,8,15,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "11,8,11,15") ; test-add)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "12,8,15,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "12,8,12,18") ; test-remove)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "13,8,15,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "13,8,13,17") ; test-clear)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "14,8,15,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "14,8,14,20") ; test-elements)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "15,8,15,20")
        ; test-fixpoint
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "main-sets-test", "8,2,16,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "main-sets-test", "8,2,16,4")
      ; fail


strategies
  test-create =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-create", "20,2,21,76")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,4,21,76")
    ; apply-and-check(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,20,21,30")
        ; !"new iset"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,33,21,40") ; new-iset
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,43,21,45")
        ; !()
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,48,21,75")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,48,21,61")
           ; ?IndexedSet(_))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "21,64,21,75")
        ; iset-destroy
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-create", "20,2,21,76")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-create", "20,2,21,76")
      ; fail

  test-add =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-add", "23,2,44,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "24,6,44,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "24,6,27,6")
       ; iset-apply-and-check(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "24,27,24,37")
           ; !"iset add"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "25,8,25,19")
           ; iset-add(|1)
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "26,8,26,24")
           ; iset-contains(|1)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "28,6,44,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "28,6,33,6")
       ; iset-apply-and-check(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "28,27,28,46")
           ; !"iset two elements"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "29,8,30,21")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "29,8,29,19")
              ; iset-add(|1))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "30,10,30,21")
           ; iset-add(|2)
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "31,8,32,26")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "31,8,31,24")
              ; iset-contains(|1))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "32,10,32,26")
           ; iset-contains(|2)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "34,6,44,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "34,6,38,6")
       ; iset-apply-and-check(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "34,27,34,64")
           ; !"iset add two identical elements (1)"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "35,8,36,21")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "35,8,35,19")
              ; iset-add(|1))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "36,10,36,21")
           ; iset-add(|1)
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "37,8,37,24")
           ; iset-contains(|1)
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "39,6,44,6")
    ; iset-apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "39,22,39,59")
        ; !"iset add two identical elements (2)"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "40,8,42,22")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "40,8,40,19")
           ; iset-add(|1))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "41,10,42,22")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "41,10,41,21")
           ; iset-add(|1))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "42,10,42,22")
        ; iset-elements
      | [1]
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-add", "23,2,44,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-add", "23,2,44,6")
      ; fail

  test-remove =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-remove", "46,2,58,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "47,6,58,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "47,6,51,6")
       ; iset-apply-and-check(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "47,27,47,40")
           ; !"iset remove"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "48,8,48,22")
           ; iset-remove(|1)
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "49,8,49,19")
           ; iset-add(|1)
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "50,8,50,29")
           ; not(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "50,12,50,28")
                 ; iset-contains(|1))
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "52,6,58,6")
    ; iset-apply-and-check(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "52,27,52,42")
        ; !"iset remove 2"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "53,8,53,22")
        ; iset-remove(|1)
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "54,8,55,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "54,8,54,19")
           ; iset-add(|1))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "55,10,55,21")
        ; iset-add(|2)
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "56,8,57,26")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "56,8,56,29")
           ; not(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "56,12,56,28")
                 ; iset-contains(|1)))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "57,10,57,26")
        ; iset-contains(|2)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-remove", "46,2,58,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-remove", "46,2,58,6")
      ; fail

  test-clear =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-clear", "60,2,72,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "61,6,72,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "61,6,66,6")
       ; iset-apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "61,22,61,36")
           ; !"iset clear 1"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "62,8,62,32")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "62,8,62,17") ; iset-clear)
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "62,20,62,32")
           ; iset-elements
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "63,8,64,21")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "63,8,63,19")
              ; iset-add(|1))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "64,10,64,21")
           ; iset-add(|2)
         | []
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "67,6,72,6")
    ; iset-apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "67,22,67,36")
        ; !"iset clear 2"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "68,8,68,46")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "68,8,68,17") ; iset-clear)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "68,20,68,46")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "68,20,68,31")
           ; iset-add(|3))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "68,34,68,46")
        ; iset-elements
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "69,8,70,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "69,8,69,19")
           ; iset-add(|1))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "70,10,70,21")
        ; iset-add(|2)
      | [3]
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-clear", "60,2,72,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-clear", "60,2,72,6")
      ; fail

  test-elements =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-elements", "74,2,89,6")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "75,6,89,6")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "75,6,80,6")
       ; iset-apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "75,22,75,41")
           ; !"iset elements (1)"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "76,8,76,31")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "76,8,76,20") ; iset-elements)
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "76,23,76,31")
           ; qsort(
               s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "76,29,76,30") ; lt
             )
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "77,8,78,21")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "77,8,77,19")
              ; iset-add(|1))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "78,10,78,21")
           ; iset-add(|2)
         | [1, 2]
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "81,6,89,6")
    ; iset-apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "81,22,81,41")
        ; !"iset elements (2)"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "82,8,82,31")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "82,8,82,20") ; iset-elements)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "82,23,82,31")
        ; qsort(
            s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "82,29,82,30") ; lt
          )
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "83,8,87,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "83,8,83,19")
           ; iset-add(|1))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "84,10,87,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "84,10,84,21")
           ; iset-add(|2))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "85,10,87,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "85,10,85,21")
           ; iset-add(|3))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "86,10,87,21")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "86,10,86,24")
           ; iset-remove(|2))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "87,10,87,21")
        ; iset-add(|4)
      | [1, 3, 4]
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-elements", "74,2,89,6")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-elements", "74,2,89,6")
      ; fail

  test-fixpoint =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-fixpoint", "91,2,118,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "92,4,118,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "92,4,97,4")
       ; iset-apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "92,20,92,37")
           ; !"iset-fixpoint 1"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "93,6,94,20")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "93,6,93,34")
              ; iset-fixpoint(
                  s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "93,20,93,33") ; FixPointHelper
                ))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "94,8,94,20")
           ; iset-elements
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "95,6,95,17")
           ; iset-add(|1)
         | [1, 2, 3, 4]
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "98,4,118,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "98,4,106,4")
       ; iset-apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "98,20,98,37")
           ; !"iset-fixpoint 2"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "99,6,100,20")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "99,6,99,34")
              ; iset-fixpoint(
                  s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "99,20,99,33") ; FixPointHelper
                ))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "100,8,100,20")
           ; iset-elements
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "101,6,104,19")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "101,6,101,17")
              ; iset-add(|1))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "102,8,104,19")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "102,8,102,19")
              ; iset-add(|2))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "103,8,104,19")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "103,8,103,19")
              ; iset-add(|3))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "104,8,104,19")
           ; iset-add(|4)
         | [1, 2, 3, 4]
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "107,4,118,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "107,4,112,4")
       ; iset-apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "107,20,107,37")
           ; !"iset-fixpoint 3"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "108,6,109,20")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "108,6,108,34")
              ; iset-fixpoint(
                  s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "108,20,108,33") ; FixPointHelper
                ))
           ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "109,8,109,20")
           ; iset-elements
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "110,6,110,7") ; id
         | []
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "113,4,118,4")
    ; iset-apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "113,20,113,37")
        ; !"iset-fixpoint 4"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "114,6,115,20")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "114,6,114,34")
           ; iset-fixpoint(
               s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "114,20,114,33") ; FixPointHelper
             ))
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "115,8,115,20")
        ; iset-elements
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "116,6,116,17")
        ; iset-add(|5)
      | [5]
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-fixpoint", "91,2,118,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "test-fixpoint", "91,2,118,4")
      ; fail

  FixPointHelper :
    1 -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "FixPointHelper", "120,2,120,29")> [2, 3]
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "FixPointHelper", "120,2,120,29")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "FixPointHelper", "120,2,120,29")
             ; fail

  FixPointHelper :
    3 -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "FixPointHelper", "121,2,121,26")> [4]
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "FixPointHelper", "121,2,121,26")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "FixPointHelper", "121,2,121,26")
             ; fail


strategies
  iset-apply-and-check(name, s, check) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-and-check", "128,2,129,43")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "129,4,129,43")
    ; iset-apply-and-check(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "129,25,129,28") ; name
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "129,31,129,32") ; id
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "129,35,129,35") ; s
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "129,38,129,42") ; check
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-and-check", "128,2,129,43")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-and-check", "128,2,129,43")
      ; fail

  iset-apply-and-check(name, s, init, check) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-and-check", "131,2,134,30")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "132,6,134,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "132,6,132,27")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "132,12,132,26")
               ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "132,12,132,19") ; new-iset) => set))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,6,134,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,6,133,48")
       ; apply-and-check(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,22,133,25") ; name
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,28,133,28") ; s
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,31,133,40")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,32,133,35") ; init)> set
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "133,43,133,47") ; check
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "134,6,134,30")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "134,12,134,29")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "134,13,134,24") ; iset-destroy)> set)
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-and-check", "131,2,134,30")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-and-check", "131,2,134,30")
      ; fail

  iset-apply-test(name, s|check) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-test", "136,2,137,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "137,4,137,39")
    ; iset-apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "137,20,137,23") ; name
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "137,26,137,27") ; id
      , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "137,30,137,30") ; s
      | check
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-test", "136,2,137,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-test", "136,2,137,39")
      ; fail

  iset-apply-test(name, s, init|check) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-test", "139,2,142,30")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "140,6,142,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "140,6,140,27")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "140,12,140,26")
               ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "140,12,140,19") ; new-iset) => set))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,6,142,30")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,6,141,44")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,17,141,20") ; name
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,23,141,23") ; s
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,26,141,35")
           ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,27,141,30") ; init)> set
         , s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "141,38,141,43") ; !check
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "142,6,142,30")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "142,12,142,29")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "142,13,142,24") ; iset-destroy)> set)
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-test", "139,2,142,30")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/sets-test.str", "iset-apply-test", "139,2,142,30")
      ; fail