module placeholder-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-placeholder-test =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "main-placeholder-test", "5,2,14,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "6,4,14,4")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "6,15,6,39")
        ; !"Placeholder test suite"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "7,6,13,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "7,6,7,16") ; test-make-1)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "8,6,13,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "8,6,8,16") ; test-make-2)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "9,6,13,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "9,6,9,15") ; test-get-1)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "10,6,13,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "10,6,10,15") ; test-get-2)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "11,6,13,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "11,6,11,14") ; test-is-1)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "12,6,13,29")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "12,6,12,14") ; test-is-2)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "13,6,13,29")
        ; test-term-deconstruction
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "main-placeholder-test", "5,2,14,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "main-placeholder-test", "5,2,14,4")
      ; fail

  test-make-1 =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-make-1", "16,2,21,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "17,4,21,4")
    ; apply-and-check(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "17,20,17,40")
        ; !"make a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "18,6,18,21") ; make-placeholder
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "19,6,19,7")
        ; !1
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "20,6,20,19") ; is-placeholder
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-make-1", "16,2,21,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-make-1", "16,2,21,4")
      ; fail

  test-make-2 =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-make-2", "23,2,28,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "24,4,28,4")
    ; apply-and-check(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "24,20,24,40")
        ; !"make a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "25,6,25,21") ; make-placeholder
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "26,6,26,9")
        ; !"a"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "27,6,27,19") ; is-placeholder
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-make-2", "23,2,28,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-make-2", "23,2,28,4")
      ; fail

  test-get-1 =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-get-1", "30,2,35,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "31,4,35,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "31,15,31,34")
        ; !"get a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "32,6,32,20") ; get-placeholder
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "33,6,33,25")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "33,7,33,22") ; make-placeholder)> 1
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "34,6,34,7")
        ; !1
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-get-1", "30,2,35,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-get-1", "30,2,35,4")
      ; fail

  test-get-2 =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-get-2", "37,2,41,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "38,4,41,4")
    ; apply-and-fail(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "38,19,38,59")
        ; !"get a placeholder of not a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "39,6,39,20") ; get-placeholder
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "40,6,40,7")
        ; !1
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-get-2", "37,2,41,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-get-2", "37,2,41,4")
      ; fail

  test-is-1 =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-is-1", "43,2,48,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "44,4,48,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "44,15,44,33")
        ; !"is a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "45,6,45,19") ; is-placeholder
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "46,6,46,25")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "46,7,46,22") ; make-placeholder)> 1
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "47,6,47,25")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "47,7,47,22") ; make-placeholder)> 1
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-is-1", "43,2,48,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-is-1", "43,2,48,4")
      ; fail

  test-is-2 =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-is-2", "50,2,55,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "51,4,55,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "51,15,51,33")
        ; !"is a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "52,6,52,35")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "52,6,52,19") ; is-placeholder)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "52,22,52,35")
        ; is-placeholder
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "53,6,53,25")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "53,7,53,22") ; make-placeholder)> 1
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "54,6,54,25")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "54,7,54,22") ; make-placeholder)> 1
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-is-2", "50,2,55,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-is-2", "50,2,55,4")
      ; fail

  test-term-deconstruction =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-term-deconstruction", "57,2,62,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "58,4,62,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "58,15,58,61")
        ; !"generic term deconstruction of a placeholder"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "59,6,59,26")
        ; \ s#(xs) -> (s, xs) \
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "60,6,60,25")
        ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "60,7,60,22") ; make-placeholder)> 1
      , s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "61,6,61,34")
        ; !( <s-step(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "61,9,61,24") ; make-placeholder> []
           , [1]
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-term-deconstruction", "57,2,62,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/placeholder-test.str", "test-term-deconstruction", "57,2,62,4")
      ; fail