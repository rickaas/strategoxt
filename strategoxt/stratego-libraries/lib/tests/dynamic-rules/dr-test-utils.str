module dr-test-utils

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  libstratego-sglr
  til/opt/til-propconst
  til/opt/til-dce
  til/opt/til-varunion


strategies
  apply-propconst-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "apply-propconst-test"
    , "29"
    , "2"
    , "30"
    , "114"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "30"
      , "4"
      , "30"
      , "114"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "30"
        , "15"
        , "30"
        , "18"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "30"
        , "21"
        , "30"
        , "66"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "30"
            , "45"
            , "30"
            , "53"
            )
            ; propconst
          | "PropConst"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "30"
        , "69"
        , "30"
        , "89"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "30"
            , "70"
            , "30"
            , "78"
            )
            ; parse-til)> in-program
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "30"
        , "92"
        , "30"
        , "113"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "30"
            , "93"
            , "30"
            , "101"
            )
            ; parse-til)> out-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-propconst-test"
      , "29"
      , "2"
      , "30"
      , "114"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-propconst-test"
      , "29"
      , "2"
      , "30"
      , "114"
      )
      ; fail

  applyf-propconst-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "applyf-propconst-test"
    , "32"
    , "2"
    , "33"
    , "55"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "33"
      , "4"
      , "33"
      , "55"
      )
    ; apply-propconst-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "33"
        , "25"
        , "33"
        , "28"
        )
        ; name
      | in-program
      , out-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-propconst-test"
      , "32"
      , "2"
      , "33"
      , "55"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-propconst-test"
      , "32"
      , "2"
      , "33"
      , "55"
      )
      ; fail

  fail-propconst-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "fail-propconst-test"
    , "35"
    , "2"
    , "36"
    , "103"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "36"
      , "4"
      , "36"
      , "103"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "36"
        , "15"
        , "36"
        , "31"
        )
        ; concat-fail(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "36"
            , "27"
            , "36"
            , "30"
            )
            ; name
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "36"
        , "34"
        , "36"
        , "79"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "36"
            , "58"
            , "36"
            , "66"
            )
            ; propconst
          | "PropConst"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "36"
        , "82"
        , "36"
        , "102"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "36"
            , "83"
            , "36"
            , "91"
            )
            ; parse-til)> in-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-propconst-test"
      , "35"
      , "2"
      , "36"
      , "103"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-propconst-test"
      , "35"
      , "2"
      , "36"
      , "103"
      )
      ; fail

  show-propconst-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "show-propconst-test"
    , "38"
    , "2"
    , "39"
    , "94"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "39"
      , "4"
      , "39"
      , "94"
      )
    ; apply-and-show(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "39"
        , "19"
        , "39"
        , "22"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "39"
        , "25"
        , "39"
        , "70"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "39"
            , "49"
            , "39"
            , "57"
            )
            ; propconst
          | "PropConst"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "39"
        , "73"
        , "39"
        , "93"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "39"
            , "74"
            , "39"
            , "82"
            )
            ; parse-til)> in-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "show-propconst-test"
      , "38"
      , "2"
      , "39"
      , "94"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "show-propconst-test"
      , "38"
      , "2"
      , "39"
      , "94"
      )
      ; fail


strategies
  apply-dce-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "apply-dce-test"
    , "43"
    , "2"
    , "44"
    , "129"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "44"
      , "4"
      , "44"
      , "129"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "44"
        , "15"
        , "44"
        , "18"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "44"
        , "21"
        , "44"
        , "81"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "44"
            , "45"
            , "44"
            , "55"
            )
            ; dce-program
          | ["VarNeeded", "VarUsed"]
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "44"
        , "84"
        , "44"
        , "104"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "44"
            , "85"
            , "44"
            , "93"
            )
            ; parse-til)> in-program
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "44"
        , "107"
        , "44"
        , "128"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "44"
            , "108"
            , "44"
            , "116"
            )
            ; parse-til)> out-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-dce-test"
      , "43"
      , "2"
      , "44"
      , "129"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-dce-test"
      , "43"
      , "2"
      , "44"
      , "129"
      )
      ; fail

  applyf-dce-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "applyf-dce-test"
    , "46"
    , "2"
    , "47"
    , "49"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "47"
      , "4"
      , "47"
      , "49"
      )
    ; apply-dce-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "47"
        , "19"
        , "47"
        , "22"
        )
        ; name
      | in-program
      , out-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-dce-test"
      , "46"
      , "2"
      , "47"
      , "49"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-dce-test"
      , "46"
      , "2"
      , "47"
      , "49"
      )
      ; fail

  fail-dce-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "fail-dce-test"
    , "49"
    , "2"
    , "50"
    , "118"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "50"
      , "4"
      , "50"
      , "118"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "50"
        , "15"
        , "50"
        , "31"
        )
        ; concat-fail(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "50"
            , "27"
            , "50"
            , "30"
            )
            ; name
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "50"
        , "34"
        , "50"
        , "94"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "50"
            , "58"
            , "50"
            , "68"
            )
            ; dce-program
          | ["VarNeeded", "VarUsed"]
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "50"
        , "97"
        , "50"
        , "117"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "50"
            , "98"
            , "50"
            , "106"
            )
            ; parse-til)> in-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-dce-test"
      , "49"
      , "2"
      , "50"
      , "118"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-dce-test"
      , "49"
      , "2"
      , "50"
      , "118"
      )
      ; fail

  show-dce-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "show-dce-test"
    , "52"
    , "2"
    , "53"
    , "109"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "53"
      , "4"
      , "53"
      , "109"
      )
    ; apply-and-show(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "53"
        , "19"
        , "53"
        , "22"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "53"
        , "25"
        , "53"
        , "85"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "53"
            , "49"
            , "53"
            , "59"
            )
            ; dce-program
          | ["VarNeeded", "VarUsed"]
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "53"
        , "88"
        , "53"
        , "108"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "53"
            , "89"
            , "53"
            , "97"
            )
            ; parse-til)> in-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "show-dce-test"
      , "52"
      , "2"
      , "53"
      , "109"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "show-dce-test"
      , "52"
      , "2"
      , "53"
      , "109"
      )
      ; fail


strategies
  apply-varunion-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "apply-varunion-test"
    , "57"
    , "2"
    , "58"
    , "112"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "58"
      , "4"
      , "58"
      , "112"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "58"
        , "15"
        , "58"
        , "18"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "58"
        , "21"
        , "58"
        , "64"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "58"
            , "45"
            , "58"
            , "52"
            )
            ; varunion
          | "VarUnion"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "58"
        , "67"
        , "58"
        , "87"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "58"
            , "68"
            , "58"
            , "76"
            )
            ; parse-til)> in-program
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "58"
        , "90"
        , "58"
        , "111"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "58"
            , "91"
            , "58"
            , "99"
            )
            ; parse-til)> out-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-varunion-test"
      , "57"
      , "2"
      , "58"
      , "112"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-varunion-test"
      , "57"
      , "2"
      , "58"
      , "112"
      )
      ; fail

  applyf-varunion-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "applyf-varunion-test"
    , "60"
    , "2"
    , "61"
    , "54"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "61"
      , "4"
      , "61"
      , "54"
      )
    ; apply-varunion-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "61"
        , "24"
        , "61"
        , "27"
        )
        ; name
      | in-program
      , out-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-varunion-test"
      , "60"
      , "2"
      , "61"
      , "54"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-varunion-test"
      , "60"
      , "2"
      , "61"
      , "54"
      )
      ; fail

  fail-varunion-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "fail-varunion-test"
    , "63"
    , "2"
    , "64"
    , "101"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "64"
      , "4"
      , "64"
      , "101"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "64"
        , "15"
        , "64"
        , "31"
        )
        ; concat-fail(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "64"
            , "27"
            , "64"
            , "30"
            )
            ; name
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "64"
        , "34"
        , "64"
        , "77"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "64"
            , "58"
            , "64"
            , "65"
            )
            ; varunion
          | "VarUnion"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "64"
        , "80"
        , "64"
        , "100"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "64"
            , "81"
            , "64"
            , "89"
            )
            ; parse-til)> in-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-varunion-test"
      , "63"
      , "2"
      , "64"
      , "101"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-varunion-test"
      , "63"
      , "2"
      , "64"
      , "101"
      )
      ; fail

  show-varunion-test(name|in-program, out-program) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "show-varunion-test"
    , "66"
    , "2"
    , "67"
    , "92"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "67"
      , "4"
      , "67"
      , "92"
      )
    ; apply-and-show(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "67"
        , "19"
        , "67"
        , "22"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "67"
        , "25"
        , "67"
        , "68"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "67"
            , "49"
            , "67"
            , "56"
            )
            ; varunion
          | "VarUnion"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "67"
        , "71"
        , "67"
        , "91"
        )
        ; <(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "67"
            , "72"
            , "67"
            , "80"
            )
            ; parse-til)> in-program
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "show-varunion-test"
      , "66"
      , "2"
      , "67"
      , "92"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "show-varunion-test"
      , "66"
      , "2"
      , "67"
      , "92"
      )
      ; fail


strategies
  apply-scope-test(name, s|result) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "apply-scope-test"
    , "71"
    , "2"
    , "72"
    , "68"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "72"
      , "4"
      , "72"
      , "68"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "72"
        , "15"
        , "72"
        , "18"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "72"
        , "21"
        , "72"
        , "53"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "72"
            , "45"
            , "72"
            , "45"
            )
            ; s
          | "Test"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "72"
        , "56"
        , "72"
        , "58"
        )
        ; !()
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "72"
        , "61"
        , "72"
        , "67"
        )
        ; !result
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-scope-test"
      , "71"
      , "2"
      , "72"
      , "68"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "apply-scope-test"
      , "71"
      , "2"
      , "72"
      , "68"
      )
      ; fail

  applyf-scope-test(name, s|result) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "applyf-scope-test"
    , "74"
    , "2"
    , "75"
    , "37"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "75"
      , "4"
      , "75"
      , "37"
      )
    ; apply-scope-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "75"
        , "21"
        , "75"
        , "24"
        )
        ; name
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "75"
        , "27"
        , "75"
        , "27"
        )
        ; s
      | result
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-scope-test"
      , "74"
      , "2"
      , "75"
      , "37"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "applyf-scope-test"
      , "74"
      , "2"
      , "75"
      , "37"
      )
      ; fail

  fail-scope-test(name, s|result) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "fail-scope-test"
    , "77"
    , "2"
    , "78"
    , "72"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "78"
      , "4"
      , "78"
      , "72"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "78"
        , "15"
        , "78"
        , "31"
        )
        ; concat-fail(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "78"
            , "27"
            , "78"
            , "30"
            )
            ; name
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "78"
        , "34"
        , "78"
        , "66"
        )
        ; dr-ignore-state-cleanup(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "78"
            , "58"
            , "78"
            , "58"
            )
            ; s
          | "Test"
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "78"
        , "69"
        , "78"
        , "71"
        )
        ; !()
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-scope-test"
      , "77"
      , "2"
      , "78"
      , "72"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "fail-scope-test"
      , "77"
      , "2"
      , "78"
      , "72"
      )
      ; fail


strategies
  parse-til =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "parse-til"
    , "82"
    , "2"
    , "83"
    , "50"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "83"
      , "4"
      , "83"
      , "50"
      )
    ; parse-string(
      | <s-step(
         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
         , "83"
         , "19"
         , "83"
         , "37"
         )
         ; get-til-parse-table>
      , "Program"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "parse-til"
      , "82"
      , "2"
      , "83"
      , "50"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "parse-til"
      , "82"
      , "2"
      , "83"
      , "50"
      )
      ; fail

  get-til-parse-table =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "get-til-parse-table"
    , "85"
    , "2"
    , "89"
    , "42"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "86"
      , "4"
      , "89"
      , "42"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "86"
       , "4"
       , "86"
       , "20"
       )
       ; MemoTILParseTable
       <+ s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
          , "87"
          , "7"
          , "89"
          , "42"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
             , "87"
             , "7"
             , "87"
             , "37"
             )
             ; <(s-step(
                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                 , "87"
                 , "8"
                 , "87"
                 , "19"
                 )
                 ; ReadFromFile)> "til/syn/TIL.tbl")
          ; s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "88"
            , "9"
            , "89"
            , "42"
            )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
             , "88"
             , "9"
             , "88"
             , "30"
             )
             ; (s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                , "88"
                , "9"
                , "88"
                , "24"
                )
                ; open-parse-table) => pt)
          ; s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "89"
            , "9"
            , "89"
            , "42"
            )
          ; rules ( MemoTILParseTable :
                      _ -> pt ))
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "get-til-parse-table"
      , "85"
      , "2"
      , "89"
      , "42"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "get-til-parse-table"
      , "85"
      , "2"
      , "89"
      , "42"
      )
      ; fail


strategies
  init-rule-set =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "init-rule-set"
    , "97"
    , "2"
    , "98"
    , "27"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "98"
      , "4"
      , "98"
      , "27"
      )
    ; dr-get-rule-set(|"Test")
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "init-rule-set"
      , "97"
      , "2"
      , "98"
      , "27"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "init-rule-set"
      , "97"
      , "2"
      , "98"
      , "27"
      )
      ; fail

  rule-scope =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "rule-scope"
    , "100"
    , "2"
    , "101"
    , "26"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "101"
      , "4"
      , "101"
      , "26"
      )
    ; dr-begin-scope(|"Test")
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "100"
      , "2"
      , "101"
      , "26"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "100"
      , "2"
      , "101"
      , "26"
      )
      ; fail

  rule-scope(|label) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "rule-scope"
    , "103"
    , "2"
    , "105"
    , "35"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "104"
      , "4"
      , "105"
      , "35"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "104"
       , "4"
       , "104"
       , "13"
       )
       ; rule-scope)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "105"
      , "6"
      , "105"
      , "35"
      )
    ; dr-label-scope(|"Test", label)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "103"
      , "2"
      , "105"
      , "35"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "103"
      , "2"
      , "105"
      , "35"
      )
      ; fail

  rule-scope(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "rule-scope"
    , "107"
    , "2"
    , "109"
    , "37"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "108"
      , "4"
      , "109"
      , "37"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "108"
       , "4"
       , "108"
       , "13"
       )
       ; rule-scope)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "109"
      , "6"
      , "109"
      , "37"
      )
    ; dr-set-rule(|"Test", key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "107"
      , "2"
      , "109"
      , "37"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "107"
      , "2"
      , "109"
      , "37"
      )
      ; fail

  rule-scope(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "rule-scope"
    , "111"
    , "2"
    , "113"
    , "44"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "112"
      , "4"
      , "113"
      , "44"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "112"
       , "4"
       , "112"
       , "21"
       )
       ; rule-scope(|label))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "113"
      , "6"
      , "113"
      , "44"
      )
    ; dr-set-rule(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "111"
      , "2"
      , "113"
      , "44"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "rule-scope"
      , "111"
      , "2"
      , "113"
      , "44"
      )
      ; fail

  change-set =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "change-set"
    , "115"
    , "2"
    , "116"
    , "31"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "116"
      , "4"
      , "116"
      , "31"
      )
    ; dr-start-change-set(|"Test")
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set"
      , "115"
      , "2"
      , "116"
      , "31"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set"
      , "115"
      , "2"
      , "116"
      , "31"
      )
      ; fail

  change-set(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "change-set"
    , "118"
    , "2"
    , "120"
    , "37"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "119"
      , "4"
      , "120"
      , "37"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "119"
       , "4"
       , "119"
       , "13"
       )
       ; change-set)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "120"
      , "6"
      , "120"
      , "37"
      )
    ; dr-set-rule(|"Test", key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set"
      , "118"
      , "2"
      , "120"
      , "37"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set"
      , "118"
      , "2"
      , "120"
      , "37"
      )
      ; fail

  change-set(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "change-set"
    , "122"
    , "2"
    , "124"
    , "44"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "123"
      , "4"
      , "124"
      , "44"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "123"
       , "4"
       , "123"
       , "13"
       )
       ; change-set)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "124"
      , "6"
      , "124"
      , "44"
      )
    ; dr-set-rule(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set"
      , "122"
      , "2"
      , "124"
      , "44"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set"
      , "122"
      , "2"
      , "124"
      , "44"
      )
      ; fail

  change-set-vis(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "change-set-vis"
    , "126"
    , "2"
    , "128"
    , "45"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "127"
      , "4"
      , "128"
      , "45"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "127"
       , "4"
       , "127"
       , "13"
       )
       ; change-set)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "128"
      , "6"
      , "128"
      , "45"
      )
    ; dr-set-rule-vis(|"Test", (), key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set-vis"
      , "126"
      , "2"
      , "128"
      , "45"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set-vis"
      , "126"
      , "2"
      , "128"
      , "45"
      )
      ; fail

  change-set-vis(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "change-set-vis"
    , "130"
    , "2"
    , "132"
    , "48"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "131"
      , "4"
      , "132"
      , "48"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "131"
       , "4"
       , "131"
       , "13"
       )
       ; change-set)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "132"
      , "6"
      , "132"
      , "48"
      )
    ; dr-set-rule-vis(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set-vis"
      , "130"
      , "2"
      , "132"
      , "48"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "change-set-vis"
      , "130"
      , "2"
      , "132"
      , "48"
      )
      ; fail

  set(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "set"
    , "134"
    , "2"
    , "135"
    , "35"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "135"
      , "4"
      , "135"
      , "35"
      )
    ; dr-set-rule(|"Test", key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set"
      , "134"
      , "2"
      , "135"
      , "35"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set"
      , "134"
      , "2"
      , "135"
      , "35"
      )
      ; fail

  set(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "set"
    , "137"
    , "2"
    , "138"
    , "42"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "138"
      , "4"
      , "138"
      , "42"
      )
    ; dr-set-rule(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set"
      , "137"
      , "2"
      , "138"
      , "42"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set"
      , "137"
      , "2"
      , "138"
      , "42"
      )
      ; fail

  set-vis(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "set-vis"
    , "140"
    , "2"
    , "141"
    , "43"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "141"
      , "4"
      , "141"
      , "43"
      )
    ; dr-set-rule-vis(|"Test", (), key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set-vis"
      , "140"
      , "2"
      , "141"
      , "43"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set-vis"
      , "140"
      , "2"
      , "141"
      , "43"
      )
      ; fail

  set-vis(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "set-vis"
    , "143"
    , "2"
    , "144"
    , "46"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "144"
      , "4"
      , "144"
      , "46"
      )
    ; dr-set-rule-vis(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set-vis"
      , "143"
      , "2"
      , "144"
      , "46"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "set-vis"
      , "143"
      , "2"
      , "144"
      , "46"
      )
      ; fail

  add(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "add"
    , "146"
    , "2"
    , "147"
    , "35"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "147"
      , "4"
      , "147"
      , "35"
      )
    ; dr-add-rule(|"Test", key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add"
      , "146"
      , "2"
      , "147"
      , "35"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add"
      , "146"
      , "2"
      , "147"
      , "35"
      )
      ; fail

  add(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "add"
    , "149"
    , "2"
    , "150"
    , "42"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "150"
      , "4"
      , "150"
      , "42"
      )
    ; dr-add-rule(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add"
      , "149"
      , "2"
      , "150"
      , "42"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add"
      , "149"
      , "2"
      , "150"
      , "42"
      )
      ; fail

  add-vis(|key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "add-vis"
    , "152"
    , "2"
    , "153"
    , "43"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "153"
      , "4"
      , "153"
      , "43"
      )
    ; dr-add-rule-vis(|"Test", (), key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add-vis"
      , "152"
      , "2"
      , "153"
      , "43"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add-vis"
      , "152"
      , "2"
      , "153"
      , "43"
      )
      ; fail

  add-vis(|label, key, value) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "add-vis"
    , "155"
    , "2"
    , "156"
    , "46"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "156"
      , "4"
      , "156"
      , "46"
      )
    ; dr-add-rule-vis(|"Test", label, key, value)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add-vis"
      , "155"
      , "2"
      , "156"
      , "46"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "add-vis"
      , "155"
      , "2"
      , "156"
      , "46"
      )
      ; fail

  undef-rule(|key) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "undef-rule"
    , "158"
    , "2"
    , "159"
    , "33"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "159"
      , "4"
      , "159"
      , "33"
      )
    ; dr-undefine-rule(|"Test", key)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "undef-rule"
      , "158"
      , "2"
      , "159"
      , "33"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "undef-rule"
      , "158"
      , "2"
      , "159"
      , "33"
      )
      ; fail

  undef-rule(|label, key) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "undef-rule"
    , "161"
    , "2"
    , "162"
    , "40"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "162"
      , "4"
      , "162"
      , "40"
      )
    ; dr-undefine-rule(|"Test", label, key)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "undef-rule"
      , "161"
      , "2"
      , "162"
      , "40"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "undef-rule"
      , "161"
      , "2"
      , "162"
      , "40"
      )
      ; fail

  lookup-rule(|key) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "lookup-rule"
    , "164"
    , "2"
    , "165"
    , "31"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "165"
      , "4"
      , "165"
      , "31"
      )
    ; dr-lookup-rule(|"Test", key)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "lookup-rule"
      , "164"
      , "2"
      , "165"
      , "31"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "lookup-rule"
      , "164"
      , "2"
      , "165"
      , "31"
      )
      ; fail

  lookup-all-rules(|key) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "lookup-all-rules"
    , "167"
    , "2"
    , "168"
    , "36"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "168"
      , "4"
      , "168"
      , "36"
      )
    ; dr-lookup-all-rules(|"Test", key)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "lookup-all-rules"
      , "167"
      , "2"
      , "168"
      , "36"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "lookup-all-rules"
      , "167"
      , "2"
      , "168"
      , "36"
      )
      ; fail

  lookup-rule-in-scope(|label, key) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "lookup-rule-in-scope"
    , "170"
    , "2"
    , "172"
    , "64"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "171"
      , "4"
      , "172"
      , "64"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "171"
       , "4"
       , "171"
       , "27"
       )
       ; dr-get-rule-set(|"Test"))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "172"
      , "6"
      , "172"
      , "64"
      )
    ; dr-lookup-rule-in-scope(
      | key
      , <s-step(
         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
         , "172"
         , "37"
         , "172"
         , "62"
         )
         ; get-first-scope-id(|label)>
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "lookup-rule-in-scope"
      , "170"
      , "2"
      , "172"
      , "64"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "lookup-rule-in-scope"
      , "170"
      , "2"
      , "172"
      , "64"
      )
      ; fail

  get-first-scope-id(|label) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "get-first-scope-id"
    , "174"
    , "2"
    , "175"
    , "86"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "175"
      , "4"
      , "175"
      , "86"
      )
    ; fetch-elem(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "175"
        , "15"
        , "175"
        , "85"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
           , "175"
           , "15"
           , "175"
           , "64"
           )
           ; RuleScope(
               s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "175"
               , "25"
               , "175"
               , "45"
               )
               ; iset-contains(|label)
             , s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "175"
               , "48"
               , "175"
               , "63"
               )
               ; ?Hashtable(
                    <s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                     , "175"
                     , "60"
                     , "175"
                     , "61"
                     )
                     ; id>
                  )
             ))
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
          , "175"
          , "67"
          , "175"
          , "85"
          )
        ; ?RuleScope(
             _
           , <s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "175"
              , "82"
              , "175"
              , "83"
              )
              ; id>
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "get-first-scope-id"
      , "174"
      , "2"
      , "175"
      , "86"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "get-first-scope-id"
      , "174"
      , "2"
      , "175"
      , "86"
      )
      ; fail


strategies
  dr-ignore-state-cleanup(s|rname) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "dr-ignore-state-cleanup"
    , "179"
    , "2"
    , "181"
    , "39"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "180"
      , "4"
      , "181"
      , "39"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "180"
       , "4"
       , "180"
       , "34"
       )
       ; where(s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "180"
               , "11"
               , "180"
               , "33"
               )
               ; <(s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                   , "180"
                   , "12"
                   , "180"
                   , "27"
                   )
                   ; not(s-step(
                         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                         , "180"
                         , "16"
                         , "180"
                         , "26"
                         )
                         ; (s-step(
                            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                            , "180"
                            , "16"
                            , "180"
                            , "19"
                            )
                            ; ?[_]
                            <+ s-step(
                               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                               , "180"
                               , "24"
                               , "180"
                               , "26"
                               )
                               ; ?[])))> rname))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "181"
      , "6"
      , "181"
      , "39"
      )
    ; dr-ignore-state-cleanup(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "181"
        , "30"
        , "181"
        , "30"
        )
        ; s
      | [rname]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "dr-ignore-state-cleanup"
      , "179"
      , "2"
      , "181"
      , "39"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "dr-ignore-state-cleanup"
      , "179"
      , "2"
      , "181"
      , "39"
      )
      ; fail

  dr-ignore-state-cleanup(s|rnames) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "dr-ignore-state-cleanup"
    , "183"
    , "2"
    , "193"
    , "6"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "184"
      , "4"
      , "193"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "184"
       , "4"
       , "184"
       , "32"
       )
       ; where(s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "184"
               , "11"
               , "184"
               , "31"
               )
               ; <(s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                   , "184"
                   , "13"
                   , "184"
                   , "23"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                      , "184"
                      , "13"
                      , "184"
                      , "16"
                      )
                      ; ?[_]
                      <+ s-step(
                         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                         , "184"
                         , "21"
                         , "184"
                         , "23"
                         )
                         ; ?[]))> rnames))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "185"
      , "6"
      , "193"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "185"
       , "6"
       , "188"
       , "6"
       )
       ; where(s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "186"
               , "8"
               , "187"
               , "48"
               )
               ; (s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                  , "186"
                  , "8"
                  , "186"
                  , "35"
                  )
                  ; <(s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                      , "186"
                      , "9"
                      , "186"
                      , "28"
                      )
                      ; map(
                          s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                          , "186"
                          , "13"
                          , "186"
                          , "27"
                          )
                          ; dr-new-rule-set
                        ))> rnames)
               ; s-step(
                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                 , "187"
                 , "10"
                 , "187"
                 , "48"
                 )
               ; (s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                  , "187"
                  , "10"
                  , "187"
                  , "41"
                  )
                  ; zip(
                      s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                      , "187"
                      , "14"
                      , "187"
                      , "31"
                      )
                      ; dr-switch-rule-set
                    | rnames
                    )) => rss))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "189"
      , "6"
      , "193"
      , "6"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "189"
       , "6"
       , "189"
       , "6"
       )
       ; s)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "190"
      , "6"
      , "193"
      , "6"
      )
    ; where(s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "191"
            , "8"
            , "192"
            , "60"
            )
            ; (s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "191"
               , "8"
               , "191"
               , "44"
               )
               ; <(s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                   , "191"
                   , "9"
                   , "191"
                   , "40"
                   )
                   ; zip(
                       s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                       , "191"
                       , "13"
                       , "191"
                       , "30"
                       )
                       ; dr-switch-rule-set
                     | rnames
                     ))> rss)
            ; s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "192"
              , "10"
              , "192"
              , "60"
              )
            ; map(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                , "192"
                , "14"
                , "192"
                , "59"
                )
                ; map(
                    s-step(
                    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                    , "192"
                    , "18"
                    , "192"
                    , "58"
                    )
                    ; (s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                       , "192"
                       , "18"
                       , "192"
                       , "33"
                       )
                       ; dr-destroy-scope
                       <+ s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                          , "192"
                          , "38"
                          , "192"
                          , "58"
                          )
                          ; dr-destroy-change-set)
                  )
              ))
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "dr-ignore-state-cleanup"
      , "183"
      , "2"
      , "193"
      , "6"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "dr-ignore-state-cleanup"
      , "183"
      , "2"
      , "193"
      , "6"
      )
      ; fail

  concat-fail(name) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "concat-fail"
    , "195"
    , "2"
    , "196"
    , "59"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "196"
      , "4"
      , "196"
      , "59"
      )
    ; <(s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "196"
        , "5"
        , "196"
        , "18"
        )
        ; concat-strings)> [ <s-step(
                              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                              , "196"
                              , "22"
                              , "196"
                              , "25"
                              )
                              ; name>
                           , " (THIS TEST ACTUALLY FAILS!)"
                           ]
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "concat-fail"
      , "195"
      , "2"
      , "196"
      , "59"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "concat-fail"
      , "195"
      , "2"
      , "196"
      , "59"
      )
      ; fail

  separation-message(|msg) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "separation-message"
    , "198"
    , "2"
    , "199"
    , "36"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "199"
      , "4"
      , "199"
      , "36"
      )
    ; separation-message(|msg, "=", 80)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "separation-message"
      , "198"
      , "2"
      , "199"
      , "36"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "separation-message"
      , "198"
      , "2"
      , "199"
      , "36"
      )
      ; fail

  description-message(|msg) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "description-message"
    , "201"
    , "2"
    , "202"
    , "37"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "202"
      , "4"
      , "202"
      , "37"
      )
    ; description-message(|msg, "=", 80)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "description-message"
      , "201"
      , "2"
      , "202"
      , "37"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "description-message"
      , "201"
      , "2"
      , "202"
      , "37"
      )
      ; fail

  separation-message(|msg, fill-char, length) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "separation-message"
    , "215"
    , "2"
    , "216"
    , "53"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "216"
      , "4"
      , "216"
      , "53"
      )
    ; custom-message(|msg, fill-char, fill-char, length)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "separation-message"
      , "215"
      , "2"
      , "216"
      , "53"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "separation-message"
      , "215"
      , "2"
      , "216"
      , "53"
      )
      ; fail

  description-message(|msg, end-char, length) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "description-message"
    , "230"
    , "2"
    , "231"
    , "46"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "231"
      , "4"
      , "231"
      , "46"
      )
    ; custom-message(|msg, " ", end-char, length)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "description-message"
      , "230"
      , "2"
      , "231"
      , "46"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "description-message"
      , "230"
      , "2"
      , "231"
      , "46"
      )
      ; fail

  custom-message(|msg, fill-char, end-char, length) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
    , "custom-message"
    , "236"
    , "2"
    , "246"
    , "12"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "237"
      , "4"
      , "246"
      , "12"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "237"
       , "5"
       , "237"
       , "35"
       )
       ; (s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
          , "237"
          , "5"
          , "237"
          , "20"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "237"
              , "6"
              , "237"
              , "8"
              )
              ; geq)> (length, 8)
          < s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "237"
            , "24"
            , "237"
            , "30"
            )
            ; !length
          + s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "237"
            , "34"
            , "237"
            , "35"
            )
            ; !8))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "238"
      , "6"
      , "246"
      , "12"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "238"
       , "6"
       , "238"
       , "25"
       )
       ; (s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
          , "238"
          , "6"
          , "238"
          , "20"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "238"
              , "7"
              , "238"
              , "10"
              )
              ; subt)> ( <s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                          , "238"
                          , "14"
                          , "238"
                          , "15"
                          )
                          ; id>
                       , 7
                       )) => l)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "239"
      , "6"
      , "246"
      , "12"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "239"
       , "6"
       , "239"
       , "42"
       )
       ; (s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
          , "239"
          , "6"
          , "239"
          , "34"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "239"
              , "7"
              , "239"
              , "10"
              )
              ; subt)> ( l
                       , <s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                          , "239"
                          , "17"
                          , "239"
                          , "29"
                          )
                          ; string-length> msg
                       )) => diff)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "240"
      , "6"
      , "246"
      , "12"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
       , "240"
       , "7"
       , "244"
       , "67"
       )
       ; (s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
          , "240"
          , "7"
          , "240"
          , "19"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "240"
              , "8"
              , "240"
              , "9"
              )
              ; lt)> (diff, 0)
          < s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "241"
            , "9"
            , "242"
            , "65"
            )
            ; (s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "241"
               , "9"
               , "241"
               , "53"
               )
               ; <(s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                   , "241"
                   , "10"
                   , "241"
                   , "49"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                      , "241"
                      , "10"
                      , "241"
                      , "23"
                      )
                      ; explode-string)
                   ; s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                     , "241"
                     , "26"
                     , "241"
                     , "49"
                     )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                      , "241"
                      , "26"
                      , "241"
                      , "33"
                      )
                      ; take(|l))
                   ; s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                     , "241"
                     , "36"
                     , "241"
                     , "49"
                     )
                   ; implode-string)> msg)
            ; s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "242"
              , "11"
              , "242"
              , "65"
              )
            ; <(s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                , "242"
                , "12"
                , "242"
                , "25"
                )
                ; concat-strings)> [ end-char
                                   , " "
                                   , <s-step(
                                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                                      , "242"
                                      , "44"
                                      , "242"
                                      , "45"
                                      )
                                      ; id>
                                   , "... "
                                   , end-char
                                   ]
          + s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
            , "243"
            , "9"
            , "244"
            , "67"
            )
            ; (s-step(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
               , "243"
               , "9"
               , "243"
               , "47"
               )
               ; <(s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                   , "243"
                   , "10"
                   , "243"
                   , "29"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                      , "243"
                      , "10"
                      , "243"
                      , "13"
                      )
                      ; copy)
                   ; s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                     , "243"
                     , "16"
                     , "243"
                     , "29"
                     )
                   ; concat-strings)> (diff, fill-char))
            ; s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
              , "244"
              , "11"
              , "244"
              , "67"
              )
            ; <(s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                , "244"
                , "12"
                , "244"
                , "25"
                )
                ; concat-strings)> [ end-char
                                   , " "
                                   , msg
                                   , " "
                                   , <s-step(
                                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
                                      , "244"
                                      , "54"
                                      , "244"
                                      , "55"
                                      )
                                      ; id>
                                   , end-char
                                   ]))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "246"
      , "6"
      , "246"
      , "12"
      )
    ; say(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
        , "246"
        , "10"
        , "246"
        , "11"
        )
        ; id
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "custom-message"
      , "236"
      , "2"
      , "246"
      , "12"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-test-utils.str"
      , "custom-message"
      , "236"
      , "2"
      , "246"
      , "12"
      )
      ; fail