module dr-varunion-tests

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  dr-test-utils


strategies
  main =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
    , "main"
    , "7"
    , "2"
    , "8"
    , "17"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "8"
      , "4"
      , "8"
      , "17"
      )
    ; varunion-tests
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "main"
      , "7"
      , "2"
      , "8"
      , "17"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "main"
      , "7"
      , "2"
      , "8"
      , "17"
      )
      ; fail

  varunion-tests =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
    , "varunion-tests"
    , "10"
    , "2"
    , "13"
    , "20"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "11"
      , "4"
      , "13"
      , "20"
      )
    ; test-suite(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
        , "11"
        , "15"
        , "11"
        , "96"
        )
        ; !"Dynamic Rules Library -- Var Union (meaningless trasformation for testing only)"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
        , "12"
        , "6"
        , "13"
        , "19"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "12"
           , "6"
           , "12"
           , "19"
           )
           ; vu-basic-tests)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
          , "13"
          , "6"
          , "13"
          , "19"
          )
        ; vu-break-tests
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "varunion-tests"
      , "10"
      , "2"
      , "13"
      , "20"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "varunion-tests"
      , "10"
      , "2"
      , "13"
      , "20"
      )
      ; fail


strategies
  vu-basic-tests =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
    , "vu-basic-tests"
    , "17"
    , "2"
    , "46"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "17"
      , "19"
      , "46"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "17"
       , "19"
       , "17"
       , "20"
       )
       ; id)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "19"
      , "4"
      , "46"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "19"
       , "4"
       , "24"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "19"
           , "24"
           , "19"
           , "51"
           )
           ; !"Check basic union test #1"
         | "var x; x := 1;
       f(x);"
         , "var x; x := 1;
       f(1);"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "26"
      , "4"
      , "46"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "26"
       , "4"
       , "33"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "26"
           , "24"
           , "26"
           , "51"
           )
           ; !"Check basic union test #2"
         | "var x;
       if c() then x := 1; else x := 2; end
       f(x);"
         , "var x;
       if c() then x := 1; else x := 2; end
       f(selectx(2, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "35"
      , "4"
      , "46"
      , "4"
      )
    ; apply-varunion-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
        , "35"
        , "24"
        , "35"
        , "51"
        )
        ; !"Check basic union test #3"
      | "var x; x := 1;
       while c() do
         if c() then x := 2; end
       end
       f(x);"
      , "var x; x := 1;
       while c() do
         if c() then x := 2; end
       end
       f(selectx(2, 1));"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "vu-basic-tests"
      , "17"
      , "2"
      , "46"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "vu-basic-tests"
      , "17"
      , "2"
      , "46"
      , "4"
      )
      ; fail


strategies
  vu-break-tests =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
    , "vu-break-tests"
    , "50"
    , "2"
    , "534"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "50"
      , "19"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "50"
       , "19"
       , "50"
       , "20"
       )
       ; id)
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "52"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "52"
       , "4"
       , "67"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "52"
           , "24"
           , "52"
           , "51"
           )
           ; !"Check break union test #1"
         | "var x; x := 1;
       while c() do
         if c() then x := 2; break; end
         if c() then x := 3; break; end
         x := 1;
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         if c() then x := 2; break; end
         if c() then x := 3; break; end
         x := 1;
       end
       f(selectx(1, 3, 2));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "69"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "69"
       , "4"
       , "88"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "69"
           , "24"
           , "69"
           , "51"
           )
           ; !"Check break union test #2"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 1; break;
         else if c() then x := 1; else x := 1; break; end
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(1);
         if c() then x := 1; break;
         else if c() then x := 1; else x := 1; break; end
         end
         f(1);
       end
       f(1);"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "90"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "90"
       , "4"
       , "109"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "90"
           , "24"
           , "90"
           , "51"
           )
           ; !"Check break union test #3"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 2; break;
         else if c() then x := 1; else x := 2; break; end
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(1);
         if c() then x := 2; break;
         else if c() then x := 1; else x := 2; break; end
         end
         f(1);
       end
       f(selectx(1, 2));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "111"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "111"
       , "4"
       , "130"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "111"
           , "24"
           , "111"
           , "51"
           )
           ; !"Check break union test #4"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 1; break;
         else if c() then x := 2; else x := 1; break; end
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(selectx(2, 1));
         if c() then x := 1; break;
         else if c() then x := 2; else x := 1; break; end
         end
         f(2);
       end
       f(selectx(2, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "132"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "132"
       , "4"
       , "151"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "132"
           , "24"
           , "132"
           , "51"
           )
           ; !"Check break union test #5"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 1; break;
         else if c() then x := 2; else x := 3; break; end
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(selectx(2, 1));
         if c() then x := 1; break;
         else if c() then x := 2; else x := 3; break; end
         end
         f(2);
       end
       f(selectx(2, 3, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "153"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "153"
       , "4"
       , "172"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "153"
           , "24"
           , "153"
           , "51"
           )
           ; !"Check break union test #6"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 2; break;
         else if c() then x := 1; else x := 3; break; end
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(1);
         if c() then x := 2; break;
         else if c() then x := 1; else x := 3; break; end
         end
         f(1);
       end
       f(selectx(1, 3, 2));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "174"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "174"
       , "4"
       , "197"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "174"
           , "24"
           , "174"
           , "60"
           )
           ; !"Check break to label union test #1"
         | "var x; x := 1;
       l1: while c() do
         if c() then x := 1; break; else x := 1; end
         f(x); x := 2;
         l2 : while c() do
           if c() then x := 3; break l1; end
           x := 2;
         end
         f(x); x := 1;
       end
       f(x);"
         , "var x; x := 1;
       l1: while c() do
         if c() then x := 1; break; else x := 1; end
         f(1); x := 2;
         l2 : while c() do
           if c() then x := 3; break l1; end
           x := 2;
         end
         f(2); x := 1;
       end
       f(selectx(3, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "199"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "199"
       , "4"
       , "240"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "199"
           , "24"
           , "199"
           , "60"
           )
           ; !"Check break to label union test #2"
         | "var x;
       x := 1;
       l1: while c() do
         if c() then x := 0; break l1; else x := 1; end
         f(x); x := 2;
         l2 : while c() do
           if c() then x := 1; break l1; end
           if c() then x := 6; break l2; end
           f(x); x := 3;
           l3: while c() do
             if c() then x := 3; break l1; end
             if c() then x := 4; break l2; end
             if c() then x := 5; break l3; end
             f(x); x := 3;
           end
           f(x); x := 2;
         end
         f(x); x := 1;
       end
       f(x);"
         , "var x;
       x := 1;
       l1: while c() do
         if c() then x := 0; break l1; else x := 1; end
         f(1); x := 2;
         l2 : while c() do
           if c() then x := 1; break l1; end
           if c() then x := 6; break l2; end
           f(2); x := 3;
           l3: while c() do
             if c() then x := 3; break l1; end
             if c() then x := 4; break l2; end
             if c() then x := 5; break l3; end
             f(3); x := 3;
           end
           f(selectx(3, 5)); x := 2;
         end
         f(selectx(2, 4, 6)); x := 1;
       end
       f(selectx(3, 1, 0));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "242"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "242"
       , "4"
       , "257"
       , "5"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "242"
           , "24"
           , "242"
           , "60"
           )
           ; !"Check break to label union test #3"
         | "var x; x := 1;
       l1: begin
         if c() then x := 1; break l1; else x := 1; break; end
         if c() then x := 2; break l1; end
         f(x); x := 2;
       end
       f(x);"
         , "var x; x := 1;
       l1: begin
         if c() then x := 1; break l1; else x := 1; break; end
         if c() then x := 2; break l1; end
         f(1); x := 2;
       end
       f(selectx(2, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "259"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "259"
       , "4"
       , "290"
       , "5"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "259"
           , "24"
           , "259"
           , "60"
           )
           ; !"Check break to label union test #4"
         | "var x; x := 2;
       l1: begin
         if c() then x := 1; break l1; else x := 2; end
         l2: begin
           x := 2;
           if c() then x := 2; else x := 2; break l2; end
           if c() then x := 2; else x := 3; break l1; end
           if c() then x := 4; break; end
           f(x);
         end
         f(x);
         if c() then x := 2; else x := 5; break; end
         f(x);
       end
       f(x);"
         , "var x; x := 2;
       l1: begin
         if c() then x := 1; break l1; else x := 2; end
         l2: begin
           x := 2;
           if c() then x := 2; else x := 2; break l2; end
           if c() then x := 2; else x := 3; break l1; end
           if c() then x := 4; break; end
           f(2);
         end
         f(selectx(4, 2));
         if c() then x := 2; else x := 5; break; end
         f(2);
       end
       f(selectx(2, 5, 3, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "292"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "292"
       , "4"
       , "309"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "292"
           , "24"
           , "292"
           , "54"
           )
           ; !"Check continue union test #1"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 2; continue; else x := 1; end
         if c() then x := 5; else if c() then x := 3; continue; else x := 5; end end
         f(x); x := 4;
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(selectx(4, 3, 2, 1));
         if c() then x := 2; continue; else x := 1; end
         if c() then x := 5; else if c() then x := 3; continue; else x := 5; end end
         f(5); x := 4;
       end
       f(selectx(4, 3, 2, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "311"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "311"
       , "4"
       , "330"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "311"
           , "24"
           , "311"
           , "56"
           )
           ; !"Check continuing union test #2"
         | "var x; x := 1;
       while c() do
         f(x);
         if c() then x := 2; continue;
         else if c() then x := 3; else x := 2; continue; end
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       while c() do
         f(selectx(3, 2, 1));
         if c() then x := 2; continue;
         else if c() then x := 3; else x := 2; continue; end
         end
         f(3);
       end
       f(selectx(3, 2, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "332"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "332"
       , "4"
       , "361"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "332"
           , "24"
           , "332"
           , "54"
           )
           ; !"Check continue union test #3"
         | "var x; x := 1;
       l1: while c() do
         f(x);
         if c() then x := 2; continue; else x := 3; end
         f(x); x := 4;
         l2 : while c() do
           f(x);
           if c() then x := 5; continue l1; end
           if c() then x := 8; continue; end
           x := 6;
         end
         f(x); x := 7;
       end
       f(x);"
         , "var x; x := 1;
       l1: while c() do
         f(selectx(7, 5, 2, 1));
         if c() then x := 2; continue; else x := 3; end
         f(3); x := 4;
         l2 : while c() do
           f(selectx(6, 8, 4));
           if c() then x := 5; continue l1; end
           if c() then x := 8; continue; end
           x := 6;
         end
         f(selectx(6, 8, 4)); x := 7;
       end
       f(selectx(7, 5, 2, 1));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "363"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "363"
       , "4"
       , "405"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "363"
           , "24"
           , "363"
           , "60"
           )
           ; !"Check break/continue union test #1"
         | "var x; x := 1;
       l1: while c() do
         f(x); if c() then x := 2; break; else x := 3; end
         l2: while c() do
           f(x); if c() then x := 4; continue l1; end
           if c() then x := 5; break; end
           if c() then x := 6; continue; end
           l3: while c() do
             f(x); if c() then x := 7; break l2; end
             if c() then x := 8; continue l3; end
             if c() then x := 9; break l1; end
             if c() then x := 10; continue l2; end
             if c() then x := 11; continue l1; end
             if c() then x := 12; break l3; end
           end
           f(x);
         end
         f(x);
       end
       f(x);"
         , "var x; x := 1;
       l1: while c() do
         f(selectx(8, 12, 10, 6, 3, 7, 5, 11, 4, 1));
         if c() then x := 2; break; else x := 3; end
         l2: while c() do
           f(selectx(8, 12, 10, 6, 3)); if c() then x := 4; continue l1; end
           if c() then x := 5; break; end
           if c() then x := 6; continue; end
           l3: while c() do
             f(selectx(8, 12, 10, 6, 3)); if c() then x := 7; break l2; end
             if c() then x := 8; continue l3; end
             if c() then x := 9; break l1; end
             if c() then x := 10; continue l2; end
             if c() then x := 11; continue l1; end
             if c() then x := 12; break l3; end
           end
           f(selectx(8, 10, 6, 3, 12));
         end
         f(selectx(8, 12, 10, 6, 3, 7, 5));
       end
       f(selectx(8, 12, 10, 6, 3, 7, 5, 11, 4, 1, 9, 2));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "407"
      , "4"
      , "534"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
       , "407"
       , "4"
       , "468"
       , "4"
       )
       ; apply-varunion-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
           , "407"
           , "24"
           , "407"
           , "55"
           )
           ; !"Check exception union test #1"
         | "var x;
       try
         x := 1;
         try
           if c() then x := 2; throw A; end
           if c() then x := 3; throw E; end
           if c() then x := 4; throw F; end
           if c() then
             if c() then x := 5; throw A; else x := 6; throw E; end
           else
             x := 7;
           end
         catch (a: A)
           f(x); x := 8;
           if c() then throw E; end
         end
         f(x);
         if c() then throw F; end
         x := 9;
       catch (e: E)
         f(x);
         try
           if c() then x := 10; throw B; else x := 11; end
         catch (b: B)
           f(x);
         end
       catch (f: F)
         f(x); x := 12;
       end
       f(x);"
         , "var x;
       try
         x := 1;
         try
           if c() then x := 2; throw A; end
           if c() then x := 3; throw E; end
           if c() then x := 4; throw F; end
           if c() then
             if c() then x := 5; throw A; else x := 6; throw E; end
           else
             x := 7;
           end
         catch (a: A)
           f(selectx(5, 2)); x := 8;
           if c() then throw E; end
         end
         f(selectx(7, 8));
         if c() then throw F; end
         x := 9;
       catch (e: E)
         f(selectx(8, 6, 3));
         try
           if c() then x := 10; throw B; else x := 11; end
         catch (b: B)
           f(10);
         end
       catch (f: F)
         f(selectx(7, 8, 4)); x := 12;
       end
       f(selectx(9, 12, 11, 10));"
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "470"
      , "4"
      , "534"
      , "4"
      )
    ; apply-varunion-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
        , "470"
        , "24"
        , "470"
        , "55"
        )
        ; !"Check exception union test #2"
      | "var x;
       try
         x := 1;
         try
           if c() then x := 2; throw A; end
           if c() then x := 3; throw E; end
           if c() then x := 4; throw F; end
           if c() then
             if c() then x := 5; throw A; else x := 6; throw E; end
           else
             x := 7;
           end
         catch (a: A)
           f(x); x := 8;
           if c() then throw E; end
         finally
           f(x); if c() then x := 9; throw E; else x := 10; throw F; end
         end
       catch (e: E)
         f(x);
         try
           if c() then x := 11; throw B; else x := 12; end
         catch (b: B)
           f(x);
         end
       catch (f: F)
         f(x); x := 13;
       finally
         f(x);
       end
       f(x);"
      , "var x;
       try
         x := 1;
         try
           if c() then x := 2; throw A; end
           if c() then x := 3; throw E; end
           if c() then x := 4; throw F; end
           if c() then
             if c() then x := 5; throw A; else x := 6; throw E; end
           else
             x := 7;
           end
         catch (a: A)
           f(selectx(5, 2)); x := 8;
           if c() then throw E; end
         finally
           f(selectx(7, 8, 6, 4, 3));
           if c() then x := 9; throw E; else x := 10; throw F; end
         end
       catch (e: E)
         f(9);
         try
           if c() then x := 11; throw B; else x := 12; end
         catch (b: B)
           f(11);
         end
       catch (f: F)
         f(10); x := 13;
       finally
         f(selectx(13, 12, 11));
       end
       f(selectx(13, 12, 11));"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "vu-break-tests"
      , "50"
      , "2"
      , "534"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules/dr-varunion-tests.str"
      , "vu-break-tests"
      , "50"
      , "2"
      , "534"
      , "4"
      )
      ; fail