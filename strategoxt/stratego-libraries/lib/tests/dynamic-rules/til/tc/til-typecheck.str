module til-typecheck

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  til-typecheck-stats


strategies
  io-til-typecheck =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "io-til-typecheck", "5,2,6,29")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "6,4,6,29")
    ; io-wrap(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "6,12,6,28") ; typecheck-program
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "io-til-typecheck", "5,2,6,29")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "io-til-typecheck", "5,2,6,29")
      ; fail

  typecheck-program =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "typecheck-program", "8,2,9,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "9,4,9,27")
    ; Program(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "9,12,9,26") ; typecheck-stats
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "typecheck-program", "8,2,9,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/tc/til-typecheck.str", "typecheck-program", "8,2,9,27")
      ; fail