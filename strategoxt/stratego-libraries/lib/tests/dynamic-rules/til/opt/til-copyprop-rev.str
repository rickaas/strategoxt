module til-copyprop-rev

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  til-opt-lib


strategies
  io-til-copyprop-rev =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "io-til-copyprop-rev", "5,2,6,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "6,4,6,24")
    ; io-wrap(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "6,12,6,23") ; copyprop-rev
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "io-til-copyprop-rev", "5,2,6,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "io-til-copyprop-rev", "5,2,6,24")
      ; fail

  copyprop-rev =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev", "8,2,15,23")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "9,4,15,23")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "9,4,9,14") ; CopyPropRev
       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "10,7,15,23")
          ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "10,7,10,30") ; copyprop-rev-declaration
             <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "11,7,15,23")
                ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "11,7,11,25") ; copyprop-rev-assign
                   <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "12,7,15,23")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "12,7,12,24") ; copyprop-rev-block
                         <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "13,7,15,23")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "13,7,13,21") ; copyprop-rev-if
                               <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "14,7,15,23")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "14,7,14,24") ; copyprop-rev-while
                                     <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "15,7,15,23")
                                        ; all(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "15,11,15,22") ; copyprop-rev)))))))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev", "8,2,15,23")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev", "8,2,15,23")
      ; fail

  copyprop-rev-block =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-block", "17,2,18,47")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "18,4,18,47")
    ; Block(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "18,10,18,46")
        ; {|CopyPropRev:
             s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "18,27,18,43")
             ; map(
                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "18,31,18,42") ; copyprop-rev
               )
          |}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-block", "17,2,18,47")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-block", "17,2,18,47")
      ; fail

  copyprop-rev-declaration =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-declaration", "20,2,22,27")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "21,4,22,27")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "21,5,21,46")
       ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "21,5,21,19")
          ; ?Declaration(x)
          <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "21,24,21,46")
             ; ?DeclarationTyped(x, t)))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "22,6,22,27")
    ; new-CopyPropRev(|x, x)
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-declaration", "20,2,22,27")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-declaration", "20,2,22,27")
      ; fail

  copyprop-rev-assign =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-assign", "24,2,30,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "25,4,30,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "25,4,25,32")
       ; Assign(
           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "25,11,25,12") ; ?x
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "25,15,25,31")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "25,15,25,26") ; copyprop-rev) => e
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "26,6,30,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "26,6,26,29")
       ; undefine-CopyPropRev(|x))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "27,6,30,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "27,6,27,46")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "27,13,27,44")
               ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "27,13,27,39") ; innermost-scope-CopyPropRev) => z))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "28,6,30,8")
    ; if s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "28,9,28,19")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "28,10,28,16")
             ; ?Var(y))> e then
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "29,8,29,73")
        ; rules (
            CopyPropRev.z :
              Var(y) -> Var(x)
              depends on [(x, x), (y, y)]
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-assign", "24,2,30,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-assign", "24,2,30,8")
      ; fail

  copyprop-rev-if =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-if", "32,2,34,76")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "33,4,34,76")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "33,4,33,31")
       ; IfElse(
           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "33,11,33,22") ; copyprop-rev
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "33,25,33,26") ; id
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "33,29,33,30") ; id
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,7,34,75")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,7,34,34")
       ; IfElse(
           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,14,34,15") ; id
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,18,34,29") ; copyprop-rev
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,32,34,33") ; id
         )) /CopyPropRev\ (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,50,34,75")
                           ; IfElse(
                               s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,57,34,58") ; id
                             , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,60,34,61") ; id
                             , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "34,63,34,74") ; copyprop-rev
                             ))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-if", "32,2,34,76")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-if", "32,2,34,76")
      ; fail

  copyprop-rev-while =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-while", "36,2,38,55")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "37,4,38,55")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "37,4,37,15")
       ; ?While(_, _))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "38,7,38,54")
    ; /CopyPropRev\* (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "38,22,38,54")
                      ; While(
                          s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "38,28,38,39") ; copyprop-rev
                        , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "38,42,38,53") ; copyprop-rev
                        ))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-while", "36,2,38,55")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "copyprop-rev-while", "36,2,38,55")
      ; fail

  innermost-scope-CopyPropRev =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "innermost-scope-CopyPropRev", "40,2,42,48")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "41,4,42,48")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "41,4,41,24")
       ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "41,4,41,16") ; get-var-names) => vars)
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "42,6,42,48")
    ; innermost-scope-CopyPropRev(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "42,34,42,47")
        ; elem-of(|vars)
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "innermost-scope-CopyPropRev", "40,2,42,48")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-copyprop-rev.str", "innermost-scope-CopyPropRev", "40,2,42,48")
      ; fail