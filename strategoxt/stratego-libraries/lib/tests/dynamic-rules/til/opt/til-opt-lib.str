module til-opt-lib

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  TIL
  til-eval


strategies
  contains(|x) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "contains", "5,2,6,13")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "6,4,6,13")
    ; oncetd(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "6,11,6,12") ; ?x
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "contains", "5,2,6,13")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "contains", "5,2,6,13")
      ; fail

  elem-of(|xs) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "elem-of", "8,2,9,28")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "9,4,9,28")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "9,4,9,5") ; ?x)
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "9,8,9,28")
    ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "9,14,9,27")
            ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "9,15,9,23")
                ; fetch(
                    s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "9,21,9,22") ; ?x
                  ))> xs)
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "elem-of", "8,2,9,28")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "elem-of", "8,2,9,28")
      ; fail

  get-var-names =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "get-var-names", "11,2,12,22")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "12,4,12,22")
    ; collect(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "12,12,12,21")
        ; ?Var(
             <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "12,18,12,19") ; id>
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "get-var-names", "11,2,12,22")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "get-var-names", "11,2,12,22")
      ; fail

  get-var-dependencies =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "get-var-dependencies", "14,2,15,32")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "15,4,15,32")
    ; collect(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "15,12,15,31")
        ; ?Var(
             <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "15,18,15,29")
              ; !( <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "15,21,15,22") ; id>
                 , <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "15,26,15,27") ; id>
                 )>
           )
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "get-var-dependencies", "14,2,15,32")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "get-var-dependencies", "14,2,15,32")
      ; fail

  EvalExp =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "EvalExp", "17,2,19,44")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,4,19,44")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,4,18,10") ; EvalAdd
       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,15,19,44")
          ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,15,18,21") ; EvalMul
             <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,26,19,44")
                ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,26,18,32") ; EvalSub
                   <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,37,19,44")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,37,18,43") ; EvalDiv
                         <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,48,19,44")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "18,48,18,54") ; EvalMod
                               <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,7,19,44")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,7,19,12") ; EvalLt
                                     <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,17,19,44")
                                        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,17,19,22") ; EvalGt
                                           <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,27,19,44")
                                              ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,27,19,33") ; EvalEqu
                                                 <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "19,38,19,44") ; EvalNeq))))))))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "EvalExp", "17,2,19,44")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "EvalExp", "17,2,19,44")
      ; fail

  is-var =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-var", "21,2,22,10")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "22,4,22,10")
    ; ?Var(_)
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-var", "21,2,22,10")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-var", "21,2,22,10")
      ; fail

  is-value =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-value", "24,2,25,24")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "25,4,25,24")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "25,4,25,10")
       ; ?Int(_)
       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "25,15,25,24")
          ; ?String(_))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-value", "24,2,25,24")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-value", "24,2,25,24")
      ; fail

  is-pure-exp =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-pure-exp", "27,2,29,44")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "28,4,29,44")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "28,4,28,10")
       ; ?Var(_)
       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "28,15,29,44")
          ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "28,15,28,21")
             ; ?Int(_)
             <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "28,26,29,44")
                ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "28,26,28,35")
                   ; ?String(_)
                   <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "29,7,29,44")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "29,7,29,15") ; is-bin-op)#((s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "29,18,29,43")
                                                                                                                                               ; [ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "29,19,29,29") ; is-pure-exp
                                                                                                                                                 , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "29,32,29,42") ; is-pure-exp
                                                                                                                                                 ])))))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-pure-exp", "27,2,29,44")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-pure-exp", "27,2,29,44")
      ; fail

  is-bin-op =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-bin-op", "31,2,33,42")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,4,33,42")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,4,32,8")
       ; ?"Or"
       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,13,33,42")
          ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,13,32,18")
             ; ?"And"
             <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,23,33,42")
                ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,23,32,28")
                   ; ?"Neq"
                   <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,33,33,42")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,33,32,38")
                         ; ?"Equ"
                         <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,43,33,42")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,43,32,47")
                               ; ?"Gt"
                               <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,52,33,42")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,52,32,56")
                                     ; ?"Lt"
                                     <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,61,33,42")
                                        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "32,61,32,66")
                                           ; ?"Sub"
                                           <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,7,33,42")
                                              ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,7,33,12")
                                                 ; ?"Add"
                                                 <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,17,33,42")
                                                    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,17,33,22")
                                                       ; ?"Mod"
                                                       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,27,33,42")
                                                          ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,27,33,32")
                                                             ; ?"Div"
                                                             <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "33,37,33,42")
                                                                ; ?"Mul"))))))))))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-bin-op", "31,2,33,42")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-opt-lib.str", "is-bin-op", "31,2,33,42")
      ; fail