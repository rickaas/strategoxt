module til-forward-prop

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  til-opt-lib


strategies
  forward-prop =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop", "7,2,14,23")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "8,4,14,23")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "8,4,8,11") ; CopyProp
       <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "9,7,14,23")
          ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "9,7,9,30") ; forward-prop-declaration
             <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "10,7,14,23")
                ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "10,7,10,25") ; forward-prop-assign
                   <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "11,7,14,23")
                      ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "11,7,11,24") ; forward-prop-block
                         <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "12,7,14,23")
                            ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "12,7,12,21") ; forward-prop-if
                               <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "13,7,14,23")
                                  ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "13,7,13,24") ; forward-prop-while
                                     <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "14,7,14,23")
                                        ; all(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "14,11,14,22") ; forward-prop)))))))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop", "7,2,14,23")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop", "7,2,14,23")
      ; fail

  forward-prop-block(|Rs) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-block", "16,2,17,39")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "17,4,17,39")
    ; Block(
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "17,10,17,38")
        ; {|~Rs:
             s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "17,19,17,35")
             ; map(
                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "17,23,17,34") ; forward-prop
               )
          |}
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-block", "16,2,17,39")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-block", "16,2,17,39")
      ; fail

  forward-prop-declaration(|Rs) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-declaration", "19,2,21,33")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "20,4,21,33")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "20,5,20,46")
       ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "20,5,20,19")
          ; ?Declaration(x)
          <+ s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "20,24,20,46")
             ; ?DeclarationTyped(x, t)))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "21,6,21,33")
    ; new-dynamic-rules(|Rs, x, x)
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-declaration", "19,2,21,33")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-declaration", "19,2,21,33")
      ; fail

  forward-prop-assign(|Rs) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-assign", "23,2,29,8")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "24,4,29,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "24,4,24,32")
       ; Assign(
           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "24,11,24,12") ; ?x
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "24,15,24,31")
           ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "24,15,24,26") ; forward-prop) => e
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "25,6,29,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "25,6,25,35")
       ; undefine-dynamic-rules(|Rs, x))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "26,6,29,8")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "26,6,26,47")
       ; where(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "26,13,26,45")
               ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "26,13,26,40") ; innermost-scope-Forward-Prop) => z))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "27,6,29,8")
    ; if s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "27,9,27,19")
         ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "27,10,27,16")
             ; ?Var(y))> e then
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "28,8,28,74")
        ; rules (
            Forward-Prop.z :
              Var(x) -> Var(y)
              depends on [(x, x), (y, y)]
          )
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-assign", "23,2,29,8")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-assign", "23,2,29,8")
      ; fail

  forward-prop-if(|Rs1, Rs2) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-if", "31,2,33,74")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "32,4,33,74")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "32,4,32,31")
       ; IfElse(
           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "32,11,32,22") ; forward-prop
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "32,25,32,26") ; id
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "32,29,32,30") ; id
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,7,33,73")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,7,33,34")
       ; IfElse(
           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,14,33,15") ; id
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,18,33,29") ; forward-prop
         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,32,33,33") ; id
         )) / ~Rs1 \ ~Rs2 / (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,48,33,73")
                             ; IfElse(
                                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,55,33,56") ; id
                               , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,58,33,59") ; id
                               , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "33,61,33,72") ; forward-prop
                               ))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-if", "31,2,33,74")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-if", "31,2,33,74")
      ; fail

  forward-prop-while(|Rs1, Rs2) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-while", "35,2,37,52")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "36,4,37,52")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "36,4,36,15")
       ; ?While(_, _))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "37,7,37,51")
    ; / ~Rs \ ~Rs2 /* (s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "37,19,37,51")
                       ; While(
                           s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "37,25,37,36") ; forward-prop
                         , s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "37,39,37,50") ; forward-prop
                         ))
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-while", "35,2,37,52")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/opt/til-forward-prop.str", "forward-prop-while", "35,2,37,52")
      ; fail