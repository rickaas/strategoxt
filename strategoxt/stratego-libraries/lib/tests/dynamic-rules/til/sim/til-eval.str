module til-eval

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  TIL


rules

  EvalAdd :
    Add(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAdd", "5,2,6,42")> Int(
                                                                                                                                            <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "6,32,6,35") ; addS> (i, j)
                                                                                                                                          )
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAdd", "5,2,6,42")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAdd", "5,2,6,42")
             ; fail

  EvalAdd :
    Add(String(i), String(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAdd", "8,2,9,59")> String(
                                                                                                                                                  <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "9,41,9,52") ; conc-strings> (i, j)
                                                                                                                                                )
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAdd", "8,2,9,59")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAdd", "8,2,9,59")
             ; fail

  EvalSub :
    Sub(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalSub", "11,2,12,43")> Int(
                                                                                                                                              <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "12,32,12,36") ; subtS> (i, j)
                                                                                                                                            )
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalSub", "11,2,12,43")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalSub", "11,2,12,43")
             ; fail

  EvalMul :
    Mul(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalMul", "14,2,15,42")> Int(
                                                                                                                                              <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "15,32,15,35") ; mulS> (i, j)
                                                                                                                                            )
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalMul", "14,2,15,42")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalMul", "14,2,15,42")
             ; fail

  EvalDiv :
    Div(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalDiv", "17,2,18,42")> Int(
                                                                                                                                              <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "18,32,18,35") ; divS> (i, j)
                                                                                                                                            )
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalDiv", "17,2,18,42")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalDiv", "17,2,18,42")
             ; fail

  EvalMod :
    Mod(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalMod", "20,2,21,42")> Int(
                                                                                                                                              <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "21,32,21,35") ; modS> (i, j)
                                                                                                                                            )
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalMod", "20,2,21,42")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalMod", "20,2,21,42")
             ; fail

  EvalLt :
    Lt(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalLt", "23,2,24,44")> <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "24,27,24,38")
                                                                                                                                           ; compare(
                                                                                                                                               s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "24,35,24,37") ; ltS
                                                                                                                                             )> (i, j)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalLt", "23,2,24,44")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalLt", "23,2,24,44")
             ; fail

  EvalGt :
    Gt(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalGt", "26,2,27,44")> <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "27,27,27,38")
                                                                                                                                           ; compare(
                                                                                                                                               s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "27,35,27,37") ; gtS
                                                                                                                                             )> (i, j)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalGt", "26,2,27,44")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalGt", "26,2,27,44")
             ; fail

  EvalLeq :
    Leq(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalLeq", "29,2,30,46")> <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "30,28,30,40")
                                                                                                                                             ; compare(
                                                                                                                                                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "30,36,30,39") ; leqS
                                                                                                                                               )> (i, j)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalLeq", "29,2,30,46")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalLeq", "29,2,30,46")
             ; fail

  EvalGeq :
    Geq(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalGeq", "32,2,33,46")> <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "33,28,33,40")
                                                                                                                                             ; compare(
                                                                                                                                                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "33,36,33,39") ; geqS
                                                                                                                                               )> (i, j)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalGeq", "32,2,33,46")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalGeq", "32,2,33,46")
             ; fail

  EvalEqu :
    Equ(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalEqu", "35,2,36,44")> <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "36,28,36,38")
                                                                                                                                             ; compare(
                                                                                                                                                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "36,36,36,37") ; eq
                                                                                                                                               )> (i, j)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalEqu", "35,2,36,44")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalEqu", "35,2,36,44")
             ; fail

  EvalNeq :
    Neq(Int(i), Int(j)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalNeq", "38,2,39,49")> <s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "39,28,39,43")
                                                                                                                                             ; compare(
                                                                                                                                                 s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "39,36,39,42")
                                                                                                                                                 ; not(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "39,40,39,41") ; eq)
                                                                                                                                               )> (i, j)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalNeq", "38,2,39,49")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalNeq", "38,2,39,49")
             ; fail

  compare(s) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "compare", "41,2,42,38")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "42,4,42,38")
    ; if s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "42,7,42,7") ; s then
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "42,14,42,20")
        ; !True()
      else
        s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "42,27,42,34")
        ; !False()
      end
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "compare", "41,2,42,38")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "compare", "41,2,42,38")
      ; fail

  EvalOr :
    Or(True(), e) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalOr", "44,2,45,26")> True()
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalOr", "44,2,45,26")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalOr", "44,2,45,26")
             ; fail

  EvalOr :
    Or(False(), e) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalOr", "47,2,48,22")> e
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalOr", "47,2,48,22")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalOr", "47,2,48,22")
             ; fail

  EvalAnd :
    And(True(), e) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAnd", "50,2,51,22")> e
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAnd", "50,2,51,22")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAnd", "50,2,51,22")
             ; fail

  EvalAnd :
    And(False(), e) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAnd", "53,2,54,29")> False()
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAnd", "53,2,54,29")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalAnd", "53,2,54,29")
             ; fail

  AddZero :
    Add(e, Int("0")) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "AddZero", "56,2,57,24")> e
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "AddZero", "56,2,57,24")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "AddZero", "56,2,57,24")
             ; fail

  AddZero :
    Add(Int("0"), e) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "AddZero", "59,2,60,24")> e
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "AddZero", "59,2,60,24")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "AddZero", "59,2,60,24")
             ; fail

  MulOne :
    Mul(e, Int("1")) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "MulOne", "62,2,63,24")> e
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "MulOne", "62,2,63,24")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "MulOne", "62,2,63,24")
             ; fail

  MulOne :
    Mul(Int("1"), e) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "MulOne", "65,2,66,24")> e
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "MulOne", "65,2,66,24")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "MulOne", "65,2,66,24")
             ; fail

  EvalS2I :
    FunCall("string2int", [String(x)]) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalS2I", "68,2,70,26")> Int(x)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalS2I", "68,2,70,26")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalS2I", "68,2,70,26")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "70,10,70,26")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "70,11,70,23") ; string-to-int)> x
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalS2I", "68,2,70,26")
             ; fail

  EvalI2S :
    FunCall("int2string", [Int(i)]) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalI2S", "72,2,73,47")> String(i)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalI2S", "72,2,73,47")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalI2S", "72,2,73,47")
             ; fail

  EvalIf :
    IfElse(False(), st1*, st2*) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalIf", "75,2,76,45")> Block(st2*)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalIf", "75,2,76,45")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalIf", "75,2,76,45")
             ; fail

  EvalIf :
    IfElse(True(), st1*, st2*) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalIf", "78,2,79,44")> Block(st1*)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalIf", "78,2,79,44")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalIf", "78,2,79,44")
             ; fail

  EvalWhile :
    While(False(), st*) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalWhile", "81,2,82,36")> Block([])
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalWhile", "81,2,82,36")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules/til/sim/til-eval.str", "EvalWhile", "81,2,82,36")
             ; fail