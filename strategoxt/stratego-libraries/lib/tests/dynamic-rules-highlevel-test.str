module dynamic-rules-highlevel-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    Foo     : Int * Int -> FooBar
    Bar     : Int * Int -> FooBar
    FooGen  : Int * Int -> FooBar
    FooGen  : String * Int * Int -> FooBar
    FooDef  : String * ATerm -> Def
    FooKill : Int -> FooBar
    FooKill : String * Int -> FooBar


strategies
  main-dynamic-rules-highlevel-test =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "main-dynamic-rules-highlevel-test"
    , "15"
    , "2"
    , "23"
    , "2"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "16"
      , "2"
      , "23"
      , "2"
      )
    ; test-suite(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "16"
        , "13"
        , "16"
        , "43"
        )
        ; !"dynamic-rules-highlevel-test"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "17"
        , "4"
        , "22"
        , "23"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "17"
           , "4"
           , "17"
           , "15"
           )
           ; test-plain-1)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "18"
          , "4"
          , "22"
          , "23"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "18"
           , "4"
           , "18"
           , "17"
           )
           ; test-labeled-1)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "19"
          , "4"
          , "22"
          , "23"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "19"
           , "4"
           , "19"
           , "13"
           )
           ; test-add-1)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "20"
          , "4"
          , "22"
          , "23"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "20"
           , "4"
           , "20"
           , "17"
           )
           ; test-add-bagof)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "21"
          , "4"
          , "22"
          , "23"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "21"
           , "4"
           , "21"
           , "25"
           )
           ; test-dr-fork-and-union)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "22"
          , "4"
          , "22"
          , "23"
          )
        ; test-dr-ignore-state
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "main-dynamic-rules-highlevel-test"
      , "15"
      , "2"
      , "23"
      , "2"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "main-dynamic-rules-highlevel-test"
      , "15"
      , "2"
      , "23"
      , "2"
      )
      ; fail

  Strategy1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Strategy1"
    , "30"
    , "2"
    , "31"
    , "62"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "31"
      , "4"
      , "31"
      , "62"
      )
    ; dr-scope(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "31"
        , "13"
        , "31"
        , "54"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "31"
           , "13"
           , "31"
           , "48"
           )
           ; [s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "31"
              , "14"
              , "31"
              , "35"
              )
              ; try(
                  s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "31"
                  , "18"
                  , "31"
                  , "34"
                  )
                  ; (s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                     , "31"
                     , "18"
                     , "31"
                     , "21"
                     )
                     ; Gen1
                     + s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "31"
                       , "25"
                       , "31"
                       , "34"
                       )
                       ; (s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "31"
                          , "25"
                          , "31"
                          , "29"
                          )
                          ; Hide1
                          + s-step(
                            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                            , "31"
                            , "33"
                            , "31"
                            , "34"
                            )
                            ; A1))
                )|s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "31"
                  , "39"
                  , "31"
                  , "47"
                  )
                  ; Strategy1]
           <+ s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "31"
              , "53"
              , "31"
              , "54"
              )
              ; [])
      | "A1"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy1"
      , "30"
      , "2"
      , "31"
      , "62"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy1"
      , "30"
      , "2"
      , "31"
      , "62"
      )
      ; fail

  Strategy1-unscoped =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Strategy1-unscoped"
    , "33"
    , "2"
    , "34"
    , "54"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "34"
      , "4"
      , "34"
      , "54"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "34"
       , "4"
       , "34"
       , "48"
       )
       ; [s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "34"
          , "5"
          , "34"
          , "26"
          )
          ; try(
              s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "34"
              , "9"
              , "34"
              , "25"
              )
              ; (s-step(
                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                 , "34"
                 , "9"
                 , "34"
                 , "12"
                 )
                 ; Gen1
                 + s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                   , "34"
                   , "16"
                   , "34"
                   , "25"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                      , "34"
                      , "16"
                      , "34"
                      , "20"
                      )
                      ; Hide1
                      + s-step(
                        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                        , "34"
                        , "24"
                        , "34"
                        , "25"
                        )
                        ; A1))
            )|s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "34"
              , "30"
              , "34"
              , "47"
              )
              ; Strategy1-unscoped]
       <+ s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "34"
          , "53"
          , "34"
          , "54"
          )
          ; [])
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy1-unscoped"
      , "33"
      , "2"
      , "34"
      , "54"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy1-unscoped"
      , "33"
      , "2"
      , "34"
      , "54"
      )
      ; fail

  Gen1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Gen1"
    , "36"
    , "2"
    , "38"
    , "46"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "37"
      , "4"
      , "38"
      , "46"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "37"
       , "4"
       , "37"
       , "16"
       )
       ; ?FooGen(x, z))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "38"
      , "6"
      , "38"
      , "46"
      )
    ; dr-set-rule(
      | "A1"
      , Foo(x, [])
      , ("a1", z)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen1"
      , "36"
      , "2"
      , "38"
      , "46"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen1"
      , "36"
      , "2"
      , "38"
      , "46"
      )
      ; fail

  Hide1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Hide1"
    , "40"
    , "2"
    , "42"
    , "40"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "41"
      , "4"
      , "42"
      , "40"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "41"
       , "4"
       , "41"
       , "14"
       )
       ; ?FooKill(x))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "42"
      , "6"
      , "42"
      , "40"
      )
    ; dr-undefine-rule(
      | "A1"
      , Foo(x, [])
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide1"
      , "40"
      , "2"
      , "42"
      , "40"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide1"
      , "40"
      , "2"
      , "42"
      , "40"
      )
      ; fail

  A1 :
    Foo(x, y) -> <r-exit(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "A1"
                  , "44"
                  , "2"
                  , "46"
                  , "59"
                  )> Bar(y, z)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "A1", "44,2,46,59")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A1"
             , "44"
             , "2"
             , "46"
             , "59"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "46"
          , "10"
          , "46"
          , "59"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "46"
             , "10"
             , "46"
             , "42"
             )
             ; dr-lookup-rule(
               | "A1"
               , Foo(x, [])
               )) => [("a1", z)|_]
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A1"
             , "44"
             , "2"
             , "46"
             , "59"
             )
             ; fail

  test-plain-1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-plain-1"
    , "49"
    , "2"
    , "63"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "50"
      , "4"
      , "63"
      , "4"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "50"
       , "4"
       , "58"
       , "4"
       )
       ; apply-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "50"
           , "15"
           , "50"
           , "29"
           )
           ; !"test-plain-1"
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "51"
           , "6"
           , "51"
           , "14"
           )
           ; Strategy1
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "52"
           , "6"
           , "54"
           , "31"
           )
           ; ![ FooGen(1, 3)
              , Foo(1, 2)
              , Foo(2, 2)
              , FooGen(1, 4)
              , Foo(1, 2)
              , FooKill(1)
              , Foo(1, 5)
              , FooGen(1, 6)
              , Foo(1, 7)
              ]
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "55"
           , "6"
           , "57"
           , "31"
           )
           ; ![ FooGen(1, 3)
              , Bar(2, 3)
              , Foo(2, 2)
              , FooGen(1, 4)
              , Bar(2, 4)
              , FooKill(1)
              , Foo(1, 5)
              , FooGen(1, 6)
              , Bar(7, 6)
              ]
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "59"
      , "4"
      , "63"
      , "4"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "59"
        , "15"
        , "59"
        , "38"
        )
        ; !"test-plain-unscoped-1"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "60"
        , "6"
        , "60"
        , "23"
        )
        ; Strategy1-unscoped
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "61"
        , "6"
        , "61"
        , "115"
        )
        ; ![ FooGen(1, 3)
           , Foo(1, 2)
           , Foo(2, 2)
           , FooGen(1, 4)
           , Foo(1, 2)
           , FooKill(1)
           , Foo(1, 5)
           , FooGen(1, 6)
           , Foo(1, 7)
           ]
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "62"
        , "6"
        , "62"
        , "115"
        )
        ; ![ FooGen(1, 3)
           , Bar(2, 3)
           , Foo(2, 2)
           , FooGen(1, 4)
           , Bar(2, 4)
           , FooKill(1)
           , Foo(1, 5)
           , FooGen(1, 6)
           , Bar(7, 6)
           ]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-plain-1"
      , "49"
      , "2"
      , "63"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-plain-1"
      , "49"
      , "2"
      , "63"
      , "4"
      )
      ; fail

  Strategy2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Strategy2"
    , "72"
    , "2"
    , "74"
    , "67"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "73"
      , "4"
      , "74"
      , "67"
      )
    ; dr-scope(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "74"
        , "4"
        , "74"
        , "59"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "74"
           , "4"
           , "74"
           , "53"
           )
           ; [s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "74"
              , "5"
              , "74"
              , "40"
              )
              ; try(
                  s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "74"
                  , "9"
                  , "74"
                  , "39"
                  )
                  ; (s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                     , "74"
                     , "9"
                     , "74"
                     , "19"
                     )
                     ; EnterScope2
                     + s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "74"
                       , "23"
                       , "74"
                       , "39"
                       )
                       ; (s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "74"
                          , "23"
                          , "74"
                          , "26"
                          )
                          ; Gen2
                          + s-step(
                            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                            , "74"
                            , "30"
                            , "74"
                            , "39"
                            )
                            ; (s-step(
                               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                               , "74"
                               , "30"
                               , "74"
                               , "34"
                               )
                               ; Hide2
                               + s-step(
                                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                                 , "74"
                                 , "38"
                                 , "74"
                                 , "39"
                                 )
                                 ; A2)))
                )|s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "74"
                  , "44"
                  , "74"
                  , "52"
                  )
                  ; Strategy2]
           <+ s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "74"
              , "58"
              , "74"
              , "59"
              )
              ; [])
      | "A2"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy2"
      , "72"
      , "2"
      , "74"
      , "67"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy2"
      , "72"
      , "2"
      , "74"
      , "67"
      )
      ; fail

  EnterScope2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "EnterScope2"
    , "76"
    , "2"
    , "78"
    , "29"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "77"
      , "4"
      , "78"
      , "29"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "77"
       , "4"
       , "77"
       , "16"
       )
       ; ?FooDef(f, _))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "78"
      , "6"
      , "78"
      , "29"
      )
    ; dr-label-scope(|"A2", f)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "EnterScope2"
      , "76"
      , "2"
      , "78"
      , "29"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "EnterScope2"
      , "76"
      , "2"
      , "78"
      , "29"
      )
      ; fail

  Gen2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Gen2"
    , "80"
    , "2"
    , "82"
    , "48"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "81"
      , "4"
      , "82"
      , "48"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "81"
       , "4"
       , "81"
       , "18"
       )
       ; ?FooGen(f, x, z))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "82"
      , "6"
      , "82"
      , "48"
      )
    ; dr-set-rule(
      | "A2"
      , f
      , Foo(x, [])
      , ("b", z)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen2"
      , "80"
      , "2"
      , "82"
      , "48"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen2"
      , "80"
      , "2"
      , "82"
      , "48"
      )
      ; fail

  Gen2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Gen2"
    , "84"
    , "2"
    , "86"
    , "45"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "85"
      , "4"
      , "86"
      , "45"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "85"
       , "4"
       , "85"
       , "16"
       )
       ; ?FooGen(x, z))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "86"
      , "6"
      , "86"
      , "45"
      )
    ; dr-set-rule(
      | "A2"
      , Foo(x, [])
      , ("b", z)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen2"
      , "84"
      , "2"
      , "86"
      , "45"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen2"
      , "84"
      , "2"
      , "86"
      , "45"
      )
      ; fail

  Hide2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Hide2"
    , "88"
    , "2"
    , "90"
    , "40"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "89"
      , "4"
      , "90"
      , "40"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "89"
       , "4"
       , "89"
       , "14"
       )
       ; ?FooKill(x))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "90"
      , "6"
      , "90"
      , "40"
      )
    ; dr-undefine-rule(
      | "A2"
      , Foo(x, [])
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide2"
      , "88"
      , "2"
      , "90"
      , "40"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide2"
      , "88"
      , "2"
      , "90"
      , "40"
      )
      ; fail

  Hide2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Hide2"
    , "92"
    , "2"
    , "94"
    , "43"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "93"
      , "4"
      , "94"
      , "43"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "93"
       , "4"
       , "93"
       , "17"
       )
       ; ?FooKill(f, x))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "94"
      , "6"
      , "94"
      , "43"
      )
    ; dr-undefine-rule(
      | "A2"
      , f
      , Foo(x, [])
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide2"
      , "92"
      , "2"
      , "94"
      , "43"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide2"
      , "92"
      , "2"
      , "94"
      , "43"
      )
      ; fail

  A2 :
    Foo(x, y) -> <r-exit(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "A2"
                  , "96"
                  , "2"
                  , "98"
                  , "58"
                  )> Bar(y, z)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "A2", "96,2,98,58")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A2"
             , "96"
             , "2"
             , "98"
             , "58"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "98"
          , "10"
          , "98"
          , "58"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "98"
             , "10"
             , "98"
             , "42"
             )
             ; dr-lookup-rule(
               | "A2"
               , Foo(x, [])
               )) => [("b", z)|_]
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A2"
             , "96"
             , "2"
             , "98"
             , "58"
             )
             ; fail

  test-labeled-1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-labeled-1"
    , "102"
    , "2"
    , "111"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "103"
      , "4"
      , "111"
      , "4"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "103"
        , "15"
        , "103"
        , "31"
        )
        ; !"test-labeled-1"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "104"
        , "6"
        , "104"
        , "14"
        )
        ; Strategy2
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "105"
        , "6"
        , "107"
        , "107"
        )
        ; ![ FooGen(1, 3)
           , Foo(1, 2)
           , FooDef("f", 0)
           , Foo(2, 2)
           , Foo(1, 12)
           , FooGen(1, 4)
           , Foo(1, 2)
           , FooDef("g", 0)
           , Foo(1, 5)
           , FooGen("g", 1, 6)
           , FooKill("f", 1)
           , Foo(1, 7)
           , FooKill("g", 1)
           , Foo(1, 7)
           ]
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "108"
        , "6"
        , "110"
        , "107"
        )
        ; ![ FooGen(1, 3)
           , Bar(2, 3)
           , FooDef("f", 0)
           , Foo(2, 2)
           , Bar(12, 3)
           , FooGen(1, 4)
           , Bar(2, 4)
           , FooDef("g", 0)
           , Bar(5, 4)
           , FooGen("g", 1, 6)
           , FooKill("f", 1)
           , Bar(7, 6)
           , FooKill("g", 1)
           , Foo(1, 7)
           ]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-labeled-1"
      , "102"
      , "2"
      , "111"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-labeled-1"
      , "102"
      , "2"
      , "111"
      , "4"
      )
      ; fail

  Strategy3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Strategy3"
    , "117"
    , "2"
    , "118"
    , "53"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "118"
      , "4"
      , "118"
      , "53"
      )
    ; dr-scope(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "118"
        , "13"
        , "118"
        , "46"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "118"
           , "13"
           , "118"
           , "40"
           )
           ; [s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "118"
              , "15"
              , "118"
              , "27"
              )
              ; handleFooBar3|s-step(
                              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                              , "118"
                              , "31"
                              , "118"
                              , "39"
                              )
                              ; Strategy3]
           <+ s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "118"
              , "45"
              , "118"
              , "46"
              )
              ; [])
      | "A3"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy3"
      , "117"
      , "2"
      , "118"
      , "53"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy3"
      , "117"
      , "2"
      , "118"
      , "53"
      )
      ; fail

  Strategy3-bagof =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Strategy3-bagof"
    , "120"
    , "2"
    , "121"
    , "65"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "121"
      , "4"
      , "121"
      , "65"
      )
    ; dr-scope(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "121"
        , "13"
        , "121"
        , "58"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "121"
           , "13"
           , "121"
           , "52"
           )
           ; [s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "121"
              , "15"
              , "121"
              , "33"
              )
              ; handleFooBar3-bagof|s-step(
                                    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                                    , "121"
                                    , "37"
                                    , "121"
                                    , "51"
                                    )
                                    ; Strategy3-bagof]
           <+ s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "121"
              , "57"
              , "121"
              , "58"
              )
              ; [])
      | "A3"
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy3-bagof"
      , "120"
      , "2"
      , "121"
      , "65"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Strategy3-bagof"
      , "120"
      , "2"
      , "121"
      , "65"
      )
      ; fail

  handleFooBar3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "handleFooBar3"
    , "123"
    , "2"
    , "123"
    , "53"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "123"
      , "18"
      , "123"
      , "53"
      )
    ; try(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "123"
        , "22"
        , "123"
        , "52"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "123"
           , "22"
           , "123"
           , "32"
           )
           ; EnterScope3
           + s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "123"
             , "36"
             , "123"
             , "52"
             )
             ; (s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "123"
                , "36"
                , "123"
                , "39"
                )
                ; Gen3
                + s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "123"
                  , "43"
                  , "123"
                  , "52"
                  )
                  ; (s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                     , "123"
                     , "43"
                     , "123"
                     , "44"
                     )
                     ; A3
                     + s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "123"
                       , "48"
                       , "123"
                       , "52"
                       )
                       ; Hide3)))
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "handleFooBar3"
      , "123"
      , "2"
      , "123"
      , "53"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "handleFooBar3"
      , "123"
      , "2"
      , "123"
      , "53"
      )
      ; fail

  handleFooBar3-bagof =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "handleFooBar3-bagof"
    , "125"
    , "2"
    , "125"
    , "65"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "125"
      , "24"
      , "125"
      , "65"
      )
    ; try(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "125"
        , "28"
        , "125"
        , "64"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "125"
           , "28"
           , "125"
           , "38"
           )
           ; EnterScope3
           + s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "125"
             , "42"
             , "125"
             , "64"
             )
             ; (s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "125"
                , "42"
                , "125"
                , "45"
                )
                ; Gen3
                + s-step(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "125"
                  , "49"
                  , "125"
                  , "64"
                  )
                  ; (s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                     , "125"
                     , "49"
                     , "125"
                     , "56"
                     )
                     ; bagof-A3
                     + s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "125"
                       , "60"
                       , "125"
                       , "64"
                       )
                       ; Hide3)))
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "handleFooBar3-bagof"
      , "125"
      , "2"
      , "125"
      , "65"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "handleFooBar3-bagof"
      , "125"
      , "2"
      , "125"
      , "65"
      )
      ; fail

  EnterScope3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "EnterScope3"
    , "127"
    , "2"
    , "129"
    , "29"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "128"
      , "4"
      , "129"
      , "29"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "128"
       , "4"
       , "128"
       , "16"
       )
       ; ?FooDef(f, _))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "129"
      , "6"
      , "129"
      , "29"
      )
    ; dr-label-scope(|"A3", f)
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "EnterScope3"
      , "127"
      , "2"
      , "129"
      , "29"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "EnterScope3"
      , "127"
      , "2"
      , "129"
      , "29"
      )
      ; fail

  Gen3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Gen3"
    , "131"
    , "2"
    , "133"
    , "45"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "132"
      , "4"
      , "133"
      , "45"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "132"
       , "4"
       , "132"
       , "16"
       )
       ; ?FooGen(x, z))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "133"
      , "6"
      , "133"
      , "45"
      )
    ; dr-add-rule(
      | "A3"
      , Foo(x, [])
      , ("c", z)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen3"
      , "131"
      , "2"
      , "133"
      , "45"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen3"
      , "131"
      , "2"
      , "133"
      , "45"
      )
      ; fail

  Gen3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Gen3"
    , "135"
    , "2"
    , "137"
    , "48"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "136"
      , "4"
      , "137"
      , "48"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "136"
       , "4"
       , "136"
       , "19"
       )
       ; ?FooGen(f, x, z))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "137"
      , "6"
      , "137"
      , "48"
      )
    ; dr-add-rule(
      | "A3"
      , f
      , Foo(x, [])
      , ("c", z)
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen3"
      , "135"
      , "2"
      , "137"
      , "48"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Gen3"
      , "135"
      , "2"
      , "137"
      , "48"
      )
      ; fail

  Hide3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Hide3"
    , "139"
    , "2"
    , "141"
    , "40"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "140"
      , "4"
      , "141"
      , "40"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "140"
       , "4"
       , "140"
       , "14"
       )
       ; ?FooKill(x))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "141"
      , "6"
      , "141"
      , "40"
      )
    ; dr-undefine-rule(
      | "A3"
      , Foo(x, [])
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide3"
      , "139"
      , "2"
      , "141"
      , "40"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide3"
      , "139"
      , "2"
      , "141"
      , "40"
      )
      ; fail

  Hide3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "Hide3"
    , "143"
    , "2"
    , "145"
    , "43"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "144"
      , "4"
      , "145"
      , "43"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "144"
       , "4"
       , "144"
       , "17"
       )
       ; ?FooKill(f, x))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "145"
      , "6"
      , "145"
      , "43"
      )
    ; dr-undefine-rule(
      | "A3"
      , f
      , Foo(x, [])
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide3"
      , "143"
      , "2"
      , "145"
      , "43"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "Hide3"
      , "143"
      , "2"
      , "145"
      , "43"
      )
      ; fail

  A3-aux(|x, y):
    ("c", z) -> <r-exit(
                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                 , "A3-aux"
                 , "147"
                 , "2"
                 , "148"
                 , "41"
                 )> Bar(y, z)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "A3-aux", "147,2,148,41")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A3-aux"
             , "147"
             , "2"
             , "148"
             , "41"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "148"
          , "32"
          , "148"
          , "41"
          )
          ; <(s-step(
              | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
              , "148"
              , "33"
              , "148"
              , "34"
              )
              ; lt)> (y, z)
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A3-aux"
             , "147"
             , "2"
             , "148"
             , "41"
             )
             ; fail

  A3 :
    Foo(x, y) -> <r-exit(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "A3"
                  , "155"
                  , "2"
                  , "157"
                  , "54"
                  )> <s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                      , "156"
                      , "18"
                      , "156"
                      , "41"
                      )
                      ; fetch-elem(
                          s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "156"
                          , "29"
                          , "156"
                          , "40"
                          )
                          ; A3-aux(|x, y)
                        )> closures
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "A3", "155,2,157,54")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A3"
             , "155"
             , "2"
             , "157"
             , "54"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "157"
          , "10"
          , "157"
          , "54"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "157"
             , "10"
             , "157"
             , "42"
             )
             ; dr-lookup-rule(
               | "A3"
               , Foo(x, [])
               )) => closures
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "A3"
             , "155"
             , "2"
             , "157"
             , "54"
             )
             ; fail

  bagof-A3 :
    Foo(x, y) -> <r-exit(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "bagof-A3"
                  , "168"
                  , "2"
                  , "170"
                  , "63"
                  )> <s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                      , "169"
                      , "18"
                      , "169"
                      , "37"
                      )
                      ; filter(
                          s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "169"
                          , "25"
                          , "169"
                          , "36"
                          )
                          ; A3-aux(|x, y)
                        )> closures
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "bagof-A3", "168,2,170,63")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "bagof-A3"
             , "168"
             , "2"
             , "170"
             , "63"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "170"
          , "10"
          , "170"
          , "63"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "170"
             , "11"
             , "170"
             , "50"
             )
             ; (s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "170"
                , "11"
                , "170"
                , "43"
                )
                ; dr-lookup-rule(
                  | "A3"
                  , Foo(x, [])
                  )
                <+ s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                   , "170"
                   , "48"
                   , "170"
                   , "50"
                   )
                   ; ![])) => closures
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "bagof-A3"
             , "168"
             , "2"
             , "170"
             , "63"
             )
             ; fail

  fold-A3(c|n):
    Foo(x, y) -> <r-exit(
                  | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                  , "fold-A3"
                  , "172"
                  , "2"
                  , "174"
                  , "63"
                  )> <s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                      , "173"
                      , "18"
                      , "173"
                      , "48"
                      )
                      ; filterfold(
                          s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "173"
                          , "29"
                          , "173"
                          , "29"
                          )
                          ; c
                        , s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "173"
                          , "32"
                          , "173"
                          , "43"
                          )
                          ; A3-aux(|x, y)
                        | n
                        )> closures
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "fold-A3", "172,2,174,63")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "fold-A3"
             , "172"
             , "2"
             , "174"
             , "63"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "174"
          , "10"
          , "174"
          , "63"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "174"
             , "11"
             , "174"
             , "50"
             )
             ; (s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "174"
                , "11"
                , "174"
                , "43"
                )
                ; dr-lookup-rule(
                  | "A3"
                  , Foo(x, [])
                  )
                <+ s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                   , "174"
                   , "48"
                   , "174"
                   , "50"
                   )
                   ; ![])) => closures
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "fold-A3"
             , "172"
             , "2"
             , "174"
             , "63"
             )
             ; fail

  filterfold(c, s|n):
    [] -> <r-exit(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "filterfold"
           , "176"
           , "2"
           , "177"
           , "10"
           )> n
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "filterfold", "176,2,177,10")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "filterfold"
             , "176"
             , "2"
             , "177"
             , "10"
             )
             ; fail

  filterfold(c, s|n):
    [x|xs] -> <r-exit(
               | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
               , "filterfold"
               , "179"
               , "2"
               , "181"
               , "39"
               )> <s-step(
                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                   , "180"
                   , "17"
                   , "180"
                   , "37"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                      , "180"
                      , "17"
                      , "180"
                      , "30"
                      )
                      ; <(s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "180"
                          , "18"
                          , "180"
                          , "18"
                          )
                          ; c)> ( <s-step(
                                   | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                                   , "180"
                                   , "22"
                                   , "180"
                                   , "22"
                                   )
                                   ; s> x
                                , ys
                                )
                      <+ s-step(
                         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                         , "180"
                         , "35"
                         , "180"
                         , "37"
                         )
                         ; !ys)>
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str", "filterfold", "179,2,181,39")
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "filterfold"
             , "179"
             , "2"
             , "181"
             , "39"
             )
             ; fail
    where s-step(
          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
          , "181"
          , "10"
          , "181"
          , "39"
          )
          ; (s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "181"
             , "10"
             , "181"
             , "33"
             )
             ; <(s-step(
                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                 , "181"
                 , "11"
                 , "181"
                 , "29"
                 )
                 ; filterfold(
                     s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                     , "181"
                     , "22"
                     , "181"
                     , "22"
                     )
                     ; c
                   , s-step(
                     | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                     , "181"
                     , "25"
                     , "181"
                     , "25"
                     )
                     ; s
                   | n
                   ))> xs) => ys
          <+ r-exit(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "filterfold"
             , "179"
             , "2"
             , "181"
             , "39"
             )
             ; fail

  test-add-1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-add-1"
    , "183"
    , "2"
    , "194"
    , "2"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "184"
      , "4"
      , "194"
      , "2"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "184"
        , "15"
        , "184"
        , "27"
        )
        ; !"test-add-1"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "185"
        , "6"
        , "185"
        , "14"
        )
        ; Strategy3
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "186"
        , "6"
        , "189"
        , "117"
        )
        ; ![ FooGen(1, 10)
           , Foo(1, 2)
           , Foo(1, 12)
           , FooDef("f", 0)
           , Foo(2, 2)
           , Foo(1, 3)
           , Foo(1, 12)
           , FooGen("f", 1, 20)
           , FooGen("f", 1, 21)
           , Foo(1, 2)
           , FooDef("g", 0)
           , Foo(1, 5)
           , Foo(1, 21)
           , FooGen("g", 1, 30)
           , Foo(1, 7)
           , FooGen("g", 1, 28)
           , FooGen("g", 1, 26)
           , Foo(1, 27)
           , FooDef("h", 0)
           , FooGen("g", 1, 40)
           , FooGen("g", 1, 50)
           , FooKill("g", 1)
           , Foo(1, 8)
           , FooKill("h", 1)
           , Foo(1, 9)
           ]
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "190"
        , "6"
        , "193"
        , "117"
        )
        ; ![ FooGen(1, 10)
           , Bar(2, 10)
           , Foo(1, 12)
           , FooDef("f", 0)
           , Foo(2, 2)
           , Bar(3, 10)
           , Foo(1, 12)
           , FooGen("f", 1, 20)
           , FooGen("f", 1, 21)
           , Bar(2, 21)
           , FooDef("g", 0)
           , Bar(5, 21)
           , Foo(1, 21)
           , FooGen("g", 1, 30)
           , Bar(7, 30)
           , FooGen("g", 1, 28)
           , FooGen("g", 1, 26)
           , Bar(27, 28)
           , FooDef("h", 0)
           , FooGen("g", 1, 40)
           , FooGen("g", 1, 50)
           , FooKill("g", 1)
           , Foo(1, 8)
           , FooKill("h", 1)
           , Foo(1, 9)
           ]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-add-1"
      , "183"
      , "2"
      , "194"
      , "2"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-add-1"
      , "183"
      , "2"
      , "194"
      , "2"
      )
      ; fail

  test-add-bagof =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-add-bagof"
    , "196"
    , "2"
    , "209"
    , "2"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "197"
      , "4"
      , "209"
      , "2"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "197"
        , "15"
        , "197"
        , "31"
        )
        ; !"test-add-bagof"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "198"
        , "6"
        , "198"
        , "20"
        )
        ; Strategy3-bagof
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "199"
        , "6"
        , "203"
        , "52"
        )
        ; ![ FooGen(1, 10)
           , Foo(1, 2)
           , Foo(1, 12)
           , FooDef("f", 0)
           , Foo(2, 2)
           , Foo(1, 3)
           , Foo(1, 12)
           , FooGen("f", 1, 20)
           , FooGen("f", 1, 21)
           , Foo(1, 2)
           , FooDef("g", 0)
           , Foo(1, 5)
           , Foo(1, 21)
           , FooGen("g", 1, 30)
           , Foo(1, 7)
           , FooGen("g", 1, 28)
           , FooGen("g", 1, 26)
           , Foo(1, 27)
           , FooDef("h", 0)
           , FooGen("h", 2, 60)
           , FooGen("g", 1, 40)
           , FooGen("g", 1, 50)
           , FooKill("g", 1)
           , Foo(1, 8)
           , FooKill("h", 1)
           , Foo(1, 9)
           , FooDef("i", 0)
           , FooGen("i", 1, 70)
           , Foo(2, 3)
           ]
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "204"
        , "6"
        , "208"
        , "55"
        )
        ; ![ FooGen(1, 10)
           , [Bar(2, 10)]
           , []
           , FooDef("f", 0)
           , []
           , [Bar(3, 10)]
           , []
           , FooGen("f", 1, 20)
           , FooGen("f", 1, 21)
           , [ Bar(2, 21)
             , Bar(2, 20)
             ]
           , FooDef("g", 0)
           , [ Bar(5, 21)
             , Bar(5, 20)
             ]
           , []
           , FooGen("g", 1, 30)
           , [Bar(7, 30)]
           , FooGen("g", 1, 28)
           , FooGen("g", 1, 26)
           , [ Bar(27, 28)
             , Bar(27, 30)
             ]
           , FooDef("h", 0)
           , FooGen("h", 2, 60)
           , FooGen("g", 1, 40)
           , FooGen("g", 1, 50)
           , FooKill("g", 1)
           , []
           , FooKill("h", 1)
           , []
           , FooDef("i", 0)
           , FooGen("i", 1, 70)
           , [Bar(3, 60)]
           ]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-add-bagof"
      , "196"
      , "2"
      , "209"
      , "2"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-add-bagof"
      , "196"
      , "2"
      , "209"
      , "2"
      )
      ; fail

  test-dr-fork-and-union =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-dr-fork-and-union"
    , "211"
    , "2"
    , "221"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "212"
      , "4"
      , "221"
      , "1"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
       , "212"
       , "4"
       , "216"
       , "1"
       )
       ; apply-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "212"
           , "15"
           , "212"
           , "40"
           )
           ; !"test-dr-fork-and-union1"
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "213"
           , "3"
           , "213"
           , "34"
           )
           ; test-dr-fork-and-union-strategy1
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "214"
           , "3"
           , "214"
           , "5"
           )
           ; !()
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "215"
           , "3"
           , "215"
           , "13"
           )
           ; !["a", "b"]
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "217"
      , "4"
      , "221"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "217"
        , "15"
        , "217"
        , "40"
        )
        ; !"test-dr-fork-and-union2"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "218"
        , "3"
        , "218"
        , "34"
        )
        ; test-dr-fork-and-union-strategy2
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "219"
        , "3"
        , "219"
        , "5"
        )
        ; !()
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
        , "220"
        , "3"
        , "220"
        , "13"
        )
        ; !["a", "b"]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-fork-and-union"
      , "211"
      , "2"
      , "221"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-fork-and-union"
      , "211"
      , "2"
      , "221"
      , "1"
      )
      ; fail

  test-dr-fork-and-union-strategy1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-dr-fork-and-union-strategy1"
    , "223"
    , "2"
    , "227"
    , "5"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "224"
      , "4"
      , "227"
      , "5"
      )
    ; {|A:
         s-step(
         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
         , "225"
         , "6"
         , "226"
         , "12"
         )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "225"
            , "6"
            , "225"
            , "73"
            )
            ; dr-fork-and-union(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "225"
                , "24"
                , "225"
                , "42"
                )
                ; rules ( A :
                            _ -> "b" )
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "225"
                , "45"
                , "225"
                , "64"
                )
                ; rules ( A :
                            _ -> "a" )
              | ["A"]
              ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "226"
           , "6"
           , "226"
           , "12"
           )
         ; bagof-A
      |}
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-fork-and-union-strategy1"
      , "223"
      , "2"
      , "227"
      , "5"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-fork-and-union-strategy1"
      , "223"
      , "2"
      , "227"
      , "5"
      )
      ; fail

  test-dr-fork-and-union-strategy2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-dr-fork-and-union-strategy2"
    , "229"
    , "2"
    , "234"
    , "5"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "230"
      , "4"
      , "234"
      , "5"
      )
    ; {|A:
         s-step(
         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
         , "231"
         , "6"
         , "233"
         , "12"
         )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "231"
            , "6"
            , "231"
            , "25"
            )
            ; rules ( A :
                        _ -> "a" ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "232"
           , "6"
           , "233"
           , "12"
           )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "232"
            , "6"
            , "232"
            , "55"
            )
            ; dr-fork-and-union(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "232"
                , "24"
                , "232"
                , "42"
                )
                ; rules ( A :
                            _ -> "b" )
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "232"
                , "45"
                , "232"
                , "46"
                )
                ; id
              | ["A"]
              ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "233"
           , "6"
           , "233"
           , "12"
           )
         ; bagof-A
      |}
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-fork-and-union-strategy2"
      , "229"
      , "2"
      , "234"
      , "5"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-fork-and-union-strategy2"
      , "229"
      , "2"
      , "234"
      , "5"
      )
      ; fail

  test-dr-ignore-state =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
    , "test-dr-ignore-state"
    , "236"
    , "2"
    , "256"
    , "5"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "237"
      , "4"
      , "256"
      , "5"
      )
    ; {|A, B:
         s-step(
         | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
         , "238"
         , "8"
         , "255"
         , "6"
         )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "238"
            , "8"
            , "238"
            , "27"
            )
            ; rules ( A :
                        _ -> "a" ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "239"
           , "8"
           , "255"
           , "6"
           )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "239"
            , "8"
            , "239"
            , "27"
            )
            ; rules ( B :
                        _ -> "b" ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "241"
           , "6"
           , "255"
           , "6"
           )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "241"
            , "6"
            , "245"
            , "6"
            )
            ; apply-test(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "241"
                , "17"
                , "241"
                , "53"
                )
                ; !"Ignore the state of a dynamic rule"
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "242"
                , "8"
                , "242"
                , "36"
                )
                ; dr-ignore-state(
                    s-step(
                    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                    , "242"
                    , "24"
                    , "242"
                    , "29"
                    )
                    ; (s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "242"
                       , "24"
                       , "242"
                       , "24"
                       )
                       ; A
                       <+ s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "242"
                          , "29"
                          , "242"
                          , "29"
                          )
                          ; B)
                  | "A"
                  )
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "243"
                , "8"
                , "243"
                , "10"
                )
                ; !()
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "244"
                , "8"
                , "244"
                , "11"
                )
                ; !"b"
              ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "246"
           , "6"
           , "255"
           , "6"
           )
         ; (s-step(
            | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
            , "246"
            , "6"
            , "250"
            , "6"
            )
            ; apply-test(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "246"
                , "17"
                , "246"
                , "53"
                )
                ; !"Ignore the state of a dynamic rule"
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "247"
                , "8"
                , "247"
                , "36"
                )
                ; dr-ignore-state(
                    s-step(
                    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                    , "247"
                    , "24"
                    , "247"
                    , "29"
                    )
                    ; (s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "247"
                       , "24"
                       , "247"
                       , "24"
                       )
                       ; B
                       <+ s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "247"
                          , "29"
                          , "247"
                          , "29"
                          )
                          ; A)
                  | "B"
                  )
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "248"
                , "8"
                , "248"
                , "10"
                )
                ; !()
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                , "249"
                , "8"
                , "249"
                , "11"
                )
                ; !"a"
              ))
         ; s-step(
           | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
           , "251"
           , "6"
           , "255"
           , "6"
           )
         ; apply-test(
             s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "251"
             , "17"
             , "251"
             , "53"
             )
             ; !"Ignore the state of a dynamic rule"
           , s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "252"
             , "8"
             , "252"
             , "57"
             )
             ; dr-ignore-states(
                 s-step(
                 | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                 , "252"
                 , "25"
                 , "252"
                 , "43"
                 )
                 ; (s-step(
                    | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                    , "252"
                    , "25"
                    , "252"
                    , "25"
                    )
                    ; B
                    <+ s-step(
                       | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                       , "252"
                       , "30"
                       , "252"
                       , "43"
                       )
                       ; (s-step(
                          | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                          , "252"
                          , "30"
                          , "252"
                          , "30"
                          )
                          ; A
                          <+ s-step(
                             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
                             , "252"
                             , "35"
                             , "252"
                             , "43"
                             )
                             ; !"failed"))
               | ["A", "B"]
               )
           , s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "253"
             , "8"
             , "253"
             , "10"
             )
             ; !()
           , s-step(
             | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
             , "254"
             , "8"
             , "254"
             , "16"
             )
             ; !"failed"
           )
      |}
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-ignore-state"
      , "236"
      , "2"
      , "256"
      , "5"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/dynamic-rules-highlevel-test.str"
      , "test-dr-ignore-state"
      , "236"
      , "2"
      , "256"
      , "5"
      )
      ; fail