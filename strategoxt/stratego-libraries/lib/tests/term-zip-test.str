module term-zip-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    Node : a * List(RoseTree(a)) -> RoseTree(a)
    Var  : String -> RoseTree(a)


strategies
  main-term-zip-test =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "main-term-zip-test"
    , "10"
    , "2"
    , "19"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "11"
      , "4"
      , "19"
      , "4"
      )
    ; test-suite(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "11"
        , "15"
        , "11"
        , "30"
        )
        ; !"term-zip-test"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "12"
        , "1"
        , "18"
        , "5"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "12"
           , "1"
           , "12"
           , "5"
           )
           ; test1)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
          , "13"
          , "1"
          , "18"
          , "5"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "13"
           , "1"
           , "13"
           , "5"
           )
           ; test2)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
          , "14"
          , "1"
          , "18"
          , "5"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "14"
           , "1"
           , "14"
           , "5"
           )
           ; test3)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
          , "15"
          , "1"
          , "18"
          , "5"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "15"
           , "1"
           , "15"
           , "5"
           )
           ; test4)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
          , "16"
          , "1"
          , "18"
          , "5"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "16"
           , "1"
           , "16"
           , "5"
           )
           ; test5)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
          , "17"
          , "1"
          , "18"
          , "5"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "17"
           , "1"
           , "17"
           , "5"
           )
           ; test6)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
          , "18"
          , "1"
          , "18"
          , "5"
          )
        ; test7
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "main-term-zip-test"
      , "10"
      , "2"
      , "19"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "main-term-zip-test"
      , "10"
      , "2"
      , "19"
      , "4"
      )
      ; fail

  test1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test1"
    , "21"
    , "2"
    , "33"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "22"
      , "4"
      , "33"
      , "1"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
       , "22"
       , "4"
       , "27"
       , "1"
       )
       ; apply-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "22"
           , "15"
           , "22"
           , "23"
           )
           ; !"test1a"
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "23"
           , "2"
           , "23"
           , "30"
           )
           ; term-zip(
               s-step(
               | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
               , "23"
               , "11"
               , "23"
               , "25"
               )
               ; ( s-step(
                   | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                   , "23"
                   , "12"
                   , "23"
                   , "17"
                   )
                   ; is-int
                 , s-step(
                   | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                   , "23"
                   , "19"
                   , "23"
                   , "24"
                   )
                   ; is-int
                 )
             , s-step(
               | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
               , "23"
               , "28"
               , "23"
               , "29"
               )
               ; id
             )
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "24"
           , "2"
           , "25"
           , "18"
           )
           ; !( [1, 2, 3]
              , [4, 5, 6]
              )
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "26"
           , "2"
           , "26"
           , "21"
           )
           ; ![ (1, 4)
              , (2, 5)
              , (3, 6)
              ]
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "28"
      , "4"
      , "33"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "28"
        , "15"
        , "28"
        , "23"
        )
        ; !"test1b"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "29"
        , "2"
        , "29"
        , "30"
        )
        ; term-zip(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "29"
            , "11"
            , "29"
            , "25"
            )
            ; ( s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "29"
                , "12"
                , "29"
                , "17"
                )
                ; is-int
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "29"
                , "19"
                , "29"
                , "24"
                )
                ; is-int
              )
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "29"
            , "28"
            , "29"
            , "29"
            )
            ; id
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "30"
        , "2"
        , "31"
        , "24"
        )
        ; !( [ [1]
             , [2]
             , [3]
             ]
           , [ [4]
             , [5]
             , [6]
             ]
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "32"
        , "2"
        , "32"
        , "27"
        )
        ; ![ [(1, 4)]
           , [(2, 5)]
           , [(3, 6)]
           ]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test1"
      , "21"
      , "2"
      , "33"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test1"
      , "21"
      , "2"
      , "33"
      , "1"
      )
      ; fail

  test2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test2"
    , "35"
    , "2"
    , "41"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "36"
      , "4"
      , "41"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "36"
        , "15"
        , "36"
        , "22"
        )
        ; !"test2"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "37"
        , "2"
        , "37"
        , "30"
        )
        ; term-zip(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "37"
            , "11"
            , "37"
            , "25"
            )
            ; ( s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "37"
                , "12"
                , "37"
                , "17"
                )
                ; is-int
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "37"
                , "19"
                , "37"
                , "24"
                )
                ; is-int
              )
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "37"
            , "28"
            , "37"
            , "29"
            )
            ; id
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "38"
        , "2"
        , "39"
        , "42"
        )
        ; !( Node(
               1
             , [ Node(2, [])
               , Node(3, [])
               ]
             )
           , Node(
               4
             , [ Node(5, [])
               , Node(6, [])
               ]
             )
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "40"
        , "2"
        , "40"
        , "45"
        )
        ; !Node(
             (1, 4)
           , [ Node((2, 5), [])
             , Node((3, 6), [])
             ]
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test2"
      , "35"
      , "2"
      , "41"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test2"
      , "35"
      , "2"
      , "41"
      , "1"
      )
      ; fail

  test3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test3"
    , "43"
    , "2"
    , "49"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "44"
      , "4"
      , "49"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "44"
        , "15"
        , "44"
        , "22"
        )
        ; !"test3"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "45"
        , "2"
        , "45"
        , "30"
        )
        ; term-zip(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "45"
            , "11"
            , "45"
            , "25"
            )
            ; ( s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "45"
                , "12"
                , "45"
                , "17"
                )
                ; is-int
              , s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "45"
                , "19"
                , "45"
                , "24"
                )
                ; is-int
              )
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "45"
            , "28"
            , "45"
            , "29"
            )
            ; id
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "46"
        , "2"
        , "47"
        , "42"
        )
        ; !( Node(
               1
             , [ Node(2, [])
               , Node(3, [])
               ]
             )
           , Node(
               1
             , [ Node(5, [])
               , Node(6, [])
               ]
             )
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "48"
        , "2"
        , "48"
        , "45"
        )
        ; !Node(
             (1, 1)
           , [ Node((2, 5), [])
             , Node((3, 6), [])
             ]
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test3"
      , "43"
      , "2"
      , "49"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test3"
      , "43"
      , "2"
      , "49"
      , "1"
      )
      ; fail

  test4 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test4"
    , "51"
    , "2"
    , "57"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "52"
      , "4"
      , "57"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "52"
        , "15"
        , "52"
        , "22"
        )
        ; !"test4"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "53"
        , "2"
        , "53"
        , "18"
        )
        ; term-zip(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "53"
            , "11"
            , "53"
            , "13"
            )
            ; add
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "53"
            , "16"
            , "53"
            , "17"
            )
            ; id
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "54"
        , "2"
        , "55"
        , "42"
        )
        ; !( Node(
               1
             , [ Node(2, [])
               , Node(3, [])
               ]
             )
           , Node(
               4
             , [ Node(5, [])
               , Node(6, [])
               ]
             )
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "56"
        , "2"
        , "56"
        , "33"
        )
        ; !Node(
             5
           , [ Node(7, [])
             , Node(9, [])
             ]
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test4"
      , "51"
      , "2"
      , "57"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test4"
      , "51"
      , "2"
      , "57"
      , "1"
      )
      ; fail

  test5 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test5"
    , "59"
    , "2"
    , "66"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "60"
      , "4"
      , "66"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "60"
        , "15"
        , "60"
        , "22"
        )
        ; !"test5"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "61"
        , "2"
        , "61"
        , "27"
        )
        ; term-zip(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "61"
            , "11"
            , "61"
            , "22"
            )
            ; tmap(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "61"
                , "16"
                , "61"
                , "21"
                )
                ; is-int
              )
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "61"
            , "25"
            , "61"
            , "26"
            )
            ; id
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "62"
        , "2"
        , "64"
        , "42"
        )
        ; !( Node(
               1
             , [ Node(2, [])
               , Node(3, [])
               ]
             )
           , Node(
               4
             , [ Node(5, [])
               , Node(6, [])
               ]
             )
           , Node(
               7
             , [ Node(8, [])
               , Node(9, [])
               ]
             )
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "65"
        , "2"
        , "65"
        , "51"
        )
        ; !Node(
             (1, 4, 7)
           , [ Node(
                 (2, 5, 8)
               , []
               )
             , Node(
                 (3, 6, 9)
               , []
               )
             ]
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test5"
      , "59"
      , "2"
      , "66"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test5"
      , "59"
      , "2"
      , "66"
      , "1"
      )
      ; fail

  test6 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test6"
    , "68"
    , "2"
    , "74"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "69"
      , "4"
      , "74"
      , "1"
      )
    ; apply-and-fail(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "69"
        , "19"
        , "69"
        , "26"
        )
        ; !"test6"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "70"
        , "2"
        , "70"
        , "27"
        )
        ; term-zip(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "70"
            , "11"
            , "70"
            , "22"
            )
            ; tmap(
                s-step(
                | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
                , "70"
                , "16"
                , "70"
                , "21"
                )
                ; is-int
              )
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "70"
            , "25"
            , "70"
            , "26"
            )
            ; id
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "71"
        , "2"
        , "73"
        , "31"
        )
        ; !( Node(
               1
             , [ Node(2, [])
               , Node(3, [])
               ]
             )
           , Node(
               4
             , [ Node(5, [])
               , Node(6, [])
               ]
             )
           , Node(
               7
             , [Node(8, [])]
             )
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test6"
      , "68"
      , "2"
      , "74"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test6"
      , "68"
      , "2"
      , "74"
      , "1"
      )
      ; fail

  pattern-match =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "pattern-match"
    , "76"
    , "2"
    , "78"
    , "29"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "77"
      , "4"
      , "78"
      , "29"
      )
    ; term-zip(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "77"
        , "13"
        , "77"
        , "47"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
           , "77"
           , "13"
           , "77"
           , "19"
           )
           ; (s-step(
              | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
              , "77"
              , "13"
              , "77"
              , "14"
              )
              ; eq)
           ; s-step(
             | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
             , "77"
             , "17"
             , "77"
             , "19"
             )
           ; ![]
           + s-step(
             | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
             , "77"
             , "23"
             , "77"
             , "47"
             )
             ; \ (Var(x), y) -> [(x, y)] \)
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "78"
        , "13"
        , "78"
        , "28"
        )
        ; crush(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "78"
            , "19"
            , "78"
            , "21"
            )
            ; ![]
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
            , "78"
            , "23"
            , "78"
            , "27"
            )
            ; union
          )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "pattern-match"
      , "76"
      , "2"
      , "78"
      , "29"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "pattern-match"
      , "76"
      , "2"
      , "78"
      , "29"
      )
      ; fail

  test7 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
    , "test7"
    , "80"
    , "2"
    , "86"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "81"
      , "4"
      , "86"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "81"
        , "15"
        , "81"
        , "22"
        )
        ; !"test7"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "82"
        , "2"
        , "82"
        , "14"
        )
        ; pattern-match
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "83"
        , "2"
        , "84"
        , "42"
        )
        ; !( Node(
               1
             , [ Var("x")
               , Node(3, [])
               ]
             )
           , Node(
               1
             , [ Node(2, [])
               , Node(3, [])
               ]
             )
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
        , "85"
        , "2"
        , "85"
        , "21"
        )
        ; ![ ("x", Node(2, []))
           ]
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test7"
      , "80"
      , "2"
      , "86"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/term-zip-test.str"
      , "test7"
      , "80"
      , "2"
      , "86"
      , "1"
      )
      ; fail