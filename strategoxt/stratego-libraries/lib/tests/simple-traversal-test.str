module simple-traversal-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


signature
  constructors
    F : Term * Term -> Term
    G : Term * Term -> Term
    A : Term
    B : Term


strategies
  main-simple-traversal-test =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
    , "main-simple-traversal-test"
    , "11"
    , "2"
    , "16"
    , "4"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "12"
      , "4"
      , "16"
      , "4"
      )
    ; test-suite(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "12"
        , "15"
        , "12"
        , "38"
        )
        ; !"simple-traversal-test"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "13"
        , "6"
        , "15"
        , "10"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "13"
           , "6"
           , "13"
           , "10"
           )
           ; test1)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
          , "14"
          , "6"
          , "15"
          , "10"
          )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "14"
           , "6"
           , "14"
           , "10"
           )
           ; test2)
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
          , "15"
          , "6"
          , "15"
          , "10"
          )
        ; test3
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "main-simple-traversal-test"
      , "11"
      , "2"
      , "16"
      , "4"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "main-simple-traversal-test"
      , "11"
      , "2"
      , "16"
      , "4"
      )
      ; fail

  test1 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
    , "test1"
    , "18"
    , "2"
    , "27"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "19"
      , "4"
      , "27"
      , "1"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
       , "19"
       , "4"
       , "23"
       , "1"
       )
       ; apply-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "19"
           , "15"
           , "19"
           , "23"
           )
           ; !"test1a"
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "20"
           , "3"
           , "20"
           , "11"
           )
           ; all(s-step(
                 | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                 , "20"
                 , "7"
                 , "20"
                 , "10"
                 )
                 ; fail)
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "21"
           , "3"
           , "21"
           , "4"
           )
           ; !A
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "22"
           , "3"
           , "22"
           , "4"
           )
           ; !A
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "24"
      , "4"
      , "27"
      , "1"
      )
    ; apply-and-fail(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "24"
        , "19"
        , "24"
        , "27"
        )
        ; !"test1b"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "25"
        , "3"
        , "25"
        , "11"
        )
        ; all(s-step(
              | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
              , "25"
              , "7"
              , "25"
              , "10"
              )
              ; fail)
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "26"
        , "3"
        , "26"
        , "24"
        )
        ; !F(
             G(B, F(A, B))
           , F(B, A)
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "test1"
      , "18"
      , "2"
      , "27"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "test1"
      , "18"
      , "2"
      , "27"
      , "1"
      )
      ; fail

  f(x) =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
    , "f"
    , "29"
    , "2"
    , "29"
    , "15"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "29"
      , "9"
      , "29"
      , "15"
      )
    ; F(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "29"
        , "11"
        , "29"
        , "11"
        )
        ; x
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "29"
        , "13"
        , "29"
        , "14"
        )
        ; id
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "f"
      , "29"
      , "2"
      , "29"
      , "15"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "f"
      , "29"
      , "2"
      , "29"
      , "15"
      )
      ; fail

  test2 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
    , "test2"
    , "31"
    , "2"
    , "41"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "32"
      , "4"
      , "41"
      , "1"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
       , "32"
       , "4"
       , "36"
       , "1"
       )
       ; apply-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "32"
           , "15"
           , "32"
           , "22"
           )
           ; !"test2"
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "33"
           , "3"
           , "33"
           , "23"
           )
           ; leaves(
               s-step(
               | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
               , "33"
               , "10"
               , "33"
               , "11"
               )
               ; !A
             , s-step(
               | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
               , "33"
               , "14"
               , "33"
               , "22"
               )
               ; all(s-step(
                     | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                     , "33"
                     , "18"
                     , "33"
                     , "21"
                     )
                     ; fail)
             )
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "34"
           , "3"
           , "34"
           , "24"
           )
           ; !F(
                G(B, F(A, B))
              , F(B, A)
              )
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "35"
           , "3"
           , "35"
           , "24"
           )
           ; !F(
                G(A, F(A, A))
              , F(A, A)
              )
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "37"
      , "4"
      , "41"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "37"
        , "15"
        , "37"
        , "22"
        )
        ; !"test2"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "38"
        , "3"
        , "38"
        , "26"
        )
        ; leaves(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
            , "38"
            , "10"
            , "38"
            , "11"
            )
            ; !A
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
            , "38"
            , "14"
            , "38"
            , "22"
            )
            ; all(s-step(
                  | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                  , "38"
                  , "18"
                  , "38"
                  , "21"
                  )
                  ; fail)
          , s-step(
            | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
            , "38"
            , "25"
            , "38"
            , "25"
            )
            ; f
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "39"
        , "3"
        , "39"
        , "24"
        )
        ; !F(
             G(B, F(B, B))
           , F(B, B)
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "40"
        , "3"
        , "40"
        , "24"
        )
        ; !F(
             G(A, F(A, B))
           , F(B, B)
           )
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "test2"
      , "31"
      , "2"
      , "41"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "test2"
      , "31"
      , "2"
      , "41"
      , "1"
      )
      ; fail

  test3 =
    s-enter(
    | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
    , "test3"
    , "43"
    , "2"
    , "55"
    , "1"
    )
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "44"
      , "4"
      , "55"
      , "1"
      )
    ; (s-step(
       | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
       , "44"
       , "4"
       , "49"
       , "1"
       )
       ; apply-test(
           s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "44"
           , "15"
           , "44"
           , "23"
           )
           ; !"test3a"
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "45"
           , "3"
           , "46"
           , "71"
           )
           ; (s-step(
              | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
              , "45"
              , "3"
              , "45"
              , "26"
              )
              ; where(s-step(
                      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                      , "45"
                      , "9"
                      , "45"
                      , "25"
                      )
                      ; (s-step(
                         | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                         , "45"
                         , "9"
                         , "45"
                         , "19"
                         )
                         ; new-counter) => c1))
           ; s-step(
             | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
             , "46"
             , "12"
             , "46"
             , "71"
             )
           ; (s-step(
              | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
              , "46"
              , "12"
              , "46"
              , "16"
              )
              ; debug)
           ; s-step(
             | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
             , "46"
             , "19"
             , "46"
             , "71"
             )
           ; bottomup(
               s-step(
               | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
               , "46"
               , "28"
               , "46"
               , "70"
               )
               ; (s-step(
                  | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                  , "46"
                  , "28"
                  , "46"
                  , "32"
                  )
                  ; debug)
               ; s-step(
                 | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                 , "46"
                 , "35"
                 , "46"
                 , "70"
                 )
               ; (s-step(
                  | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                  , "46"
                  , "35"
                  , "46"
                  , "63"
                  )
                  ; \ t -> t{ <s-step(
                               | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                               , "46"
                               , "45"
                               , "46"
                               , "56"
                               )
                               ; next-counter> c1
                            } \)
               ; s-step(
                 | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                 , "46"
                 , "66"
                 , "46"
                 , "70"
                 )
               ; debug
             )
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "47"
           , "3"
           , "47"
           , "24"
           )
           ; !F(
                G(B, F(A, B))
              , F(B, A)
              )
         , s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "48"
           , "3"
           , "48"
           , "51"
           )
           ; !F(
                G(
                  B{1}
                , F(
                    A{2}
                  , B{3}
                  ){4}
                ){5}
              , F(
                  B{6}
                , A{7}
                ){8}
              ){9}
         ))
    ; s-step(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "50"
      , "4"
      , "55"
      , "1"
      )
    ; apply-test(
        s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "50"
        , "15"
        , "50"
        , "23"
        )
        ; !"test3b"
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "51"
        , "3"
        , "52"
        , "50"
        )
        ; (s-step(
           | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
           , "51"
           , "3"
           , "51"
           , "26"
           )
           ; where(s-step(
                   | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                   , "51"
                   , "9"
                   , "51"
                   , "25"
                   )
                   ; (s-step(
                      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                      , "51"
                      , "9"
                      , "51"
                      , "19"
                      )
                      ; new-counter) => c2))
        ; s-step(
          | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
          , "52"
          , "12"
          , "52"
          , "50"
          )
        ; topdown(
            s-step(
            | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
            , "52"
            , "20"
            , "52"
            , "48"
            )
            ; \ t -> t{ <s-step(
                         | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
                         , "52"
                         , "30"
                         , "52"
                         , "41"
                         )
                         ; next-counter> c2
                      } \
          )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "53"
        , "3"
        , "53"
        , "24"
        )
        ; !F(
             G(B, F(A, B))
           , F(B, A)
           )
      , s-step(
        | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
        , "54"
        , "3"
        , "54"
        , "51"
        )
        ; !F(
             G(
               B{3}
             , F(
                 A{5}
               , B{6}
               ){4}
             ){2}
           , F(
               B{8}
             , A{9}
             ){7}
           ){1}
      )
    < s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "test3"
      , "43"
      , "2"
      , "55"
      , "1"
      )
    + s-exit(
      | "strategoxt/stratego-libraries/lib/tests/simple-traversal-test.str"
      , "test3"
      , "43"
      , "2"
      , "55"
      , "1"
      )
      ; fail