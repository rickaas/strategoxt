module list-zip-test

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib


strategies
  main-list-zip-test =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "main-list-zip-test", "5,2,9,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "6,4,9,4")
    ; test-suite(
        s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "6,15,6,30")
        ; !"list-zip-test"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "7,6,8,14")
        ; (s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "7,6,7,15") ; nzip-tests)
        ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "8,6,8,14")
        ; zip-tests
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "main-list-zip-test", "5,2,9,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "main-list-zip-test", "5,2,9,4")
      ; fail

  nzip-tests =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "nzip-tests", "11,2,16,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "12,4,16,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "12,15,12,27")
        ; !"nzip0-test"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "13,6,13,14")
        ; nzip0(
            s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "13,12,13,13") ; id
          )
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "14,6,14,19")
        ; !["a", "b", "c"]
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "15,6,15,36")
        ; ![ (0, "a")
           , (1, "b")
           , (2, "c")
           ]
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "nzip-tests", "11,2,16,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "nzip-tests", "11,2,16,4")
      ; fail

  zip-tests =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "zip-tests", "18,2,37,4")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "19,4,37,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "19,4,25,4")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "19,15,19,26")
           ; !"zip-test1"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "20,6,20,15")
           ; zip(
               s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "20,10,20,14") ; Merge
             )
         , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "21,6,23,7")
           ; !( [ ("foo", 1)
                , ("bar", 2)
                ]
              , [ ("foo", 11)
                , ("bar", 12)
                ]
              )
         , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "24,6,24,40")
           ; ![ ("foo", 1, 11)
              , ("bar", 2, 12)
              ]
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "26,4,37,4")
    ; (s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "26,4,32,4")
       ; apply-test(
           s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "26,15,26,26")
           ; !"zip-test2"
         , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "27,6,27,44")
           ; zipPad(
               s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "27,13,27,17") ; Merge
             , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "27,20,27,42")
               ; !("Unknown", "Unknown")
             )
         , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "28,6,30,7")
           ; !( [ ("foo", 1)
                , ("bar", 2)
                ]
              , [ ("foo", 11)
                , ("bar", 12)
                , ("baz", 13)
                ]
              )
         , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "31,6,31,64")
           ; ![ ("foo", 1, 11)
              , ("bar", 2, 12)
              , ("baz", "Unknown", 13)
              ]
         ))
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "33,4,37,4")
    ; apply-test(
        s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "33,15,33,34")
        ; !"term argument zip"
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "34,6,34,31")
        ; zip(
            s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "34,10,34,19") ; zip-tester
          | [1, 2, 3]
          )
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "35,6,35,21")
        ; ![10, 100, 1000]
      , s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "36,6,36,21")
        ; ![11, 102, 1003]
      )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "zip-tests", "18,2,37,4")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "zip-tests", "18,2,37,4")
      ; fail

  zip-tester(|y) =
    s-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "zip-tester", "39,2,40,18")
    ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "40,4,40,18")
    ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "40,5,40,7") ; add)> ( <s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "40,12,40,13") ; id>
                                                                                                  , y
                                                                                                  )
    < s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "zip-tester", "39,2,40,18")
    + s-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "zip-tester", "39,2,40,18")
      ; fail


strategies
  Merge :
    ( ("Unknown", b)
    , (c, d)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "44,2,44,46")> (c, b, d)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "44,2,44,46")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "44,2,44,46")
             ; fail

  Merge :
    ( (a, b)
    , ("Unknown", d)
    ) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "45,2,45,46")> (a, b, d)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "45,2,45,46")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "45,2,45,46")
             ; fail

  Merge :
    ((a, b), (c, d)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "46,2,46,62")> (a, b, d)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "46,2,46,62")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "46,2,46,62")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "46,45,46,62")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "46,46,46,59")
              ; not(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "46,50,46,58") ; "Unknown"))> a
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge", "46,2,46,62")
             ; fail

  join'(merge1 : a * b -> c, merge2 : a -> c, merge3 : b -> c) :
    (xs, ys) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "join'", "58,2,60,76")> <s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,5,60,72")
                                                                                                               ; filter(
                                                                                                                   s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,12,60,70")
                                                                                                                   ; \ x -> <s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,20,60,65")
                                                                                                                             ; (s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,20,60,44")
                                                                                                                                ; filter(
                                                                                                                                    s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,27,60,43")
                                                                                                                                    ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,28,60,33") ; merge1)> ( x
                                                                                                                                                                                                                                       , <s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,40,60,41") ; id>
                                                                                                                                                                                                                                       )
                                                                                                                                  ))
                                                                                                                             ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,47,60,65")
                                                                                                                             ; try(
                                                                                                                                 s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,51,60,64")
                                                                                                                                 ; (s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,51,60,52") ; [])
                                                                                                                                 ; s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,55,60,64")
                                                                                                                                 ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "60,56,60,61") ; merge2)> x
                                                                                                                               )> ys \
                                                                                                                 )> xs
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "join'", "58,2,60,76")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "join'", "58,2,60,76")
             ; fail

  Merge2 :
    ((a, b), (a, d)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "62,2,62,38")> (a, b, d)
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "62,2,62,38")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "62,2,62,38")
             ; fail

  Merge2 :
    ((a, b), (c, d)) -> <r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "63,2,63,70")> (c, b, "Unknown")
    where r-enter(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "63,2,63,70")
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "63,2,63,70")
             ; fail
    where s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "63,55,63,70")
          ; <(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "63,56,63,62")
              ; not(s-step(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "63,60,63,61") ; eq))> (a, c)
          <+ r-exit(|"strategoxt/stratego-libraries/lib/tests/list-zip-test.str", "Merge2", "63,2,63,70")
             ; fail