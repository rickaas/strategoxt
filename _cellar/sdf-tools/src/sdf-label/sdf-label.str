module sdf-label

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  Sdf2
  verbalize-sdf
  AsFix
  libstratego-lib


signature
  constructors
    empty-layout : a


strategies
  io-sdf-label =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "io-sdf-label", "14,2,15,21")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "15,4,15,21")
    ; io-wrap(
        s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "15,12,15,20") ; sdf-label
      )
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "io-sdf-label", "14,2,15,21")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "io-sdf-label", "14,2,15,21")
      ; fail

  sdf-label =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "sdf-label", "17,2,18,40")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "18,4,18,40")
    ; alltd(
        s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "18,10,18,39")
        ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "18,10,18,19") ; dont-label
           <+ s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "18,24,18,39") ; label-production)
      )
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "sdf-label", "17,2,18,40")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "sdf-label", "17,2,18,40")
      ; fail

  label-production =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "label-production", "20,2,22,30")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,4,22,30")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,4,21,39")
       ; prod(
           s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,9,21,30")
           ; map(
               s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,13,21,29")
               ; try(
                   s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,17,21,28") ; label-symbol
                 )
             )
         , s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,33,21,34") ; id
         , s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "21,37,21,38") ; id
         ))
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "22,6,22,30")
    ; warn-if-labels-not-unique
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "label-production", "20,2,22,30")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "label-production", "20,2,22,30")
      ; fail

  dont-label =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "dont-label", "24,2,29,26")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "25,6,29,26")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "25,6,25,19")
       ; priorities(
           s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "25,17,25,18") ; id
         )
       + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "26,6,29,26")
         ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "26,6,26,32")
            ; context-free-priorities(
                s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "26,30,26,31") ; id
              )
            + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "27,6,29,26")
              ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "27,6,27,27")
                 ; lexical-priorities(
                     s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "27,25,27,26") ; id
                   )
                 + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "28,6,29,26")
                   ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "28,6,28,18")
                      ; variables(
                          s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "28,16,28,17") ; id
                        )
                      + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "29,6,29,26")
                        ; lexical-variables(
                            s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "29,24,29,25") ; id
                          )))))
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "dont-label", "24,2,29,26")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "dont-label", "24,2,29,26")
      ; fail

  warn-if-labels-not-unique =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "warn-if-labels-not-unique", "31,2,39,4")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "32,4,39,4")
    ; if(
        s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "33,6,37,6")
        ; where(s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "34,8,36,23")
                ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "34,8,34,27") ; get-argument-symbols)
                ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "35,8,36,23")
                ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "35,8,35,29")
                   ; filter(
                       s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "35,15,35,28")
                       ; ?label(
                            <s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "35,23,35,24") ; id>
                          , _
                          )
                     ))
                ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "36,8,36,23")
                ; contains-doubles)
      , s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "38,6,38,48")
        ; debug(
            s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "38,12,38,47")
            ; !"Labels not unique in production: "
          )
      )
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "warn-if-labels-not-unique", "31,2,39,4")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "warn-if-labels-not-unique", "31,2,39,4")
      ; fail

  contains-doubles =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "contains-doubles", "41,2,42,20")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "42,4,42,20")
    ; not(s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "42,8,42,19")
          ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "42,8,42,9") ; ?l)
          ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "42,12,42,19")
          ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "42,12,42,15") ; uniq)
          ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "42,18,42,19")
          ; ?l)
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "contains-doubles", "41,2,42,20")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "contains-doubles", "41,2,42,20")
      ; fail

  get-argument-symbols =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "get-argument-symbols", "44,2,45,18")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "45,4,45,18")
    ; ?prod(
         <s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "45,11,45,12") ; id>
       , _
       , _
       )
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "get-argument-symbols", "44,2,45,18")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "get-argument-symbols", "44,2,45,18")
      ; fail

  label-symbol =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "label-symbol", "47,2,50,48")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "48,6,50,48")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "48,6,48,17")
       ; label(
           s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "48,12,48,13") ; id
         , s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "48,15,48,16") ; id
         )
       <+ s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "49,6,50,48")
          ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "49,6,49,52")
             ; \ sort(n) -> label(
                              <s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "49,26,49,39") ; sortname2label> n
                            , sort(n)
                            ) \
             <+ s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "50,6,50,48")
                ; \ sym -> label(
                             <s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "50,26,50,37") ; symbol2label> sym
                           , sym
                           ) \))
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "label-symbol", "47,2,50,48")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "label-symbol", "47,2,50,48")
      ; fail

  sortname2label =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "sortname2label", "53,2,55,22")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "54,4,55,22")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "54,4,54,7") ; lcHd)
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "55,6,55,22")
    ; quote-sdf-keyword
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "sortname2label", "53,2,55,22")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "sortname2label", "53,2,55,22")
      ; fail

  symbol2label =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "symbol2label", "57,2,60,22")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "58,4,60,22")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "58,4,58,11") ; sym2str')
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "59,6,60,22")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "59,6,59,9") ; lcHd)
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "60,6,60,22")
    ; quote-sdf-keyword
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "symbol2label", "57,2,60,22")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "symbol2label", "57,2,60,22")
      ; fail

  lcHd =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "lcHd", "62,2,65,19")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "63,4,65,19")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "63,4,63,17") ; explode-string)
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "64,6,65,19")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "64,6,64,20")
       ; [s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "64,7,64,14") ; to-lower|s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "64,18,64,19") ; id])
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "65,6,65,19")
    ; implode-string
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "lcHd", "62,2,65,19")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "lcHd", "62,2,65,19")
      ; fail

  quote-sdf-keyword =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "quote-sdf-keyword", "67,2,68,38")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "68,4,68,38")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "68,4,68,22")
       ; not(s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "68,8,68,21") ; is-sdf-keyword)
       <+ s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "68,27,68,38") ; double-quote)
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "quote-sdf-keyword", "67,2,68,38")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "quote-sdf-keyword", "67,2,68,38")
      ; fail

  is-sdf-keyword =
    s-enter(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "is-sdf-keyword", "70,2,89,11")
    ; s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "71,6,89,11")
    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "71,6,71,14") ; "aliases"
       + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "72,6,89,11")
         ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "72,6,72,14") ; "lexical"
            + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "73,6,89,11")
              ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "73,6,73,17") ; "priorities"
                 + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "74,6,89,11")
                   ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "74,6,74,19") ; "context-free"
                      + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "75,6,89,11")
                        ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "75,6,75,17") ; "definition"
                           + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "76,6,89,11")
                             ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "76,6,76,13") ; "syntax"
                                + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "77,6,89,11")
                                  ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "77,6,77,16") ; "variables"
                                     + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "78,6,89,11")
                                       ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "78,6,78,13") ; "module"
                                          + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "79,6,89,11")
                                            ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "79,6,79,14") ; "exports"
                                               + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "80,6,89,11")
                                                 ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "80,6,80,14") ; "hiddens"
                                                    + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "81,6,89,11")
                                                      ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "81,6,81,11") ; "left"
                                                         + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "82,6,89,11")
                                                           ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "82,6,82,12") ; "right"
                                                              + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "83,6,89,11")
                                                                ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "83,6,83,12") ; "assoc"
                                                                   + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "84,6,89,11")
                                                                     ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "84,6,84,16") ; "non-assoc"
                                                                        + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "85,6,89,11")
                                                                          ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "85,6,85,14") ; "bracket"
                                                                             + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "86,6,89,11")
                                                                               ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "86,6,86,12") ; "sorts"
                                                                                  + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "87,6,89,11")
                                                                                    ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "87,6,87,19") ; "restrictions"
                                                                                       + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "88,6,89,11")
                                                                                         ; (s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "88,6,88,18") ; "constructor"
                                                                                            + s-step(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "89,6,89,11") ; "memo"))))))))))))))))))
    < s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "is-sdf-keyword", "70,2,89,11")
    + s-exit(|"_cellar/sdf-tools/src/sdf-label/sdf-label.str", "is-sdf-keyword", "70,2,89,11")
      ; fail