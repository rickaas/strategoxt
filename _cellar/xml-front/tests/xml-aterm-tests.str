module xml-aterm-tests

imports
  org.strategoxt.imp.debuggers.stratego.runtime


imports
  libstratego-lib
  libstratego-xtc
  xml-info


strategies
  main-xml-aterm-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "main-xml-aterm-tests"
    , "8"
    , "2"
    , "21"
    , "4"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "9"
      , "4"
      , "21"
      , "4"
      )
    ; option-wrap(
        s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "9"
        , "16"
        , "9"
        , "30"
        )
        ; general-options
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "10"
        , "6"
        , "20"
        , "6"
        )
        ; test-suite(
            s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "10"
            , "17"
            , "13"
            , "47"
            )
            ; !"
===============================================
              xml aterm tests
==============================================="
          , s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "15"
            , "8"
            , "19"
            , "36"
            )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "15"
               , "8"
               , "15"
               , "36"
               )
               ; implicit-representation-tests)
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "17"
              , "8"
              , "19"
              , "36"
              )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "17"
               , "8"
               , "17"
               , "31"
               )
               ; implicit-roundtrip-tests)
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "18"
              , "8"
              , "19"
              , "36"
              )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "18"
               , "8"
               , "18"
               , "31"
               )
               ; explicit-roundtrip-tests)
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "19"
              , "8"
              , "19"
              , "36"
              )
            ; very-explicit-roundtrip-tests
          )
      )
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "main-xml-aterm-tests"
      , "8"
      , "2"
      , "21"
      , "4"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "main-xml-aterm-tests"
      , "8"
      , "2"
      , "21"
      , "4"
      )
      ; fail


strategies
  implicit-representation-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "implicit-representation-tests"
    , "25"
    , "2"
    , "36"
    , "5"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "26"
      , "4"
      , "36"
      , "5"
      )
    ; {|Explicit:
         s-step(
         | "_cellar/xml-front/tests/xml-aterm-tests.str"
         , "27"
         , "6"
         , "35"
         , "76"
         )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "27"
            , "6"
            , "27"
            , "41"
            )
            ; rules ( Explicit :
                        () -> "--implicit" ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "28"
           , "6"
           , "35"
           , "76"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "28"
            , "6"
            , "29"
            , "48"
            )
            ; say(
                s-step(
                | "_cellar/xml-front/tests/xml-aterm-tests.str"
                , "28"
                , "10"
                , "29"
                , "47"
                )
                ; !"
======== Implicit representation tests ========"
              ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "31"
           , "6"
           , "35"
           , "76"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "31"
            , "6"
            , "31"
            , "50"
            )
            ; representation-test(|Fred(), " <Fred/>"))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "32"
           , "6"
           , "35"
           , "76"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "32"
            , "6"
            , "32"
            , "57"
            )
            ; representation-test(|Bar("foo"), " <Bar>foo</Bar>"))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "33"
           , "6"
           , "35"
           , "76"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "33"
            , "6"
            , "33"
            , "57"
            )
            ; representation-test(|Bar(123), " <Bar>123</Bar>"))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "34"
           , "6"
           , "35"
           , "76"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "34"
            , "6"
            , "34"
            , "61"
            )
            ; representation-test(
              | Bar(Fred())
              , " <Bar><Fred/></Bar>"
              ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "35"
           , "6"
           , "35"
           , "76"
           )
         ; representation-test(
           | Foo(Fred(), Fred())
           , " <Foo><Fred/><Fred/></Foo>"
           )
      |}
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "implicit-representation-tests"
      , "25"
      , "2"
      , "36"
      , "5"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "implicit-representation-tests"
      , "25"
      , "2"
      , "36"
      , "5"
      )
      ; fail


strategies
  very-explicit-roundtrip-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "very-explicit-roundtrip-tests"
    , "41"
    , "2"
    , "50"
    , "5"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "42"
      , "4"
      , "50"
      , "5"
      )
    ; {|Explicit:
         s-step(
         | "_cellar/xml-front/tests/xml-aterm-tests.str"
         , "43"
         , "6"
         , "49"
         , "30"
         )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "43"
            , "6"
            , "43"
            , "46"
            )
            ; rules ( Explicit :
                        () -> "--very-explicit" ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "44"
           , "6"
           , "49"
           , "30"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "44"
            , "6"
            , "45"
            , "48"
            )
            ; say(
                s-step(
                | "_cellar/xml-front/tests/xml-aterm-tests.str"
                , "44"
                , "10"
                , "45"
                , "47"
                )
                ; !"
======== Very explicit roundtrip tests ========"
              ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "47"
           , "6"
           , "49"
           , "30"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "47"
            , "6"
            , "47"
            , "25"
            )
            ; easy-roundtrip-tests)
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "48"
           , "6"
           , "49"
           , "30"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "48"
            , "6"
            , "48"
            , "24"
            )
            ; avg-roundtrip-tests)
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "49"
           , "6"
           , "49"
           , "30"
           )
         ; difficult-roundtrip-tests
      |}
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "very-explicit-roundtrip-tests"
      , "41"
      , "2"
      , "50"
      , "5"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "very-explicit-roundtrip-tests"
      , "41"
      , "2"
      , "50"
      , "5"
      )
      ; fail

  explicit-roundtrip-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "explicit-roundtrip-tests"
    , "52"
    , "2"
    , "61"
    , "5"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "53"
      , "4"
      , "61"
      , "5"
      )
    ; {|Explicit:
         s-step(
         | "_cellar/xml-front/tests/xml-aterm-tests.str"
         , "54"
         , "6"
         , "60"
         , "30"
         )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "54"
            , "6"
            , "54"
            , "41"
            )
            ; rules ( Explicit :
                        () -> "--explicit" ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "55"
           , "6"
           , "60"
           , "30"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "55"
            , "6"
            , "56"
            , "48"
            )
            ; say(
                s-step(
                | "_cellar/xml-front/tests/xml-aterm-tests.str"
                , "55"
                , "10"
                , "56"
                , "47"
                )
                ; !"
========== Explicit roundtrip tests ==========="
              ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "58"
           , "6"
           , "60"
           , "30"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "58"
            , "6"
            , "58"
            , "25"
            )
            ; easy-roundtrip-tests)
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "59"
           , "6"
           , "60"
           , "30"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "59"
            , "6"
            , "59"
            , "24"
            )
            ; avg-roundtrip-tests)
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "60"
           , "6"
           , "60"
           , "30"
           )
         ; difficult-roundtrip-tests
      |}
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "explicit-roundtrip-tests"
      , "52"
      , "2"
      , "61"
      , "5"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "explicit-roundtrip-tests"
      , "52"
      , "2"
      , "61"
      , "5"
      )
      ; fail

  implicit-roundtrip-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "implicit-roundtrip-tests"
    , "63"
    , "2"
    , "70"
    , "5"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "64"
      , "4"
      , "70"
      , "5"
      )
    ; {|Explicit:
         s-step(
         | "_cellar/xml-front/tests/xml-aterm-tests.str"
         , "65"
         , "6"
         , "69"
         , "25"
         )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "65"
            , "6"
            , "65"
            , "41"
            )
            ; rules ( Explicit :
                        () -> "--implicit" ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "66"
           , "6"
           , "69"
           , "25"
           )
         ; (s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "66"
            , "6"
            , "67"
            , "48"
            )
            ; say(
                s-step(
                | "_cellar/xml-front/tests/xml-aterm-tests.str"
                , "66"
                , "10"
                , "67"
                , "47"
                )
                ; !"
========== Implicit roundtrip tests ==========="
              ))
         ; s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "69"
           , "6"
           , "69"
           , "25"
           )
         ; easy-roundtrip-tests
      |}
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "implicit-roundtrip-tests"
      , "63"
      , "2"
      , "70"
      , "5"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "implicit-roundtrip-tests"
      , "63"
      , "2"
      , "70"
      , "5"
      )
      ; fail

  easy-roundtrip-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "easy-roundtrip-tests"
    , "72"
    , "2"
    , "80"
    , "51"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "73"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "73"
       , "6"
       , "73"
       , "29"
       )
       ; roundtrip-test(|Fred()))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "74"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "74"
       , "6"
       , "74"
       , "31"
       )
       ; roundtrip-test(|Bar("1")))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "75"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "75"
       , "6"
       , "75"
       , "44"
       )
       ; roundtrip-test(
         | Foo(Fred(), Bar("1"))
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "76"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "76"
       , "6"
       , "76"
       , "42"
       )
       ; roundtrip-test(
         | Foo(Fred(), Fred())
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "77"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "77"
       , "6"
       , "77"
       , "38"
       )
       ; roundtrip-test(|Fred(){Fred()}))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "78"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "78"
       , "6"
       , "78"
       , "40"
       )
       ; roundtrip-test(
         | Fred(){Bar("1")}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "79"
      , "6"
      , "80"
      , "51"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "79"
       , "6"
       , "79"
       , "53"
       )
       ; roundtrip-test(
         | Fred(){ Foo(Fred(), Bar("1"))
                 }
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "80"
      , "6"
      , "80"
      , "51"
      )
    ; roundtrip-test(
      | Fred(){Foo(Fred(), Fred())}
      )
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "easy-roundtrip-tests"
      , "72"
      , "2"
      , "80"
      , "51"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "easy-roundtrip-tests"
      , "72"
      , "2"
      , "80"
      , "51"
      )
      ; fail

  avg-roundtrip-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "avg-roundtrip-tests"
    , "82"
    , "2"
    , "97"
    , "59"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "83"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "83"
       , "6"
       , "83"
       , "23"
       )
       ; roundtrip-test(|1))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "84"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "84"
       , "6"
       , "84"
       , "23"
       )
       ; roundtrip-test(|2))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "85"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "85"
       , "6"
       , "85"
       , "25"
       )
       ; roundtrip-test(|"a"))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "86"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "86"
       , "6"
       , "86"
       , "26"
       )
       ; roundtrip-test(|"ab"))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "87"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "87"
       , "6"
       , "87"
       , "28"
       )
       ; roundtrip-test(|" ab "))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "88"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "88"
       , "6"
       , "88"
       , "29"
       )
       ; roundtrip-test(|[1, 2]))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "89"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "89"
       , "6"
       , "89"
       , "32"
       )
       ; roundtrip-test(
         | [1, 2, 3]
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "90"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "90"
       , "6"
       , "90"
       , "44"
       )
       ; roundtrip-test(
         | ["1", "2    ", " 3 "]
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "91"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "91"
       , "6"
       , "91"
       , "32"
       )
       ; roundtrip-test(|Foo(1, 2)))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "92"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "92"
       , "6"
       , "92"
       , "32"
       )
       ; roundtrip-test(|Foo(3, 4)))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "93"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "93"
       , "6"
       , "93"
       , "37"
       )
       ; roundtrip-test(
         | Foo(1, [2, 3])
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "94"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "94"
       , "6"
       , "94"
       , "42"
       )
       ; roundtrip-test(
         | Foo(
             [1, 2]
           , [3, 4]
           )
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "95"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "95"
       , "6"
       , "95"
       , "30"
       )
       ; roundtrip-test(|Some(4)))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "96"
      , "6"
      , "97"
      , "59"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "96"
       , "6"
       , "96"
       , "29"
       )
       ; roundtrip-test(|None()))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "97"
      , "6"
      , "97"
      , "59"
      )
    ; roundtrip-test(
      | Element(
          Name(None(), "foo")
        , []
        , []
        )
      )
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "avg-roundtrip-tests"
      , "82"
      , "2"
      , "97"
      , "59"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "avg-roundtrip-tests"
      , "82"
      , "2"
      , "97"
      , "59"
      )
      ; fail

  difficult-roundtrip-tests =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "difficult-roundtrip-tests"
    , "99"
    , "2"
    , "112"
    , "35"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "100"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "100"
       , "6"
       , "100"
       , "48"
       )
       ; roundtrip-test(
         | Foo(1, [2, 3]){Foo(1, 2)}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "101"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "101"
       , "6"
       , "101"
       , "40"
       )
       ; roundtrip-test(
         | Foo(1, [2, 3]){1}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "102"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "102"
       , "6"
       , "102"
       , "40"
       )
       ; roundtrip-test(
         | Foo(1, [2, 3]){2}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "103"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "103"
       , "6"
       , "103"
       , "42"
       )
       ; roundtrip-test(
         | Foo(1, [2, 3]){"2"}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "104"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "104"
       , "6"
       , "104"
       , "29"
       )
       ; roundtrip-test(|int(5)))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "105"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "105"
       , "6"
       , "105"
       , "39"
       )
       ; roundtrip-test(|string("voodoo")))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "106"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "106"
       , "6"
       , "106"
       , "29"
       )
       ; roundtrip-test(|None()))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "107"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "107"
       , "6"
       , "107"
       , "28"
       )
       ; roundtrip-test(|"a"{1}))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "108"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "108"
       , "6"
       , "108"
       , "31"
       )
       ; roundtrip-test(|"a"{1, 2}))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "109"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "109"
       , "6"
       , "109"
       , "33"
       )
       ; roundtrip-test(
         | "a"{(1, 2)}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "110"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "110"
       , "6"
       , "110"
       , "27"
       )
       ; roundtrip-test(|1{1}))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "111"
      , "6"
      , "112"
      , "35"
      )
    ; (s-step(
       | "_cellar/xml-front/tests/xml-aterm-tests.str"
       , "111"
       , "6"
       , "111"
       , "32"
       )
       ; roundtrip-test(
         | [1, 2]{1}
         ))
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "112"
      , "6"
      , "112"
      , "35"
      )
    ; roundtrip-test(
      | (1, 2){1, 2}
      )
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "difficult-roundtrip-tests"
      , "99"
      , "2"
      , "112"
      , "35"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "difficult-roundtrip-tests"
      , "99"
      , "2"
      , "112"
      , "35"
      )
      ; fail


strategies
  representation-test(|t, xml) =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "representation-test"
    , "116"
    , "2"
    , "128"
    , "4"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "117"
      , "4"
      , "128"
      , "4"
      )
    ; apply-test(
        s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "117"
        , "15"
        , "117"
        , "16"
        )
        ; !t
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "118"
        , "6"
        , "123"
        , "6"
        )
        ; xtc-temp-files(
            s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "119"
            , "8"
            , "122"
            , "16"
            )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "119"
               , "8"
               , "119"
               , "15"
               )
               ; write-to)
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "120"
              , "8"
              , "122"
              , "16"
              )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "120"
               , "8"
               , "120"
               , "69"
               )
               ; xtc-transform(
                   s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "120"
                   , "22"
                   , "120"
                   , "33"
                   )
                   ; !"aterm2xml"
                 , s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "120"
                   , "36"
                   , "120"
                   , "68"
                   )
                   ; ![<s-step(
                        | "_cellar/xml-front/tests/xml-aterm-tests.str"
                        , "120"
                        , "39"
                        , "120"
                        , "46"
                        )
                        ; Explicit> ()|<s-step(
                                        | "_cellar/xml-front/tests/xml-aterm-tests.str"
                                        , "120"
                                        , "55"
                                        , "120"
                                        , "66"
                                        )
                                        ; pass-verbose>]
                 ))
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "121"
              , "8"
              , "122"
              , "16"
              )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "121"
               , "8"
               , "121"
               , "53"
               )
               ; xtc-transform(
                   s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "121"
                   , "22"
                   , "121"
                   , "38"
                   )
                   ; !"parse-xml-info"
                 , s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "121"
                   , "41"
                   , "121"
                   , "52"
                   )
                   ; pass-verbose
                 ))
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "122"
              , "8"
              , "122"
              , "16"
              )
            ; read-from
          )
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "124"
        , "6"
        , "124"
        , "7"
        )
        ; !t
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "125"
        , "6"
        , "127"
        , "16"
        )
        ; (s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "125"
           , "6"
           , "125"
           , "21"
           )
           ; <(s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "125"
               , "7"
               , "125"
               , "14"
               )
               ; print-to)> [xml])
        ; s-step(
          | "_cellar/xml-front/tests/xml-aterm-tests.str"
          , "126"
          , "8"
          , "127"
          , "16"
          )
        ; (s-step(
           | "_cellar/xml-front/tests/xml-aterm-tests.str"
           , "126"
           , "8"
           , "126"
           , "53"
           )
           ; xtc-transform(
               s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "126"
               , "22"
               , "126"
               , "38"
               )
               ; !"parse-xml-info"
             , s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "126"
               , "41"
               , "126"
               , "52"
               )
               ; pass-verbose
             ))
        ; s-step(
          | "_cellar/xml-front/tests/xml-aterm-tests.str"
          , "127"
          , "8"
          , "127"
          , "16"
          )
        ; read-from
      )
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "representation-test"
      , "116"
      , "2"
      , "128"
      , "4"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "representation-test"
      , "116"
      , "2"
      , "128"
      , "4"
      )
      ; fail

  roundtrip-test(|t) =
    s-enter(
    | "_cellar/xml-front/tests/xml-aterm-tests.str"
    , "roundtrip-test"
    , "130"
    , "2"
    , "140"
    , "4"
    )
    ; s-step(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "131"
      , "4"
      , "140"
      , "4"
      )
    ; apply-test(
        s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "131"
        , "15"
        , "131"
        , "16"
        )
        ; !t
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "132"
        , "6"
        , "137"
        , "6"
        )
        ; xtc-temp-files(
            s-step(
            | "_cellar/xml-front/tests/xml-aterm-tests.str"
            , "133"
            , "8"
            , "136"
            , "16"
            )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "133"
               , "8"
               , "133"
               , "15"
               )
               ; write-to)
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "134"
              , "8"
              , "136"
              , "16"
              )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "134"
               , "8"
               , "134"
               , "69"
               )
               ; xtc-transform(
                   s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "134"
                   , "22"
                   , "134"
                   , "33"
                   )
                   ; !"aterm2xml"
                 , s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "134"
                   , "36"
                   , "134"
                   , "68"
                   )
                   ; ![<s-step(
                        | "_cellar/xml-front/tests/xml-aterm-tests.str"
                        , "134"
                        , "39"
                        , "134"
                        , "46"
                        )
                        ; Explicit> ()|<s-step(
                                        | "_cellar/xml-front/tests/xml-aterm-tests.str"
                                        , "134"
                                        , "55"
                                        , "134"
                                        , "66"
                                        )
                                        ; pass-verbose>]
                 ))
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "135"
              , "8"
              , "136"
              , "16"
              )
            ; (s-step(
               | "_cellar/xml-front/tests/xml-aterm-tests.str"
               , "135"
               , "8"
               , "135"
               , "69"
               )
               ; xtc-transform(
                   s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "135"
                   , "22"
                   , "135"
                   , "33"
                   )
                   ; !"xml2aterm"
                 , s-step(
                   | "_cellar/xml-front/tests/xml-aterm-tests.str"
                   , "135"
                   , "36"
                   , "135"
                   , "68"
                   )
                   ; ![<s-step(
                        | "_cellar/xml-front/tests/xml-aterm-tests.str"
                        , "135"
                        , "39"
                        , "135"
                        , "46"
                        )
                        ; Explicit> ()|<s-step(
                                        | "_cellar/xml-front/tests/xml-aterm-tests.str"
                                        , "135"
                                        , "55"
                                        , "135"
                                        , "66"
                                        )
                                        ; pass-verbose>]
                 ))
            ; s-step(
              | "_cellar/xml-front/tests/xml-aterm-tests.str"
              , "136"
              , "8"
              , "136"
              , "16"
              )
            ; read-from
          )
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "138"
        , "6"
        , "138"
        , "7"
        )
        ; !t
      , s-step(
        | "_cellar/xml-front/tests/xml-aterm-tests.str"
        , "139"
        , "6"
        , "139"
        , "7"
        )
        ; !t
      )
    < s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "roundtrip-test"
      , "130"
      , "2"
      , "140"
      , "4"
      )
    + s-exit(
      | "_cellar/xml-front/tests/xml-aterm-tests.str"
      , "roundtrip-test"
      , "130"
      , "2"
      , "140"
      , "4"
      )
      ; fail


signature
  constructors
    Foo    : Foo * Foo -> Foo
    Bar    : Foo -> Foo
    Fred   : Foo
    int    : Int -> Foo
    string : String -> Foo